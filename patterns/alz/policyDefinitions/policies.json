{
  "$schema": "https://schema.management.azure.com/schemas/2019-08-01/managementGroupDeploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "metadata": {
    "_generator": {
      "name": "bicep",
      "version": "0.18.4.5664",
      "templateHash": "800118550120965694"
    }
  },
  "parameters": {
    "topLevelManagementGroupPrefix": {
      "type": "string",
      "defaultValue": "alz",
      "maxLength": 10,
      "metadata": {
        "description": "Provide a prefix (max 10 characters, unique at tenant-scope) for the Management Group hierarchy and other resources created as part of an Azure landing zone. DEFAULT VALUE = \"alz\"",
        "message": "The JSON version of this file is programatically generated from Bicep. PLEASE DO NOT UPDATE MANUALLY!!"
      }
    },
    "location": {
      "type": "string",
      "defaultValue": "[deployment().location]",
      "metadata": {
        "description": "Optionally set the deployment location for policies with Deploy If Not Exists effect. DEFAULT VALUE = \"deployment().location\""
      }
    },
    "scope": {
      "type": "string",
      "defaultValue": "[tenantResourceId('Microsoft.Management/managementGroups', parameters('topLevelManagementGroupPrefix'))]",
      "metadata": {
        "description": "Optionally set the scope for custom Policy Definitions used in Policy Set Definitions (Initiatives). Must be one of '/', '/subscriptions/id' or '/providers/Microsoft.Management/managementGroups/id'. DEFAULT VALUE = '/providers/Microsoft.Management/managementGroups/${topLevelManagementGroupPrefix}'"
      }
    }
  },
  "variables": {
    "copy": [
      {
        "name": "processPolicyDefinitionsAll",
        "count": "[length(variables('loadPolicyDefinitions').All)]",
        "input": "[replace(replace(variables('loadPolicyDefinitions').All[copyIndex('processPolicyDefinitionsAll')], variables('templateVars').defaultDeploymentLocation, variables('deploymentLocation')), variables('templateVars').localizedDeploymentLocation, variables('deploymentLocation'))]"
      },
      {
        "name": "processPolicyDefinitionsAzureCloud",
        "count": "[length(variables('loadPolicyDefinitions').AzureCloud)]",
        "input": "[replace(replace(variables('loadPolicyDefinitions').AzureCloud[copyIndex('processPolicyDefinitionsAzureCloud')], variables('templateVars').defaultDeploymentLocation, variables('deploymentLocation')), variables('templateVars').localizedDeploymentLocation, variables('deploymentLocation'))]"
      },
      {
        "name": "processPolicyDefinitionsAzureChinaCloud",
        "count": "[length(variables('loadPolicyDefinitions').AzureChinaCloud)]",
        "input": "[replace(replace(variables('loadPolicyDefinitions').AzureChinaCloud[copyIndex('processPolicyDefinitionsAzureChinaCloud')], variables('templateVars').defaultDeploymentLocation, variables('deploymentLocation')), variables('templateVars').localizedDeploymentLocation, variables('deploymentLocation'))]"
      },
      {
        "name": "processPolicyDefinitionsAzureUSGovernment",
        "count": "[length(variables('loadPolicyDefinitions').AzureUSGovernment)]",
        "input": "[replace(replace(variables('loadPolicyDefinitions').AzureUSGovernment[copyIndex('processPolicyDefinitionsAzureUSGovernment')], variables('templateVars').defaultDeploymentLocation, variables('deploymentLocation')), variables('templateVars').localizedDeploymentLocation, variables('deploymentLocation'))]"
      },
      {
        "name": "processPolicySetDefinitionsAll",
        "count": "[length(variables('loadPolicySetDefinitions').All)]",
        "input": "[replace(variables('loadPolicySetDefinitions').All[copyIndex('processPolicySetDefinitionsAll')], variables('templateVars').scope, parameters('scope'))]"
      },
      {
        "name": "processPolicySetDefinitionsAzureCloud",
        "count": "[length(variables('loadPolicySetDefinitions').AzureCloud)]",
        "input": "[replace(variables('loadPolicySetDefinitions').AzureCloud[copyIndex('processPolicySetDefinitionsAzureCloud')], variables('templateVars').scope, parameters('scope'))]"
      },
      {
        "name": "processPolicySetDefinitionsAzureChinaCloud",
        "count": "[length(variables('loadPolicySetDefinitions').AzureChinaCloud)]",
        "input": "[replace(variables('loadPolicySetDefinitions').AzureChinaCloud[copyIndex('processPolicySetDefinitionsAzureChinaCloud')], variables('templateVars').scope, parameters('scope'))]"
      },
      {
        "name": "processPolicySetDefinitionsAzureUSGovernment",
        "count": "[length(variables('loadPolicySetDefinitions').AzureUSGovernment)]",
        "input": "[replace(variables('loadPolicySetDefinitions').AzureUSGovernment[copyIndex('processPolicySetDefinitionsAzureUSGovernment')], variables('templateVars').scope, parameters('scope'))]"
      },
      {
        "name": "policyDefinitionsAll",
        "count": "[length(variables('processPolicyDefinitionsAll'))]",
        "input": "[json(variables('processPolicyDefinitionsAll')[copyIndex('policyDefinitionsAll')])]"
      },
      {
        "name": "policyDefinitionsAzureCloud",
        "count": "[length(variables('processPolicyDefinitionsAzureCloud'))]",
        "input": "[json(variables('processPolicyDefinitionsAzureCloud')[copyIndex('policyDefinitionsAzureCloud')])]"
      },
      {
        "name": "policyDefinitionsAzureChinaCloud",
        "count": "[length(variables('processPolicyDefinitionsAzureChinaCloud'))]",
        "input": "[json(variables('processPolicyDefinitionsAzureChinaCloud')[copyIndex('policyDefinitionsAzureChinaCloud')])]"
      },
      {
        "name": "policyDefinitionsAzureUSGovernment",
        "count": "[length(variables('processPolicyDefinitionsAzureUSGovernment'))]",
        "input": "[json(variables('processPolicyDefinitionsAzureUSGovernment')[copyIndex('policyDefinitionsAzureUSGovernment')])]"
      },
      {
        "name": "policySetDefinitionsAll",
        "count": "[length(variables('processPolicySetDefinitionsAll'))]",
        "input": "[json(variables('processPolicySetDefinitionsAll')[copyIndex('policySetDefinitionsAll')])]"
      },
      {
        "name": "policySetDefinitionsAzureCloud",
        "count": "[length(variables('processPolicySetDefinitionsAzureCloud'))]",
        "input": "[json(variables('processPolicySetDefinitionsAzureCloud')[copyIndex('policySetDefinitionsAzureCloud')])]"
      },
      {
        "name": "policySetDefinitionsAzureChinaCloud",
        "count": "[length(variables('processPolicySetDefinitionsAzureChinaCloud'))]",
        "input": "[json(variables('processPolicySetDefinitionsAzureChinaCloud')[copyIndex('policySetDefinitionsAzureChinaCloud')])]"
      },
      {
        "name": "policySetDefinitionsAzureUSGovernment",
        "count": "[length(variables('processPolicySetDefinitionsAzureUSGovernment'))]",
        "input": "[json(variables('processPolicySetDefinitionsAzureUSGovernment')[copyIndex('policySetDefinitionsAzureUSGovernment')])]"
      }
    ],
    "$fxv#0": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_AA_TotalJob_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy Automation Account TotalJob Alert\",\r\n    \"description\": \"Policy to audit/deploy Automation Account TotalJob Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Automation\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT1M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"0\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring on resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Automation/automationAccounts\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Automation/automationAccounts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"TotalJob\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Automation/automationAccounts/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-TotalJob')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for Automation Account TotalJob Alert\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"TotalJob\",\r\n                            \"metricNamespace\": \"Microsoft.Automation/automationAccounts\",\r\n                            \"metricName\": \"TotalJob\",\r\n                            \"dimensions\": [\r\n                              {\r\n                                \"name\": \"Status\",\r\n                                \"operator\": \"Exclude\",\r\n                                \"values\": [\r\n                                  \"Completed\"\r\n                                ]\r\n                              }\r\n                            ],\r\n                            \"operator\": \"GreaterThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#1": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_activitylog_Firewall_Delete\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy Activity Log Azure FireWall Delete Alert\",\r\n    \"description\": \"Policy to Deploy Activity Log Azure Firewall Delete Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\",\r\n          \"_deployed_by_amba\": true\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring on resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/azureFirewalls\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/activityLogAlerts\",\r\n          \"name\": \"ActivityAzureFirewallDelete\",\r\n          \"existenceScope\": \"resourceGroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/ActivityLogAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*]\",\r\n                  \"where\": {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"category\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"Administrative\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"operationName\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"Microsoft.Network/azureFirewalls/delete\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                },\r\n                \"equals\": 2\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"[[deployment().location]\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2020-10-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"ActivityAzureFirewallDelete\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"microsoft.insights/activityLogAlerts\",\r\n                            \"apiVersion\": \"2020-10-01\",\r\n                            \"name\": \"ActivityAzureFirewallDelete\",\r\n                            \"location\": \"global\",\r\n                            \"tags\": {\r\n                              \"_deployed_by_amba\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"description\": \"Activity Log Firewall Delete\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().id]\"\r\n                              ],\r\n                              \"condition\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"category\",\r\n                                    \"equals\": \"Administrative\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"operationName\",\r\n                                    \"equals\": \"Microsoft.Network/azurefirewalls/delete\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"status\",\r\n                                    \"containsAny\": [\r\n                                      \"succeeded\"\r\n                                    ]\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"parameters\": {\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#10": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_activitylog_ServiceHealth_Maintenance\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy Service Health Maintenance Alert\",\r\n    \"description\": \"Policy to Deploy Service Health Maintenance Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.1.0\",\r\n      \"category\": \"Monitoring\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\",\r\n          \"_deployed_by_amba\": true\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"ALZMonitorActionGroupEmail\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Action Group Email\",\r\n          \"description\": \"Email address to send alerts to\"\r\n        },\r\n        \"defaultValue\": \"action@mail.com\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring  Subscription level alerts. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/activityLogAlerts\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/ActivityLogAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*]\",\r\n                  \"where\": {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"category\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"ServiceHealth\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"properties.incidentType\"\r\n                          },\r\n                          {\r\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"Maintenance\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                },\r\n                \"equals\": 2\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"[[deployment().location]\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"ALZMonitorActionGroupEmail\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"ServiceHealthMaintenance\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"ALZMonitorActionGroupEmail\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"microsoft.insights/activityLogAlerts\",\r\n                            \"apiVersion\": \"2020-10-01\",\r\n                            \"name\": \"ServiceHealthPlannedMaintenance\",\r\n                            \"location\": \"global\",\r\n                            \"dependsOn\": [\r\n                              \"[[concat(subscription().Id, '/resourceGroups/', parameters('alertResourceGroupName'), '/providers/Microsoft.Insights/actionGroups/AlzActionGrp')]\"\r\n                            ],\r\n                            \"tags\": {\r\n                              \"_deployed_by_amba\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"actions\": {\r\n                                \"actionGroups\": [\r\n                                  {\r\n                                    \"actionGroupId\": \"[[concat(subscription().Id, '/resourceGroups/', parameters('alertResourceGroupName'), '/providers/Microsoft.Insights/actionGroups/AlzActionGrp')]\"\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"description\": \"ServiceHealthPlannedMaintenance Alert\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().id]\"\r\n                              ],\r\n                              \"condition\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"category\",\r\n                                    \"equals\": \"ServiceHealth\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"properties.incidentType\",\r\n                                    \"equals\": \"Maintenance\"\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"parameters\": {\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          },\r\n                          {\r\n                            \"type\": \"Microsoft.Insights/actionGroups\",\r\n                            \"apiVersion\": \"2022-04-01\",\r\n                            \"name\": \"AlzActionGrp\",\r\n                            \"location\": \"global\",\r\n                            \"tags\": {\r\n                              \"_deployed_by_amba\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"groupShortName\": \"AlzActionGrp\",\r\n                              \"enabled\": true,\r\n                              \"emailReceivers\": [\r\n                                {\r\n                                  \"name\": \"AlzMail\",\r\n                                  \"emailAddress\": \"[[parameters('ALZMonitorActionGroupEmail')]\",\r\n                                  \"useCommonAlertSchema\": true\r\n                                }\r\n                              ]\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        },\r\n                        \"ALZMonitorActionGroupEmail\": {\r\n                          \"value\": \"[[parameters('ALZMonitorActionGroupEmail')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                },\r\n                \"ALZMonitorActionGroupEmail\": {\r\n                  \"value\": \"[[parameters('ALZMonitorActionGroupEmail')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#11": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_activitylog_ServiceHealth_SecurityAdvisory\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy Service Health Security Advisory Alert\",\r\n    \"description\": \"Policy to Deploy Service Health Security Advisory Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.1.0\",\r\n      \"category\": \"Monitoring\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\",\r\n          \"_deployed_by_amba\": true\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"ALZMonitorActionGroupEmail\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Action Group Email\",\r\n          \"description\": \"Email address to send alerts to\"\r\n        },\r\n        \"defaultValue\": \"action@mail.com\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring  Subscription level alerts. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/activityLogAlerts\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/ActivityLogAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*]\",\r\n                  \"where\": {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"category\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"ServiceHealth\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"properties.incidentType\"\r\n                          },\r\n                          {\r\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"Security\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                },\r\n                \"equals\": 2\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"[[deployment().location]\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"ALZMonitorActionGroupEmail\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"ServiceSecurityIncident\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"ALZMonitorActionGroupEmail\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"microsoft.insights/activityLogAlerts\",\r\n                            \"apiVersion\": \"2020-10-01\",\r\n                            \"name\": \"ServiceHealthSecurityIncident\",\r\n                            \"location\": \"global\",\r\n                            \"dependsOn\": [\r\n                              \"[[concat(subscription().Id, '/resourceGroups/', parameters('alertResourceGroupName'), '/providers/Microsoft.Insights/actionGroups/AlzActionGrp')]\"\r\n                            ],\r\n                            \"tags\": {\r\n                              \"_deployed_by_amba\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"actions\": {\r\n                                \"actionGroups\": [\r\n                                  {\r\n                                    \"actionGroupId\": \"[[concat(subscription().Id, '/resourceGroups/', parameters('alertResourceGroupName'), '/providers/Microsoft.Insights/actionGroups/AlzActionGrp')]\"\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"description\": \"Service Health Security Alert\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().id]\"\r\n                              ],\r\n                              \"condition\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"category\",\r\n                                    \"equals\": \"ServiceHealth\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"properties.incidentType\",\r\n                                    \"equals\": \"Security\"\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"parameters\": {\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          },\r\n                          {\r\n                            \"type\": \"Microsoft.Insights/actionGroups\",\r\n                            \"apiVersion\": \"2022-04-01\",\r\n                            \"name\": \"AlzActionGrp\",\r\n                            \"location\": \"global\",\r\n                            \"tags\": {\r\n                              \"_deployed_by_amba\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"groupShortName\": \"AlzActionGrp\",\r\n                              \"enabled\": true,\r\n                              \"emailReceivers\": [\r\n                                {\r\n                                  \"name\": \"AlzMail\",\r\n                                  \"emailAddress\": \"[[parameters('ALZMonitorActionGroupEmail')]\",\r\n                                  \"useCommonAlertSchema\": true\r\n                                }\r\n                              ]\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        },\r\n                        \"ALZMonitorActionGroupEmail\": {\r\n                          \"value\": \"[[parameters('ALZMonitorActionGroupEmail')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"ALZMonitorActionGroupEmail\": {\r\n                  \"value\": \"[[parameters('ALZMonitorActionGroupEmail')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#12": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_activitylog_VPNGateway_Delete\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy Activity Log VPN Gateway Delete Alert\",\r\n    \"description\": \"Policy to Deploy Activity Log VPN Gateway Delete Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\",\r\n          \"_deployed_by_amba\": true\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/vpnGateways\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/activityLogAlerts\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/ActivityLogAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*]\",\r\n                  \"where\": {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"category\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"Administrative\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"operationName\"\r\n                          },\r\n                          {\r\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"Microsoft.Network/vpnGateways/delete\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                },\r\n                \"equals\": 2\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"[[deployment().location]\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"ActivityVPNGatewayDelete\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"microsoft.insights/activityLogAlerts\",\r\n                            \"apiVersion\": \"2020-10-01\",\r\n                            \"name\": \"ActivityVPNGatewayDelete\",\r\n                            \"location\": \"global\",\r\n                            \"tags\": {\r\n                              \"_deployed_by_amba\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"description\": \"Activity Log VPN Gateway Delete\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().id]\"\r\n                              ],\r\n                              \"condition\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"category\",\r\n                                    \"equals\": \"Administrative\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"operationName\",\r\n                                    \"equals\": \"Microsoft.Network/vpnGateways/delete\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"status\",\r\n                                    \"containsAny\": [\r\n                                      \"succeeded\"\r\n                                    ]\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"parameters\": {\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#13": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_AFW_FirewallHealth_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy AFW FirewallHealth Alert\",\r\n    \"description\": \"Policy to audit/deploy Azure Firewall FirewallHealth Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"0\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT1M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"90\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/azureFirewalls\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/azureFirewalls\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"FirewallHealth\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/azureFirewalls/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-FirewallHealth')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for AFW FirewallHealth\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"FirewallHealth\",\r\n                            \"metricNamespace\": \"Microsoft.Network/azureFirewalls\",\r\n                            \"metricName\": \"FirewallHealth\",\r\n                            \"operator\": \"LessThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#14": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_AFW_SNATPortUtilization_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy AFW SNATPortUtilization Alert\",\r\n    \"description\": \"Policy to audit/deploy Azure Firewall SNATPortUtilization Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT1M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"80\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/azureFirewalls\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/azureFirewalls\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"SNATPortUtilization\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/azureFirewalls/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-SNATPortUtilization')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for AFW SNATPortUtilization\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"SNATPortUtilization\",\r\n                            \"metricNamespace\": \"Microsoft.Network/azureFirewalls\",\r\n                            \"metricName\": \"SNATPortUtilization\",\r\n                            \"operator\": \"GreaterThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#15": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_AlertProcessing_Rule\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy Alert Processing Rule\",\r\n    \"description\": \"Policy to Deploy Deploy Alert Processing Rule with Action Group\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Monitoring\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"ALZMonitorResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"ALZMonitorResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\"\r\n        }\r\n      },\r\n      \"ALZMonitorResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"ALZMonitorActionGroupEmail\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Action Group Email\",\r\n          \"description\": \"Email address to send alerts to\"\r\n        },\r\n        \"defaultValue\": \"action@mail.com\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring at subscription. Set to true if monitoring process rule should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.AlertsManagement/actionRules\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('ALZMonitorResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.AlertsManagement/actionRules/description\",\r\n                \"equals\": \"Alz Alert Processing Rule for Subscription\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"[[deployment().location]\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"ALZMonitorResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"ALZMonitorResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"ALZMonitorResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"ALZMonitorActionGroupEmail\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('ALZMonitorResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('ALZMonitorResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"ActionGroupDeployment\",\r\n                    \"resourceGroup\": \"[[parameters('ALZMonitorResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('ALZMonitorResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"ALZMonitorResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"ALZMonitorActionGroupEmail\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"Microsoft.Insights/actionGroups\",\r\n                            \"apiVersion\": \"2022-04-01\",\r\n                            \"name\": \"AlzActionGrp\",\r\n                            \"location\": \"global\",\r\n                            \"tags\": {\r\n                              \"_deployed_by_amba\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"groupShortName\": \"AlzActionGrp\",\r\n                              \"enabled\": true,\r\n                              \"emailReceivers\": [\r\n                                {\r\n                                  \"name\": \"AlzMail\",\r\n                                  \"emailAddress\": \"[[parameters('ALZMonitorActionGroupEmail')]\",\r\n                                  \"useCommonAlertSchema\": true\r\n                                }\r\n                              ]\r\n                            }\r\n                          },\r\n                          {\r\n                            \"type\": \"Microsoft.AlertsManagement/actionRules\",\r\n                            \"apiVersion\": \"2021-08-08\",\r\n                            \"name\": \"Alz Alert Processing Rule\",\r\n                            \"location\": \"global\",\r\n                            \"dependsOn\": [\r\n                              \"[[concat('Microsoft.Insights/actionGroups/', 'AlzActionGrp')]\"\r\n                            ],\r\n                            \"tags\": {\r\n                              \"_deployed_by_amba\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"scopes\": [\r\n                                \"[[subscription().Id]\"\r\n                              ],\r\n                              \"description\": \"Alz Alert Processing Rule for Subscription\",\r\n                              \"enabled\": true,\r\n                              \"actions\": [\r\n                                {\r\n                                  \"actiongroupIds\": [\r\n                                    \"[[concat(subscription().Id, '/resourceGroups/', parameters('ALZMonitorResourceGroupName'), '/providers/Microsoft.Insights/actionGroups/AlzActionGrp')]\"\r\n                                  ],\r\n                                  \"actionType\": \"AddActionGroups\"\r\n                                }\r\n                              ]\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"ALZMonitorResourceGroupName\": {\r\n                          \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n                        },\r\n                        \"ALZMonitorActionGroupEmail\": {\r\n                          \"value\": \"[[parameters('ALZMonitorActionGroupEmail')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"ALZMonitorResourceGroupName\": {\r\n                  \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n                },\r\n                \"ALZMonitorResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n                },\r\n                \"ALZMonitorResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n                },\r\n                \"ALZMonitorActionGroupEmail\": {\r\n                  \"value\": \"[[parameters('ALZMonitorActionGroupEmail')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#16": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_ERCIR_ArpAvailability_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy ExpressRoute Circuits Arp Availability Alert\",\r\n    \"description\": \"Policy to audit/deploy ExpressRoute Circuits Arp Availability Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"0\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT1M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"90\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/expressRouteCircuits\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/expressRouteCircuits\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"ArpAvailability\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/expressRouteCircuits/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-ArpAvailability')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for ExpressRoute Circuit Arp Availability\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"ArpAvailability\",\r\n                            \"metricNamespace\": \"Microsoft.Network/expressRouteCircuits\",\r\n                            \"metricName\": \"ArpAvailability\",\r\n                            \"operator\": \"LessThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#17": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_ERCIR_BgpAvailability_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy ExpressRoute Circuits Bgp Availability Alert\",\r\n    \"description\": \"Policy to audit/deploy ExpressRoute Circuits Bgp Availability Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"0\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT1M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"90\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/expressRouteCircuits\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/expressRouteCircuits\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"BgpAvailability\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/expressRouteCircuits/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-BgpAvailability')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for ExpressRoute Circuit Bgp Availability\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"BgpAvailability\",\r\n                            \"metricNamespace\": \"Microsoft.Network/expressRouteCircuits\",\r\n                            \"metricName\": \"BgpAvailability\",\r\n                            \"operator\": \"LessThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#18": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_ERCIR_QosDropBitsInPerSecond_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy ExpressRoute Circuits QosDropBitsInPerSecond Alert\",\r\n    \"description\": \"Policy to audit/deploy ExpressRoute Circuits QosDropBitsInPerSecond Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/expressRouteCircuits\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/expressRouteCircuits\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"QosDropBitsInPerSecond\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/expressRouteCircuits/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-QosDropBitsInPerSecond')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for ExpressRoute Circuit QosDropBitsInPerSecond\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"alertSensitivity\": \"Medium\",\r\n                            \"failingPeriods\": {\r\n                              \"numberOfEvaluationPeriods\": 4,\r\n                              \"minFailingPeriodsToAlert\": 4\r\n                            },\r\n                            \"name\": \"QosDropBitsInPerSecond\",\r\n                            \"metricNamespace\": \"Microsoft.Network/expressRouteCircuits\",\r\n                            \"metricName\": \"QosDropBitsInPerSecond\",\r\n                            \"operator\": \"GreaterThan\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"DynamicThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#19": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_ERCIR_QosDropBitsOutPerSecond_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy ExpressRoute Circuits QosDropBitsOutPerSecond Alert\",\r\n    \"description\": \"Policy to audit/deploy ExpressRoute Circuits QosDropBitsOutPerSecond Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/expressRouteCircuits\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/expressRouteCircuits\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"QosDropBitsOutPerSecond\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/expressRouteCircuits/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-QosDropBitsOutPerSecond')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for ExpressRoute Circuit QosDropBitsOutPerSecond\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"alertSensitivity\": \"Medium\",\r\n                            \"failingPeriods\": {\r\n                              \"numberOfEvaluationPeriods\": 4,\r\n                              \"minFailingPeriodsToAlert\": 4\r\n                            },\r\n                            \"name\": \"QosDropBitsOutPerSecond\",\r\n                            \"metricNamespace\": \"Microsoft.Network/expressRouteCircuits\",\r\n                            \"metricName\": \"QosDropBitsOutPerSecond\",\r\n                            \"operator\": \"GreaterThan\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"DynamicThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#2": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_activitylog_KeyVault_Delete\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy Activity Log Key Vault Delete Alert\",\r\n    \"description\": \"Policy to Deploy Activity Log Key Vault Delete Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Key Vault\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\",\r\n          \"_deployed_by_amba\": true\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring on resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.keyvault/vaults\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/activityLogAlerts\",\r\n          \"name\": \"ActivityKeyVaultDelete\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/ActivityLogAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*]\",\r\n                  \"where\": {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"category\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"Administrative\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"operationName\"\r\n                          },\r\n                          {\r\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"Microsoft.KeyVault/vaults/delete\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                },\r\n                \"equals\": 2\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"[[deployment().location]\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"ActivityKeyVaultDelete\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"microsoft.insights/activityLogAlerts\",\r\n                            \"apiVersion\": \"2020-10-01\",\r\n                            \"name\": \"ActivityKeyVaultDelete\",\r\n                            \"location\": \"global\",\r\n                            \"tags\": {\r\n                              \"_deployed_by_amba\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"description\": \"Activity Log Key Vault Delete\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().id]\"\r\n                              ],\r\n                              \"condition\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"category\",\r\n                                    \"equals\": \"Administrative\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"operationName\",\r\n                                    \"equals\": \"Microsoft.KeyVault/vaults/delete\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"status\",\r\n                                    \"containsAny\": [\r\n                                      \"succeeded\"\r\n                                    ]\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"parameters\": {\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#20": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_ERGw_ExpressRouteBitsIn_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy ERG ExpressRoute Bits In Alert\",\r\n    \"description\": \"Policy to audit/deploy ER Gateway Connection BitsInPerSecond Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"0\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"disabled\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/expressroutegateways\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/expressroutegateways\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"ERGatewayConnectionBitsInPerSecond\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/expressroutegateways/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-GatewayERBitsInAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for ER Gateway Connection BitsInPerSecond\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"ERGatewayConnectionBitsInPerSecond\",\r\n                            \"metricNamespace\": \"Microsoft.Network/expressroutegateways\",\r\n                            \"metricName\": \"ERGatewayConnectionBitsInPerSecond\",\r\n                            \"operator\": \"LessThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#21": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_ERGw_ExpressRouteBitsOut_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy ERG ExpressRoute Bits Out Alert\",\r\n    \"description\": \"Policy to audit/deploy ER Gateway Connection BitsOutPerSecond Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"0\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"disabled\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/expressroutegateways\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/expressroutegateways\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"ERGatewayConnectionBitsOutPerSecond\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/expressroutegateways/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-GatewayERBitsOutAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for ER Gateway Connection BitsOutPerSecond\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"ERGatewayConnectionBitsOutPerSecond\",\r\n                            \"metricNamespace\": \"Microsoft.Network/expressroutegateways\",\r\n                            \"metricName\": \"ERGatewayConnectionBitsOutPerSecond\",\r\n                            \"operator\": \"LessThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#22": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_ERGw_ExpressRouteCpuUtil_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy ERG ExpressRoute CPU Utilization Alert\",\r\n    \"description\": \"Policy to audit/deploy ER Gateway Express Route CPU Utilization Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT1M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"80\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/expressroutegateways\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/expressroutegateways\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"ExpressRouteGatewayCpuUtilization\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/expressroutegateways/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-GatewayERCPUAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for ER Gateway Express Route CPU Utilization\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"ExpressRouteGatewayCpuUtilization\",\r\n                            \"metricNamespace\": \"Microsoft.Network/expressroutegateways\",\r\n                            \"metricName\": \"ExpressRouteGatewayCpuUtilization\",\r\n                            \"operator\": \"GreaterThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#23": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_KeyVault_Availability_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy KeyVault Availability Alert\",\r\n    \"description\": \"Policy to audit/deploy KeyVault Availability Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Key Vault\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT1M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"90\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"disabled\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.keyvault/vaults\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"microsoft.keyvault/vaults\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"Availability\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.keyvault/vaults/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-Availability')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for KeyVault Availability\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"Availability\",\r\n                            \"metricNamespace\": \"microsoft.keyvault/vaults\",\r\n                            \"metricName\": \"Availability\",\r\n                            \"operator\": \"LessThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#24": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_KeyVault_Capacity_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy KeyVault Capacity Alert\",\r\n    \"description\": \"Policy to audit/deploy KeyVault Capacity Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Key Vault\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT1M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"75\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"disabled\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.keyvault/vaults\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"microsoft.keyvault/vaults\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"SaturationShoebox\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.keyvault/vaults/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-CapacityAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for KeyVault Capacity\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"SaturationShoebox\",\r\n                            \"metricNamespace\": \"microsoft.keyvault/vaults\",\r\n                            \"metricName\": \"SaturationShoebox\",\r\n                            \"operator\": \"GreaterThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#25": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_KeyVault_Latency_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy KeyVault Latency Alert\",\r\n    \"description\": \"Policy to audit/deploy KeyVault Latency Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Key Vault\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"3\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"1000\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"disabled\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.keyvault/vaults\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"microsoft.keyvault/vaults\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"ServiceApiLatency\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.keyvault/vaults/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-LatencyAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for KeyVault Latency\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"ServiceApiLatency\",\r\n                            \"metricNamespace\": \"microsoft.keyvault/vaults\",\r\n                            \"metricName\": \"ServiceApiLatency\",\r\n                            \"operator\": \"GreaterThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#26": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_KeyVault_Requests_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy KeyVault Requests Alert\",\r\n    \"description\": \"Policy to audit/deploy KeyVault Requests Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Key Vault\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"disabled\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.keyvault/vaults\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"microsoft.keyvault/vaults\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"ServiceApiResult\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.keyvault/vaults/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-RequestsAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for KeyVault Requests\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"alertSensitivity\": \"Medium\",\r\n                            \"failingPeriods\": {\r\n                              \"numberOfEvaluationPeriods\": 4,\r\n                              \"minFailingPeriodsToAlert\": 4\r\n                            },\r\n                            \"name\": \"ServiceApiResult\",\r\n                            \"metricNamespace\": \"microsoft.keyvault/vaults\",\r\n                            \"metricName\": \"ServiceApiResult\",\r\n                            \"operator\": \"GreaterThan\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"DynamicThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#27": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_PDNSZ_CapacityUtil_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy PDNSZ Capacity Utilization Alert\",\r\n    \"description\": \"Policy to audit/deploy Private DNS Zone Capacity Utilization Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT1H\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT1H\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"80\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/privateDnsZones\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/privateDnsZones\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"VirtualNetworkLinkCapacityUtilization\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/privateDnsZones/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-CapacityUtilizationAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for Private DNS Zone Virtual Network Link Capacity Utilization\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"VirtualNetworkLinkCapacityUtilization\",\r\n                            \"metricNamespace\": \"Microsoft.Network/privateDnsZones\",\r\n                            \"metricName\": \"VirtualNetworkLinkCapacityUtilization\",\r\n                            \"operator\": \"GreaterThanOrEqual\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Maximum\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#28": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_PDNSZ_QueryVolume_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy PDNSZ Query Volume Alert\",\r\n    \"description\": \"Policy to audit/deploy Private DNS Zone Query Volume Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"4\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT1H\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT1H\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"500\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"disabled\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/privateDnsZones\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/privateDnsZones\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"QueryVolume\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/privateDnsZones/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-QueryVolumeAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for Private DNS Query Volume\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"QueryVolume\",\r\n                            \"metricNamespace\": \"Microsoft.Network/privateDnsZones\",\r\n                            \"metricName\": \"QueryVolume\",\r\n                            \"operator\": \"GreaterThanOrEqual\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Total\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#29": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_PDNSZ_RecordSetCapacity_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy PDNSZ Record Set Capacity Alert\",\r\n    \"description\": \"Policy to audit/deploy Private DNS Zone Record Set Capacity Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT1H\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT1H\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"80\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/privateDnsZones\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/privateDnsZones\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"RecordSetCapacityUtilization\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/privateDnsZones/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-RecordSet_Capacity_Utilization')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for Private DNS Zone Record Set Capacity Utilization\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"RecordSetCapacityUtilization\",\r\n                            \"metricNamespace\": \"Microsoft.Network/privateDnsZones\",\r\n                            \"metricName\": \"RecordSetCapacityUtilization\",\r\n                            \"operator\": \"GreaterThanOrEqual\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Maximum\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#3": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_activitylog_LAWorkspace_Delete\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy Activity Log LA Workspace Delete Alert\",\r\n    \"description\": \"Policy to Deploy Activity Log LA Workspace Delete Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Monitoring\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\",\r\n          \"_deployed_by_amba\": true\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring on resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.OperationalInsights/workspaces\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/activityLogAlerts\",\r\n          \"name\": \"ActivityLAWorkspaceDelete\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/ActivityLogAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*]\",\r\n                  \"where\": {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"category\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"Administrative\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"operationName\"\r\n                          },\r\n                          {\r\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"Microsoft.OperationalInsights/workspaces/delete\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                },\r\n                \"equals\": 2\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"[[deployment().location]\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"ActivityLAWorkspaceDelete\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"microsoft.insights/activityLogAlerts\",\r\n                            \"apiVersion\": \"2020-10-01\",\r\n                            \"name\": \"ActivityLAWorkspaceDelete\",\r\n                            \"location\": \"global\",\r\n                            \"tags\": {\r\n                              \"_deployed_by_amba\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"description\": \"Activity Log LA Workspace Delete\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().id]\"\r\n                              ],\r\n                              \"condition\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"category\",\r\n                                    \"equals\": \"Administrative\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"operationName\",\r\n                                    \"equals\": \"Microsoft.OperationalInsights/workspaces/delete\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"status\",\r\n                                    \"containsAny\": [\r\n                                      \"succeeded\"\r\n                                    ]\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"parameters\": {\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#30": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_DNSZ_RegistrationCapacityUtil_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy PDNSZ Registration Capacity Utilization Alert\",\r\n    \"description\": \"Policy to audit/deploy Private DNS Zone Registration Capacity Utilization Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT1H\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT1H\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"80\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/privateDnsZones\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/privateDnsZones\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"VirtualNetworkWithRegistrationCapacityUtilization\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/privateDnsZones/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-RequestsAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for Private DNS Zone Registration Capacity Utilization\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"VirtualNetworkWithRegistrationCapacityUtilization\",\r\n                            \"metricNamespace\": \"Microsoft.Network/privateDnsZones\",\r\n                            \"metricName\": \"VirtualNetworkWithRegistrationCapacityUtilization\",\r\n                            \"operator\": \"GreaterThanOrEqual\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Maximum\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#31": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_PublicIp_BytesInDDoSAttack_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy PIP Bytes in DDoS Attack Alert\",\r\n    \"description\": \"Policy to audit/deploy PIP Bytes in DDoS Attack Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"4\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"8000000\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"disabled\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/publicIPAddresses\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/publicIPAddresses\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"bytesinddos\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/publicIPAddresses/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-BytesInDDOSAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for Public IP Address Bytes IN DDOS\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"bytesinddos\",\r\n                            \"metricNamespace\": \"Microsoft.Network/publicIPAddresses\",\r\n                            \"metricName\": \"bytesinddos\",\r\n                            \"operator\": \"GreaterThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Maximum\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#32": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_PublicIp_DDoSAttack_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy PIP DDoS Attack Alert\",\r\n    \"description\": \"Policy to audit/deploy PIP DDoS Attack Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"0\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/publicIPAddresses\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/publicIPAddresses\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"ifunderddosattack\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/publicIPAddresses/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-DDOS_Attack')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for Public IP Address Under Attack\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"ifunderddosattack\",\r\n                            \"metricNamespace\": \"Microsoft.Network/publicIPAddresses\",\r\n                            \"metricName\": \"ifunderddosattack\",\r\n                            \"operator\": \"GreaterThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Maximum\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#33": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_PublicIp_PacketsInDDoSAttack_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy PIP Packets in DDoS Attack Alert\",\r\n    \"description\": \"Policy to audit/deploy PIP Packets in DDoS Attack Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"4\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"40000\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"disabled\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/publicIPAddresses\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/publicIPAddresses\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"PacketsInDDoS\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/publicIPAddresses/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-PacketsInDDosAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for Public IP Address Packets IN DDOS\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"PacketsInDDoS\",\r\n                            \"metricNamespace\": \"Microsoft.Network/publicIPAddresses\",\r\n                            \"metricName\": \"PacketsInDDoS\",\r\n                            \"operator\": \"GreaterThanOrEqual\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Total\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#34": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_PublicIp_VIPAvailability_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy PIP VIP Availability Alert\",\r\n    \"description\": \"Policy to audit/deploy PIP VIP Availability Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT1M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"90\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/publicIPAddresses\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/publicIPAddresses\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"VipAvailability\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/publicIPAddresses/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-VIPAvailabityAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for Public IP Address VIP Availability\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"VipAvailability\",\r\n                            \"metricNamespace\": \"Microsoft.Network/publicIPAddresses\",\r\n                            \"metricName\": \"VipAvailability\",\r\n                            \"operator\": \"LessThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#35": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_StorageAccount_Availability_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy SA Availability Alert\",\r\n    \"description\": \"Policy to audit/deploy SA Availability Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Storage\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"90\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"Availability\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Storage/storageAccounts/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-AvailabilityAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for Storage Account Availability\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"Availability\",\r\n                            \"metricNamespace\": \"Microsoft.Storage/storageAccounts\",\r\n                            \"metricName\": \"Availability\",\r\n                            \"operator\": \"LessThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#36": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VM_AvailableMemory_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VM Available Memory Alert\",\r\n    \"description\": \"Policy to audit/deploy VM Available Memory Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Compute\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"1000\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"disabled\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"Available Memory Bytes\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Compute/virtualMachines/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-AvailableMemoryAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for Virtual Machine Available Memory (MBytes)\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"Average_AvailableMBytes\",\r\n                            \"metricNamespace\": \"Microsoft.Compute/virtualMachines\",\r\n                            \"metricName\": \"Available Memory Bytes\",\r\n                            \"operator\": \"LessThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#37": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VM_dataDiskReadLatency_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VM Data Disk Read Latency Alert\",\r\n    \"description\": \"Policy to audit/deploy VM dataDiskReadLatency Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Compute\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\"\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"operator\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Operator\"\r\n        },\r\n        \"allowedvalues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ],\r\n        \"defaultvalue\": \"GreaterThan\"\r\n      },\r\n      \"timeAggregation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"TimeAggregation\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ],\r\n        \"defaultvalue\": \"Average\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"PT24H\"\r\n        ],\r\n        \"defaultValue\": \"PT15M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolve\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolveTime\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve time for the alert in ISO 8601 format\"\r\n        },\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"30\"\r\n      },\r\n      \"failingPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"disaplayname\": \"Failing Periods\",\r\n          \"description\": \"Number of failing periods before alert is fired\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"evaluationPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayname\": \"Evaluation Periods\",\r\n          \"description\": \"The number of aggregated lookback points.\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"computersToInclude\": {\r\n        \"type\": \"array\",\r\n        \"metadata\": {\r\n          \"displayname\": \"Disks to be included to be monitored\",\r\n          \"description\": \"Array of Computer to be monitored\"\r\n        },\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ]\r\n      },\r\n      \"disksToInclude\": {\r\n        \"type\": \"array\",\r\n        \"metadata\": {\r\n          \"displayname\": \"Disks to be included to be monitored\",\r\n          \"description\": \"Array of disk to be monitored for disk both windows and linux\"\r\n        },\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ]\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/displayName\",\r\n                \"equals\": \"[[concat(subscription().displayName, '-VMLowdataDiskReadLatencyAlert')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/scopes[*]\",\r\n                \"equals\": \"[[subscription().id]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"[[deployment().location]\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolve\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolveTime\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"operator\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"timeAggregation\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"failingPeriods\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationPeriods\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"disksToInclude\": {\r\n                    \"type\": \"array\"\r\n                  },\r\n                  \"computersToInclude\": {\r\n                    \"type\": \"array\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"VMdataDiskReadLatencyAlert\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupLocation\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n                            \"apiVersion\": \"2022-08-01-preview\",\r\n                            \"name\": \"[[concat(subscription().displayName, '-VMHighdataDiskReadLatencyAlert')]\",\r\n                            \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                            \"properties\": {\r\n                              \"displayName\": \"[[concat(subscription().displayName, '-VMHighdataDiskReadLatencyAlert')]\",\r\n                              \"description\": \"Log Alert for Virtual Machine dataDiskReadLatency\",\r\n                              \"severity\": \"[[parameters('severity')]\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().Id]\"\r\n                              ],\r\n                              \"targetResourceTypes\": [\r\n                                \"Microsoft.Compute/virtualMachines\"\r\n                              ],\r\n                              \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                              \"windowSize\": \"[[parameters('windowSize')]\",\r\n                              \"criteria\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"query\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"| where Namespace == \\\"LogicalDisk\\\" and Name == \\\"ReadLatencyMs\\\"| extend Disk=tostring(todynamic(Tags)[\\\"vm.azm.ms/mountId\\\"])|where Disk !in ('C:','/')| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, Disk\",\r\n                                    \"metricMeasureColumn\": \"AggregatedValue\",\r\n                                    \"threshold\": \"[[parameters('threshold')]\",\r\n                                    \"operator\": \"[[parameters('operator')]\",\r\n                                    \"resourceIdColumn\": \"_ResourceId\",\r\n                                    \"timeAggregation\": \"[[parameters('timeAggregation')]\",\r\n                                    \"dimensions\": [\r\n                                      {\r\n                                        \"name\": \"Computer\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": \"[[parameters('computersToInclude')]\"\r\n                                      },\r\n                                      {\r\n                                        \"name\": \"Disk\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": \"[[parameters('disksToInclude')]\"\r\n                                      }\r\n                                    ],\r\n                                    \"failingPeriods\": {\r\n                                      \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\r\n                                      \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\r\n                                    }\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                              \"ruleResolveConfiguration\": {\r\n                                \"autoResolved\": \"[[parameters('autoResolve')]\",\r\n                                \"timeToResolve\": \"[[parameters('autoResolveTime')]\"\r\n                              },\r\n                              \"parameters\": {\r\n                                \"alertResourceGroupName\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"alertResourceGroupLocation\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"severity\": {\r\n                                  \"value\": \"[[parameters('severity')]\"\r\n                                },\r\n                                \"windowSize\": {\r\n                                  \"value\": \"[[parameters('windowSize')]\"\r\n                                },\r\n                                \"evaluationFrequency\": {\r\n                                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                                },\r\n                                \"autoMitigate\": {\r\n                                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                                },\r\n                                \"autoResolve\": {\r\n                                  \"value\": \"[[parameters('autoResolve')]\"\r\n                                },\r\n                                \"autoResolveTime\": {\r\n                                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                                },\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                },\r\n                                \"threshold\": {\r\n                                  \"value\": \"[[parameters('threshold')]\"\r\n                                },\r\n                                \"failingPeriods\": {\r\n                                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                                },\r\n                                \"evaluationPeriods\": {\r\n                                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                                },\r\n                                \"disksToInclude\": {\r\n                                  \"value\": \"[[parameters('disksToInclude')]\"\r\n                                },\r\n                                \"computersToInclude\": {\r\n                                  \"value\": \"[[parameters('computersToInclude')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        },\r\n                        \"alertResourceGroupLocation\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"autoResolve\": {\r\n                  \"value\": \"[[parameters('autoResolve')]\"\r\n                },\r\n                \"autoResolveTime\": {\r\n                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                },\r\n                \"operator\": {\r\n                  \"value\": \"[[parameters('operator')]\"\r\n                },\r\n                \"timeAggregation\": {\r\n                  \"value\": \"[[parameters('timeAggregation')]\"\r\n                },\r\n                \"failingPeriods\": {\r\n                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                },\r\n                \"evaluationPeriods\": {\r\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                },\r\n                \"disksToInclude\": {\r\n                  \"value\": \"[[parameters('disksToInclude')]\"\r\n                },\r\n                \"computersToInclude\": {\r\n                  \"value\": \"[[parameters('computersToInclude')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#38": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VM_dataDiskSpace_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VM Data Disk Space Alert\",\r\n    \"description\": \"Policy to audit/deploy VM data Disk Space Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Compute\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\"\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"operator\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Operator\"\r\n        },\r\n        \"allowedvalues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ],\r\n        \"defaultvalue\": \"LessThan\"\r\n      },\r\n      \"timeAggregation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"TimeAggregation\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ],\r\n        \"defaultvalue\": \"Average\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"PT24H\"\r\n        ],\r\n        \"defaultValue\": \"PT15M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolve\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolveTime\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve time for the alert in ISO 8601 format\"\r\n        },\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"10\"\r\n      },\r\n      \"failingPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"disaplayname\": \"Failing Periods\",\r\n          \"description\": \"Number of failing periods before alert is fired\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"evaluationPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"disaplayname\": \"Evaluation Periods\",\r\n          \"description\": \"The number of aggregated lookback points.\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"disksToInclude\": {\r\n        \"type\": \"array\",\r\n        \"metadata\": {\r\n          \"displayname\": \"Disks to be included to be monitored\",\r\n          \"description\": \"Array of disk to be monitored for disk both Windows and Linux\"\r\n        },\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ]\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/displayName\",\r\n                \"equals\": \"[[concat(subscription().displayName, '-VMLowdataDiskSpaceAlert')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/scopes[*]\",\r\n                \"equals\": \"[[subscription().id]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"[[deployment().location]\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolve\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolveTime\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"operator\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"timeAggregation\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"failingPeriods\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationPeriods\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"disksToInclude\": {\r\n                    \"type\": \"array\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"VMdataDiskSpaceAlert\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupLocation\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n                            \"apiVersion\": \"2022-08-01-preview\",\r\n                            \"name\": \"[[concat(subscription().displayName, '-VMLowdataDiskSpaceAlert')]\",\r\n                            \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                            \"properties\": {\r\n                              \"displayName\": \"[[concat(subscription().displayName, '-VMLowdataDiskSpaceAlert')]\",\r\n                              \"description\": \"Log Alert for Virtual Machine dataDiskSpace\",\r\n                              \"severity\": \"[[parameters('severity')]\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().Id]\"\r\n                              ],\r\n                              \"targetResourceTypes\": [\r\n                                \"Microsoft.Compute/virtualMachines\"\r\n                              ],\r\n                              \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                              \"windowSize\": \"[[parameters('windowSize')]\",\r\n                              \"criteria\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"query\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"| where Namespace == \\\"LogicalDisk\\\" and Name == \\\"FreeSpacePercentage\\\"| extend Disk=tostring(todynamic(Tags)[\\\"vm.azm.ms/mountId\\\"])|where Disk !in ('C:','/')| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, Disk\",\r\n                                    \"metricMeasureColumn\": \"AggregatedValue\",\r\n                                    \"threshold\": \"[[parameters('threshold')]\",\r\n                                    \"operator\": \"[[parameters('operator')]\",\r\n                                    \"resourceIdColumn\": \"_ResourceId\",\r\n                                    \"timeAggregation\": \"[[parameters('timeAggregation')]\",\r\n                                    \"dimensions\": [\r\n                                      {\r\n                                        \"name\": \"Computer\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": [\r\n                                          \"*\"\r\n                                        ]\r\n                                      },\r\n                                      {\r\n                                        \"name\": \"Disk\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": \"[[parameters('disksToInclude')]\"\r\n                                      }\r\n                                    ],\r\n                                    \"failingPeriods\": {\r\n                                      \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\r\n                                      \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\r\n                                    }\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                              \"ruleResolveConfiguration\": {\r\n                                \"autoResolved\": \"[[parameters('autoResolve')]\",\r\n                                \"timeToResolve\": \"[[parameters('autoResolveTime')]\"\r\n                              },\r\n                              \"parameters\": {\r\n                                \"alertResourceGroupName\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"alertResourceGroupLocation\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"severity\": {\r\n                                  \"value\": \"[[parameters('severity')]\"\r\n                                },\r\n                                \"windowSize\": {\r\n                                  \"value\": \"[[parameters('windowSize')]\"\r\n                                },\r\n                                \"evaluationFrequency\": {\r\n                                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                                },\r\n                                \"autoMitigate\": {\r\n                                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                                },\r\n                                \"autoResolve\": {\r\n                                  \"value\": \"[[parameters('autoResolve')]\"\r\n                                },\r\n                                \"autoResolveTime\": {\r\n                                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                                },\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                },\r\n                                \"threshold\": {\r\n                                  \"value\": \"[[parameters('threshold')]\"\r\n                                },\r\n                                \"failingPeriods\": {\r\n                                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                                },\r\n                                \"evaluationPeriods\": {\r\n                                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                                },\r\n                                \"disksToInclude\": {\r\n                                  \"value\": \"[[parameters('disksToInclude')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        },\r\n                        \"alertResourceGroupLocation\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"autoResolve\": {\r\n                  \"value\": \"[[parameters('autoResolve')]\"\r\n                },\r\n                \"autoResolveTime\": {\r\n                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                },\r\n                \"operator\": {\r\n                  \"value\": \"[[parameters('operator')]\"\r\n                },\r\n                \"timeAggregation\": {\r\n                  \"value\": \"[[parameters('timeAggregation')]\"\r\n                },\r\n                \"failingPeriods\": {\r\n                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                },\r\n                \"evaluationPeriods\": {\r\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                },\r\n                \"disksToInclude\": {\r\n                  \"value\": \"[[parameters('disksToInclude')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#39": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VM_dataDiskWriteLatency_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VM Data Disk Write Latency Alert\",\r\n    \"description\": \"Policy to audit/deploy VM dataDiskWriteLatency Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Compute\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\"\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"operator\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Operator\"\r\n        },\r\n        \"allowedvalues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ],\r\n        \"defaultvalue\": \"GreaterThan\"\r\n      },\r\n      \"timeAggregation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"TimeAggregation\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ],\r\n        \"defaultvalue\": \"Average\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"PT24H\"\r\n        ],\r\n        \"defaultValue\": \"PT15M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolve\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolveTime\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve time for the alert in ISO 8601 format\"\r\n        },\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"30\"\r\n      },\r\n      \"failingPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"disaplayname\": \"Failing Periods\",\r\n          \"description\": \"Number of failing periods before alert is fired\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"evaluationPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayname\": \"Evaluation Periods\",\r\n          \"description\": \"The number of aggregated lookback points.\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"computersToInclude\": {\r\n        \"type\": \"array\",\r\n        \"metadata\": {\r\n          \"displayname\": \"Disks to be included to be monitored\",\r\n          \"description\": \"Array of Computer to be monitored\"\r\n        },\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ]\r\n      },\r\n      \"disksToInclude\": {\r\n        \"type\": \"array\",\r\n        \"metadata\": {\r\n          \"displayname\": \"Disks to be included to be monitored\",\r\n          \"description\": \"Array of disk to be monitored for disk both windows and linux\"\r\n        },\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ]\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/displayName\",\r\n                \"equals\": \"[[concat(subscription().displayName, '-VMLowdataDiskWriteLatencyAlert')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/scopes[*]\",\r\n                \"equals\": \"[[subscription().id]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"[[deployment().location]\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolve\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolveTime\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"operator\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"timeAggregation\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"failingPeriods\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationPeriods\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"disksToInclude\": {\r\n                    \"type\": \"array\"\r\n                  },\r\n                  \"computersToInclude\": {\r\n                    \"type\": \"array\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"VMdataDiskWriteLatencyAlert\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupLocation\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n                            \"apiVersion\": \"2022-08-01-preview\",\r\n                            \"name\": \"[[concat(subscription().displayName, '-VMHighdataDiskWriteLatencyAlert')]\",\r\n                            \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                            \"properties\": {\r\n                              \"displayName\": \"[[concat(subscription().displayName, '-VMHighdataDiskWriteLatencyAlert')]\",\r\n                              \"description\": \"Log Alert for Virtual Machine dataDiskWriteLatency\",\r\n                              \"severity\": \"[[parameters('severity')]\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().Id]\"\r\n                              ],\r\n                              \"targetResourceTypes\": [\r\n                                \"Microsoft.Compute/virtualMachines\"\r\n                              ],\r\n                              \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                              \"windowSize\": \"[[parameters('windowSize')]\",\r\n                              \"criteria\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"query\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"| where Namespace == \\\"LogicalDisk\\\" and Name == \\\"WriteLatencyMs\\\"| extend Disk=tostring(todynamic(Tags)[\\\"vm.azm.ms/mountId\\\"])|where Disk !in ('C:','/')| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, Disk\",\r\n                                    \"metricMeasureColumn\": \"AggregatedValue\",\r\n                                    \"threshold\": \"[[parameters('threshold')]\",\r\n                                    \"operator\": \"[[parameters('operator')]\",\r\n                                    \"resourceIdColumn\": \"_ResourceId\",\r\n                                    \"timeAggregation\": \"[[parameters('timeAggregation')]\",\r\n                                    \"dimensions\": [\r\n                                      {\r\n                                        \"name\": \"Computer\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": \"[[parameters('computersToInclude')]\"\r\n                                      },\r\n                                      {\r\n                                        \"name\": \"Disk\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": \"[[parameters('disksToInclude')]\"\r\n                                      }\r\n                                    ],\r\n                                    \"failingPeriods\": {\r\n                                      \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\r\n                                      \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\r\n                                    }\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                              \"ruleResolveConfiguration\": {\r\n                                \"autoResolved\": \"[[parameters('autoResolve')]\",\r\n                                \"timeToResolve\": \"[[parameters('autoResolveTime')]\"\r\n                              },\r\n                              \"parameters\": {\r\n                                \"alertResourceGroupName\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"alertResourceGroupLocation\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"severity\": {\r\n                                  \"value\": \"[[parameters('severity')]\"\r\n                                },\r\n                                \"windowSize\": {\r\n                                  \"value\": \"[[parameters('windowSize')]\"\r\n                                },\r\n                                \"evaluationFrequency\": {\r\n                                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                                },\r\n                                \"autoMitigate\": {\r\n                                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                                },\r\n                                \"autoResolve\": {\r\n                                  \"value\": \"[[parameters('autoResolve')]\"\r\n                                },\r\n                                \"autoResolveTime\": {\r\n                                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                                },\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                },\r\n                                \"threshold\": {\r\n                                  \"value\": \"[[parameters('threshold')]\"\r\n                                },\r\n                                \"failingPeriods\": {\r\n                                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                                },\r\n                                \"evaluationPeriods\": {\r\n                                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                                },\r\n                                \"disksToInclude\": {\r\n                                  \"value\": \"[[parameters('disksToInclude')]\"\r\n                                },\r\n                                \"computersToInclude\": {\r\n                                  \"value\": \"[[parameters('computersToInclude')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        },\r\n                        \"alertResourceGroupLocation\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"autoResolve\": {\r\n                  \"value\": \"[[parameters('autoResolve')]\"\r\n                },\r\n                \"autoResolveTime\": {\r\n                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                },\r\n                \"operator\": {\r\n                  \"value\": \"[[parameters('operator')]\"\r\n                },\r\n                \"timeAggregation\": {\r\n                  \"value\": \"[[parameters('timeAggregation')]\"\r\n                },\r\n                \"failingPeriods\": {\r\n                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                },\r\n                \"evaluationPeriods\": {\r\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                },\r\n                \"disksToInclude\": {\r\n                  \"value\": \"[[parameters('disksToInclude')]\"\r\n                },\r\n                \"computersToInclude\": {\r\n                  \"value\": \"[[parameters('computersToInclude')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#4": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_activitylog_LAWorkspace_KeyRegen\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy Activity Log LA Workspace Regenerate Key Alert\",\r\n    \"description\": \"Policy to Deploy Activity Log LA Workspace Regenerate Key Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Monitoring\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\",\r\n          \"_deployed_by_amba\": true\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring on resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.OperationalInsights/workspaces\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/activityLogAlerts\",\r\n          \"name\": \"ActivityLAWorkspaceRegenKey\",\r\n          \"existenceScope\": \"resourceGroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/ActivityLogAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*]\",\r\n                  \"where\": {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"category\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"Administrative\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"operationName\"\r\n                          },\r\n                          {\r\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"Microsoft.OperationalInsights/workspaces/regeneratesharedkey/action\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                },\r\n                \"equals\": 2\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"[[deployment().location]\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"ActivityLAWorkspaceRegenKey\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"microsoft.insights/activityLogAlerts\",\r\n                            \"apiVersion\": \"2020-10-01\",\r\n                            \"name\": \"ActivityLAWorkspaceRegenKey\",\r\n                            \"location\": \"global\",\r\n                            \"tags\": {\r\n                              \"_deployed_by_amba\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"description\": \"Activity Log LA Workspace Regenerate Key\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().id]\"\r\n                              ],\r\n                              \"condition\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"category\",\r\n                                    \"equals\": \"Administrative\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"operationName\",\r\n                                    \"equals\": \"Microsoft.OperationalInsights/workspaces/regeneratesharedkey/action\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"status\",\r\n                                    \"containsAny\": [\r\n                                      \"succeeded\"\r\n                                    ]\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"parameters\": {\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#40": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VM_HeartBeat_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VM HeartBeat Alert\",\r\n    \"description\": \"Policy to audit/deploy VM HeartBeat Alert for all VMs in the subscription\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Compute\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\"\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"operator\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Operator\"\r\n        },\r\n        \"allowedvalues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ],\r\n        \"defaultvalue\": \"GreaterThan\"\r\n      },\r\n      \"timeAggregation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"TimeAggregation\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ],\r\n        \"defaultvalue\": \"Average\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"PT24H\"\r\n        ],\r\n        \"defaultValue\": \"PT15M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolve\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolveTime\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve time for the alert in ISO 8601 format\"\r\n        },\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"10\"\r\n      },\r\n      \"failingPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"disaplayname\": \"Failing Periods\",\r\n          \"description\": \"Number of failing periods before alert is fired\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"evaluationPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayname\": \"Evaluation Periods\",\r\n          \"description\": \"The number of aggregated lookback points.\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/displayName\",\r\n                \"equals\": \"[[concat(subscription().displayName, '-VMHeartBeatAlert')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/scopes[*]\",\r\n                \"equals\": \"[[subscription().id]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"[[deployment().location]\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolve\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolveTime\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"operator\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"timeAggregation\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"failingPeriods\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationPeriods\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"HeartBeatAlert\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupLocation\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n                            \"apiVersion\": \"2022-08-01-preview\",\r\n                            \"name\": \"[[concat(subscription().displayName, '-VMHeartBeatAlert')]\",\r\n                            \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                            \"properties\": {\r\n                              \"displayName\": \"[[concat(subscription().displayName, '-VMHeartBeatAlert')]\",\r\n                              \"description\": \"Log Alert for Virtual Machine Heartbeat\",\r\n                              \"severity\": \"[[parameters('severity')]\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().Id]\"\r\n                              ],\r\n                              \"targetResourceTypes\": [\r\n                                \"Microsoft.Compute/virtualMachines\"\r\n                              ],\r\n                              \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                              \"windowSize\": \"[[parameters('windowSize')]\",\r\n                              \"criteria\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"query\": \"Heartbeat| summarize TimeGenerated=max(TimeGenerated) by Computer, _ResourceId| extend Duration = datetime_diff('minute',now(),TimeGenerated)| summarize AggregatedValue = min(Duration) by Computer, bin(TimeGenerated,5m), _ResourceId\",\r\n                                    \"metricMeasureColumn\": \"AggregatedValue\",\r\n                                    \"threshold\": \"[[parameters('threshold')]\",\r\n                                    \"operator\": \"[[parameters('operator')]\",\r\n                                    \"resourceIdColumn\": \"_ResourceId\",\r\n                                    \"timeAggregation\": \"[[parameters('timeAggregation')]\",\r\n                                    \"dimensions\": [\r\n                                      {\r\n                                        \"name\": \"Computer\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": [\r\n                                          \"*\"\r\n                                        ]\r\n                                      }\r\n                                    ],\r\n                                    \"failingPeriods\": {\r\n                                      \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\r\n                                      \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\r\n                                    }\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                              \"ruleResolveConfiguration\": {\r\n                                \"autoResolved\": \"[[parameters('autoResolve')]\",\r\n                                \"timeToResolve\": \"[[parameters('autoResolveTime')]\"\r\n                              },\r\n                              \"parameters\": {\r\n                                \"alertResourceGroupName\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"alertResourceGroupLocation\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"severity\": {\r\n                                  \"value\": \"[[parameters('severity')]\"\r\n                                },\r\n                                \"windowSize\": {\r\n                                  \"value\": \"[[parameters('windowSize')]\"\r\n                                },\r\n                                \"evaluationFrequency\": {\r\n                                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                                },\r\n                                \"autoMitigate\": {\r\n                                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                                },\r\n                                \"autoResolve\": {\r\n                                  \"value\": \"[[parameters('autoResolve')]\"\r\n                                },\r\n                                \"autoResolveTime\": {\r\n                                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                                },\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                },\r\n                                \"threshold\": {\r\n                                  \"value\": \"[[parameters('threshold')]\"\r\n                                },\r\n                                \"failingPeriods\": {\r\n                                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                                },\r\n                                \"evaluationPeriods\": {\r\n                                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        },\r\n                        \"alertResourceGroupLocation\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"autoResolve\": {\r\n                  \"value\": \"[[parameters('autoResolve')]\"\r\n                },\r\n                \"autoResolveTime\": {\r\n                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                },\r\n                \"operator\": {\r\n                  \"value\": \"[[parameters('operator')]\"\r\n                },\r\n                \"timeAggregation\": {\r\n                  \"value\": \"[[parameters('timeAggregation')]\"\r\n                },\r\n                \"failingPeriods\": {\r\n                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                },\r\n                \"evaluationPeriods\": {\r\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#41": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VM_HeartBeat_Alert_RG\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VM HeartBeat Alert\",\r\n    \"description\": \"Policy to audit/deploy VM HeartBeat Alert for VMs in the resource group\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Compute\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"operator\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Operator\"\r\n        },\r\n        \"allowedvalues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ],\r\n        \"defaultvalue\": \"GreaterThan\"\r\n      },\r\n      \"timeAggregation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"TimeAggregation\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ],\r\n        \"defaultvalue\": \"Average\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"PT24H\"\r\n        ],\r\n        \"defaultValue\": \"PT15M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolve\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolveTime\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve time for the alert in ISO 8601 format\"\r\n        },\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"10\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/displayName\",\r\n                \"equals\": \"[[concat(resourceGroup().name, '-VMHeartBeatAlert')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name)]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolve\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolveTime\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"operator\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"timeAggregation\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n                    \"apiVersion\": \"2022-08-01-preview\",\r\n                    \"name\": \"[[concat(resourceGroup().name, '-VMHeartBeatAlert')]\",\r\n                    \"location\": \"[[resourceGroup().location]\",\r\n                    \"properties\": {\r\n                      \"displayName\": \"[[concat(resourceGroup().name, '-VMHeartBeatAlert')]\",\r\n                      \"description\": \"Log Alert for Virtual Machine Heartbeat\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[resourceGroup().Id]\"\r\n                      ],\r\n                      \"targetResourceTypes\": [\r\n                        \"Microsoft.Compute/virtualMachines\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"query\": \"Heartbeat| summarize TimeGenerated=max(TimeGenerated) by Computer, _ResourceId| extend Duration = datetime_diff('minute',now(),TimeGenerated)| summarize AggregatedValue = min(Duration) by Computer, bin(TimeGenerated,5m), _ResourceId\",\r\n                            \"metricMeasureColumn\": \"AggregatedValue\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"operator\": \"[[parameters('operator')]\",\r\n                            \"resourceIdColumn\": \"_ResourceId\",\r\n                            \"timeAggregation\": \"[[parameters('timeAggregation')]\",\r\n                            \"dimensions\": [\r\n                              {\r\n                                \"name\": \"Computer\",\r\n                                \"operator\": \"Include\",\r\n                                \"values\": [\r\n                                  \"*\"\r\n                                ]\r\n                              }\r\n                            ],\r\n                            \"failingPeriods\": {\r\n                              \"numberOfEvaluationPeriods\": 1,\r\n                              \"minFailingPeriodsToAlert\": 1\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"ruleResolveConfiguration\": {\r\n                        \"autoResolved\": \"[[parameters('autoResolve')]\",\r\n                        \"timeToResolve\": \"[[parameters('autoResolveTime')]\"\r\n                      },\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"autoResolve\": {\r\n                          \"value\": \"[[parameters('autoResolve')]\"\r\n                        },\r\n                        \"autoResolveTime\": {\r\n                          \"value\": \"[[parameters('autoResolveTime')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"autoResolve\": {\r\n                  \"value\": \"[[parameters('autoResolve')]\"\r\n                },\r\n                \"autoResolveTime\": {\r\n                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                },\r\n                \"operator\": {\r\n                  \"value\": \"[[parameters('operator')]\"\r\n                },\r\n                \"timeAggregation\": {\r\n                  \"value\": \"[[parameters('timeAggregation')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#42": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VM_NetworkIn_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VM Network Read Alert\",\r\n    \"description\": \"Policy to audit/deploy VM Nework Read Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Compute\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\"\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"operator\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Operator\"\r\n        },\r\n        \"allowedvalues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ],\r\n        \"defaultvalue\": \"GreaterThan\"\r\n      },\r\n      \"timeAggregation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"TimeAggregation\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ],\r\n        \"defaultvalue\": \"Average\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"PT24H\"\r\n        ],\r\n        \"defaultValue\": \"PT15M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolve\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolveTime\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve time for the alert in ISO 8601 format\"\r\n        },\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"10000000\"\r\n      },\r\n      \"failingPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayname\": \"Failing Periods\",\r\n          \"description\": \"Number of failing periods before alert is fired\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"evaluationPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayname\": \"Evaluation Periods\",\r\n          \"description\": \"The number of aggregated lookback points.\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"networkInterfacesToInclude\": {\r\n        \"type\": \"array\",\r\n        \"metadata\": {\r\n          \"displayname\": \"Network Interface to be included to be monitored\",\r\n          \"description\": \"Array of Network Interface to be monitored\"\r\n        },\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ]\r\n      },\r\n      \"computersToInclude\": {\r\n        \"type\": \"array\",\r\n        \"metadata\": {\r\n          \"displayname\": \"Disks to be included to be monitored\",\r\n          \"description\": \"Array of Computer to be monitored\"\r\n        },\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ]\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/displayName\",\r\n                \"equals\": \"[[concat(subscription().displayName, '-VMHighNetwrokInAlert')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/scopes[*]\",\r\n                \"equals\": \"[[subscription().id]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"[[deployment().location]\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolve\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolveTime\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"operator\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"timeAggregation\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"failingPeriods\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationPeriods\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"computersToInclude\": {\r\n                    \"type\": \"array\"\r\n                  },\r\n                  \"networkInterfaceToInclude\": {\r\n                    \"type\": \"array\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"VMNetworkInAlert\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupLocation\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n                            \"apiVersion\": \"2022-08-01-preview\",\r\n                            \"name\": \"[[concat(subscription().displayName, '-VMHighNetworkInAlert')]\",\r\n                            \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                            \"properties\": {\r\n                              \"displayName\": \"[[concat(subscription().displayName, '-VMHighNetworkInAlert')]\",\r\n                              \"description\": \"Log Alert for Virtual Machine NetworkIn\",\r\n                              \"severity\": \"[[parameters('severity')]\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().Id]\"\r\n                              ],\r\n                              \"targetResourceTypes\": [\r\n                                \"Microsoft.Compute/virtualMachines\"\r\n                              ],\r\n                              \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                              \"windowSize\": \"[[parameters('windowSize')]\",\r\n                              \"criteria\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"query\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"| where Namespace == \\\"Network\\\" and Name == \\\"ReadBytesPerSecond\\\"| | extend NetworkInterface=tostring(todynamic(Tags)[\\\"vm.azm.ms/networkDeviceId\\\"])|summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, NetworkInterface\",\r\n                                    \"metricMeasureColumn\": \"AggregatedValue\",\r\n                                    \"threshold\": \"[[parameters('threshold')]\",\r\n                                    \"operator\": \"[[parameters('operator')]\",\r\n                                    \"resourceIdColumn\": \"_ResourceId\",\r\n                                    \"timeAggregation\": \"[[parameters('timeAggregation')]\",\r\n                                    \"dimensions\": [\r\n                                      {\r\n                                        \"name\": \"Computer\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": \"[[parameters('computersToInclude')]\"\r\n                                      },\r\n                                      {\r\n                                        \"name\": \"NetworkInterface\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": \"[[parameters('networkInterfacesToInclude')]\"\r\n                                      }\r\n                                    ],\r\n                                    \"failingPeriods\": {\r\n                                      \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\r\n                                      \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\r\n                                    }\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                              \"ruleResolveConfiguration\": {\r\n                                \"autoResolved\": \"[[parameters('autoResolve')]\",\r\n                                \"timeToResolve\": \"[[parameters('autoResolveTime')]\"\r\n                              },\r\n                              \"parameters\": {\r\n                                \"alertResourceGroupName\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"alertResourceGroupLocation\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"severity\": {\r\n                                  \"value\": \"[[parameters('severity')]\"\r\n                                },\r\n                                \"windowSize\": {\r\n                                  \"value\": \"[[parameters('windowSize')]\"\r\n                                },\r\n                                \"evaluationFrequency\": {\r\n                                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                                },\r\n                                \"autoMitigate\": {\r\n                                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                                },\r\n                                \"autoResolve\": {\r\n                                  \"value\": \"[[parameters('autoResolve')]\"\r\n                                },\r\n                                \"autoResolveTime\": {\r\n                                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                                },\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                },\r\n                                \"threshold\": {\r\n                                  \"value\": \"[[parameters('threshold')]\"\r\n                                },\r\n                                \"failingPeriods\": {\r\n                                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                                },\r\n                                \"evaluationPeriods\": {\r\n                                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                                },\r\n                                \"computersToInclude\": {\r\n                                  \"value\": \"[[parameters('computersToInclude')]\"\r\n                                },\r\n                                \"networkInterfacesToInclude\": {\r\n                                  \"value\": \"[[parameters('networkInterfacesToInclude')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        },\r\n                        \"alertResourceGroupLocation\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"autoResolve\": {\r\n                  \"value\": \"[[parameters('autoResolve')]\"\r\n                },\r\n                \"autoResolveTime\": {\r\n                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                },\r\n                \"operator\": {\r\n                  \"value\": \"[[parameters('operator')]\"\r\n                },\r\n                \"timeAggregation\": {\r\n                  \"value\": \"[[parameters('timeAggregation')]\"\r\n                },\r\n                \"failingPeriods\": {\r\n                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                },\r\n                \"evaluationPeriods\": {\r\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                },\r\n                \"computersToInclude\": {\r\n                  \"value\": \"[[parameters('computersToInclude')]\"\r\n                },\r\n                \"networkInterfacesToInclude\": {\r\n                  \"value\": \"[[parameters('networkInterfacesToInclude')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#43": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VM_NetworkOut_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VM Network Write Alert\",\r\n    \"description\": \"Policy to audit/deploy VM Network Out Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Compute\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\"\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"operator\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Operator\"\r\n        },\r\n        \"allowedvalues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ],\r\n        \"defaultvalue\": \"GreaterThan\"\r\n      },\r\n      \"timeAggregation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"TimeAggregation\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ],\r\n        \"defaultvalue\": \"Average\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"PT24H\"\r\n        ],\r\n        \"defaultValue\": \"PT15M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolve\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolveTime\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve time for the alert in ISO 8601 format\"\r\n        },\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"10000000\"\r\n      },\r\n      \"failingPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayname\": \"Failing Periods\",\r\n          \"description\": \"Number of failing periods before alert is fired\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"evaluationPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayname\": \"Evaluation Periods\",\r\n          \"description\": \"The number of aggregated lookback points.\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"computersToInclude\": {\r\n        \"type\": \"array\",\r\n        \"metadata\": {\r\n          \"displayname\": \"Disks to be included to be monitored\",\r\n          \"description\": \"Array of Computer to be monitored\"\r\n        },\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ]\r\n      },\r\n      \"networkInterfacesToInclude\": {\r\n        \"type\": \"array\",\r\n        \"metadata\": {\r\n          \"displayname\": \"Network Interface to be included to be monitored\",\r\n          \"description\": \"Array of Network Interface to be monitored\"\r\n        },\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ]\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/displayName\",\r\n                \"equals\": \"[[concat(subscription().displayName, '-VMHighNetwrokInAlert')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/scopes[*]\",\r\n                \"equals\": \"[[subscription().id]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"[[deployment().location]\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolve\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolveTime\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"operator\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"timeAggregation\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"failingPeriods\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationPeriods\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"computersToInclude\": {\r\n                    \"type\": \"array\"\r\n                  },\r\n                  \"networkInterfaceToInclude\": {\r\n                    \"type\": \"array\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"VMNetworkOutAlert\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupLocation\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n                            \"apiVersion\": \"2022-08-01-preview\",\r\n                            \"name\": \"[[concat(subscription().displayName, '-VMHighNetworkOutAlert')]\",\r\n                            \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                            \"properties\": {\r\n                              \"displayName\": \"[[concat(subscription().displayName, '-VMHighNetworOutAlert')]\",\r\n                              \"description\": \"Log Alert for Virtual Machine NetworkOut\",\r\n                              \"severity\": \"[[parameters('severity')]\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().Id]\"\r\n                              ],\r\n                              \"targetResourceTypes\": [\r\n                                \"Microsoft.Compute/virtualMachines\"\r\n                              ],\r\n                              \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                              \"windowSize\": \"[[parameters('windowSize')]\",\r\n                              \"criteria\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"query\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"| where Namespace == \\\"Network\\\" and Name == \\\"WriteBytesPerSecond\\\"| extend NetworkInterface=tostring(todynamic(Tags)[\\\"vm.azm.ms/networkDeviceId\\\"])|summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, NetworkInterface\",\r\n                                    \"metricMeasureColumn\": \"AggregatedValue\",\r\n                                    \"threshold\": \"[[parameters('threshold')]\",\r\n                                    \"operator\": \"[[parameters('operator')]\",\r\n                                    \"resourceIdColumn\": \"_ResourceId\",\r\n                                    \"timeAggregation\": \"[[parameters('timeAggregation')]\",\r\n                                    \"dimensions\": [\r\n                                      {\r\n                                        \"name\": \"Computer\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": \"[[parameters('computersToInclude')]\"\r\n                                      },\r\n                                      {\r\n                                        \"name\": \"NetworkInterface\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": \"[[parameters('networkInterfacesToInclude')]\"\r\n                                      }\r\n                                    ],\r\n                                    \"failingPeriods\": {\r\n                                      \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\r\n                                      \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\r\n                                    }\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                              \"ruleResolveConfiguration\": {\r\n                                \"autoResolved\": \"[[parameters('autoResolve')]\",\r\n                                \"timeToResolve\": \"[[parameters('autoResolveTime')]\"\r\n                              },\r\n                              \"parameters\": {\r\n                                \"alertResourceGroupName\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"alertResourceGroupLocation\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"severity\": {\r\n                                  \"value\": \"[[parameters('severity')]\"\r\n                                },\r\n                                \"windowSize\": {\r\n                                  \"value\": \"[[parameters('windowSize')]\"\r\n                                },\r\n                                \"evaluationFrequency\": {\r\n                                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                                },\r\n                                \"autoMitigate\": {\r\n                                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                                },\r\n                                \"autoResolve\": {\r\n                                  \"value\": \"[[parameters('autoResolve')]\"\r\n                                },\r\n                                \"autoResolveTime\": {\r\n                                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                                },\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                },\r\n                                \"threshold\": {\r\n                                  \"value\": \"[[parameters('threshold')]\"\r\n                                },\r\n                                \"failingPeriods\": {\r\n                                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                                },\r\n                                \"evaluationPeriods\": {\r\n                                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                                },\r\n                                \"computersToInclude\": {\r\n                                  \"value\": \"[[parameters('computersToInclude')]\"\r\n                                },\r\n                                \"networkInterfacesToInclude\": {\r\n                                  \"value\": \"[[parameters('networkInterfacesToInclude')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        },\r\n                        \"alertResourceGroupLocation\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"autoResolve\": {\r\n                  \"value\": \"[[parameters('autoResolve')]\"\r\n                },\r\n                \"autoResolveTime\": {\r\n                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                },\r\n                \"operator\": {\r\n                  \"value\": \"[[parameters('operator')]\"\r\n                },\r\n                \"timeAggregation\": {\r\n                  \"value\": \"[[parameters('timeAggregation')]\"\r\n                },\r\n                \"failingPeriods\": {\r\n                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                },\r\n                \"evaluationPeriods\": {\r\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                },\r\n                \"computersToInclude\": {\r\n                  \"value\": \"[[parameters('computersToInclude')]\"\r\n                },\r\n                \"networkInterfacesToInclude\": {\r\n                  \"value\": \"[[parameters('networkInterfacesToInclude')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#44": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VM_OSDiskreadLatency_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VM OS Disk Read Latency Alert\",\r\n    \"description\": \"Policy to audit/deploy VM OSDiskreadLatency Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Compute\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\"\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"operator\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Operator\"\r\n        },\r\n        \"allowedvalues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ],\r\n        \"defaultvalue\": \"GreaterThan\"\r\n      },\r\n      \"timeAggregation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"TimeAggregation\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ],\r\n        \"defaultvalue\": \"Average\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"PT24H\"\r\n        ],\r\n        \"defaultValue\": \"PT15M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolve\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolveTime\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve time for the alert in ISO 8601 format\"\r\n        },\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"30\"\r\n      },\r\n      \"failingPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"disaplayname\": \"Failing Periods\",\r\n          \"description\": \"Number of failing periods before alert is fired\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"evaluationPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayname\": \"Evaluation Periods\",\r\n          \"description\": \"The number of aggregated lookback points.\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"computersToInclude\": {\r\n        \"type\": \"array\",\r\n        \"metadata\": {\r\n          \"displayname\": \"Disks to be included to be monitored\",\r\n          \"description\": \"Array of Computer to be monitored\"\r\n        },\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ]\r\n      },\r\n      \"disksToInclude\": {\r\n        \"type\": \"array\",\r\n        \"metadata\": {\r\n          \"displayname\": \"Disks to be included to be monitored\",\r\n          \"description\": \"Array of disk to be monitored for disk both windows and linux\"\r\n        },\r\n        \"defaultValue\": [\r\n          \"C:\",\r\n          \"/\"\r\n        ]\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/displayName\",\r\n                \"equals\": \"[[concat(subscription().displayName, '-VMLowOSDiskreadLatencyAlert')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/scopes[*]\",\r\n                \"equals\": \"[[subscription().id]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"[[deployment().location]\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolve\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolveTime\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"operator\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"timeAggregation\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"failingPeriods\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationPeriods\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"disksToInclude\": {\r\n                    \"type\": \"array\"\r\n                  },\r\n                  \"computersToInclude\": {\r\n                    \"type\": \"array\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"VMOSDiskreadLatencyAlert\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupLocation\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n                            \"apiVersion\": \"2022-08-01-preview\",\r\n                            \"name\": \"[[concat(subscription().displayName, '-VMLowOSDiskreadLatencyAlert')]\",\r\n                            \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                            \"properties\": {\r\n                              \"displayName\": \"[[concat(subscription().displayName, '-VMLowOSDiskreadLatencyAlert')]\",\r\n                              \"description\": \"Log Alert for Virtual Machine OSDiskreadLatency\",\r\n                              \"severity\": \"[[parameters('severity')]\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().Id]\"\r\n                              ],\r\n                              \"targetResourceTypes\": [\r\n                                \"Microsoft.Compute/virtualMachines\"\r\n                              ],\r\n                              \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                              \"windowSize\": \"[[parameters('windowSize')]\",\r\n                              \"criteria\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"query\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"| where Namespace == \\\"LogicalDisk\\\" and Name == \\\"ReadLatencyMs\\\"| extend Disk=tostring(todynamic(Tags)[\\\"vm.azm.ms/mountId\\\"])| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, Disk\",\r\n                                    \"metricMeasureColumn\": \"AggregatedValue\",\r\n                                    \"threshold\": \"[[parameters('threshold')]\",\r\n                                    \"operator\": \"[[parameters('operator')]\",\r\n                                    \"resourceIdColumn\": \"_ResourceId\",\r\n                                    \"timeAggregation\": \"[[parameters('timeAggregation')]\",\r\n                                    \"dimensions\": [\r\n                                      {\r\n                                        \"name\": \"Computer\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": \"[[parameters('computersToInclude')]\"\r\n                                      },\r\n                                      {\r\n                                        \"name\": \"Disk\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": \"[[parameters('disksToInclude')]\"\r\n                                      }\r\n                                    ],\r\n                                    \"failingPeriods\": {\r\n                                      \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\r\n                                      \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\r\n                                    }\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                              \"ruleResolveConfiguration\": {\r\n                                \"autoResolved\": \"[[parameters('autoResolve')]\",\r\n                                \"timeToResolve\": \"[[parameters('autoResolveTime')]\"\r\n                              },\r\n                              \"parameters\": {\r\n                                \"alertResourceGroupName\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"alertResourceGroupLocation\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"severity\": {\r\n                                  \"value\": \"[[parameters('severity')]\"\r\n                                },\r\n                                \"windowSize\": {\r\n                                  \"value\": \"[[parameters('windowSize')]\"\r\n                                },\r\n                                \"evaluationFrequency\": {\r\n                                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                                },\r\n                                \"autoMitigate\": {\r\n                                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                                },\r\n                                \"autoResolve\": {\r\n                                  \"value\": \"[[parameters('autoResolve')]\"\r\n                                },\r\n                                \"autoResolveTime\": {\r\n                                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                                },\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                },\r\n                                \"threshold\": {\r\n                                  \"value\": \"[[parameters('threshold')]\"\r\n                                },\r\n                                \"failingPeriods\": {\r\n                                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                                },\r\n                                \"evaluationPeriods\": {\r\n                                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                                },\r\n                                \"disksToInclude\": {\r\n                                  \"value\": \"[[parameters('disksToInclude')]\"\r\n                                },\r\n                                \"computersToInclude\": {\r\n                                  \"value\": \"[[parameters('computersToInclude')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        },\r\n                        \"alertResourceGroupLocation\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"autoResolve\": {\r\n                  \"value\": \"[[parameters('autoResolve')]\"\r\n                },\r\n                \"autoResolveTime\": {\r\n                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                },\r\n                \"operator\": {\r\n                  \"value\": \"[[parameters('operator')]\"\r\n                },\r\n                \"timeAggregation\": {\r\n                  \"value\": \"[[parameters('timeAggregation')]\"\r\n                },\r\n                \"failingPeriods\": {\r\n                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                },\r\n                \"evaluationPeriods\": {\r\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                },\r\n                \"disksToInclude\": {\r\n                  \"value\": \"[[parameters('disksToInclude')]\"\r\n                },\r\n                \"computersToInclude\": {\r\n                  \"value\": \"[[parameters('computersToInclude')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#45": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VM_OSDiskSpace_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VM OS Disk Space Alert\",\r\n    \"description\": \"Policy to audit/deploy VM OSDiskSpace Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Compute\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\"\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"operator\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Operator\"\r\n        },\r\n        \"allowedvalues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ],\r\n        \"defaultvalue\": \"LessThan\"\r\n      },\r\n      \"timeAggregation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"TimeAggregation\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ],\r\n        \"defaultvalue\": \"Average\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"PT24H\"\r\n        ],\r\n        \"defaultValue\": \"PT15M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolve\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolveTime\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve time for the alert in ISO 8601 format\"\r\n        },\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"10\"\r\n      },\r\n      \"failingPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"disaplayname\": \"Failing Periods\",\r\n          \"description\": \"Number of failing periods before alert is fired\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"evaluationPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayname\": \"Evaluation Periods\",\r\n          \"description\": \"The number of aggregated lookback points.\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"computersToInclude\": {\r\n        \"type\": \"array\",\r\n        \"metadata\": {\r\n          \"displayname\": \"Disks to be included to be monitored\",\r\n          \"description\": \"Array of Computer to be monitored\"\r\n        },\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ]\r\n      },\r\n      \"disksToInclude\": {\r\n        \"type\": \"array\",\r\n        \"metadata\": {\r\n          \"displayname\": \"Disks to be included to be monitored\",\r\n          \"description\": \"Array of disk to be monitored for disk both windows and linux\"\r\n        },\r\n        \"defaultValue\": [\r\n          \"C:\",\r\n          \"/\"\r\n        ]\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/displayName\",\r\n                \"equals\": \"[[concat(subscription().displayName, '-VMLowOSDiskSpaceAlert')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/scopes[*]\",\r\n                \"equals\": \"[[subscription().id]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"[[deployment().location]\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolve\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolveTime\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"operator\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"timeAggregation\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"failingPeriods\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationPeriods\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"disksToInclude\": {\r\n                    \"type\": \"array\"\r\n                  },\r\n                  \"computersToInclude\": {\r\n                    \"type\": \"array\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"VMOSDiskSpaceAlert\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupLocation\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n                            \"apiVersion\": \"2022-08-01-preview\",\r\n                            \"name\": \"[[concat(subscription().displayName, '-VMLowOSDiskSpaceAlert')]\",\r\n                            \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                            \"properties\": {\r\n                              \"displayName\": \"[[concat(subscription().displayName, '-VMLowOSDiskSpaceAlert')]\",\r\n                              \"description\": \"Log Alert for Virtual Machine OSDiskSpace\",\r\n                              \"severity\": \"[[parameters('severity')]\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().Id]\"\r\n                              ],\r\n                              \"targetResourceTypes\": [\r\n                                \"Microsoft.Compute/virtualMachines\"\r\n                              ],\r\n                              \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                              \"windowSize\": \"[[parameters('windowSize')]\",\r\n                              \"criteria\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"query\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"| where Namespace == \\\"LogicalDisk\\\" and Name == \\\"FreeSpacePercentage\\\"| extend Disk=tostring(todynamic(Tags)[\\\"vm.azm.ms/mountId\\\"])| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, Disk\",\r\n                                    \"metricMeasureColumn\": \"AggregatedValue\",\r\n                                    \"threshold\": \"[[parameters('threshold')]\",\r\n                                    \"operator\": \"[[parameters('operator')]\",\r\n                                    \"resourceIdColumn\": \"_ResourceId\",\r\n                                    \"timeAggregation\": \"[[parameters('timeAggregation')]\",\r\n                                    \"dimensions\": [\r\n                                      {\r\n                                        \"name\": \"Computer\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": \"[[parameters('computersToInclude')]\"\r\n                                      },\r\n                                      {\r\n                                        \"name\": \"Disk\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": \"[[parameters('disksToInclude')]\"\r\n                                      }\r\n                                    ],\r\n                                    \"failingPeriods\": {\r\n                                      \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\r\n                                      \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\r\n                                    }\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                              \"ruleResolveConfiguration\": {\r\n                                \"autoResolved\": \"[[parameters('autoResolve')]\",\r\n                                \"timeToResolve\": \"[[parameters('autoResolveTime')]\"\r\n                              },\r\n                              \"parameters\": {\r\n                                \"alertResourceGroupName\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"alertResourceGroupLocation\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"severity\": {\r\n                                  \"value\": \"[[parameters('severity')]\"\r\n                                },\r\n                                \"windowSize\": {\r\n                                  \"value\": \"[[parameters('windowSize')]\"\r\n                                },\r\n                                \"evaluationFrequency\": {\r\n                                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                                },\r\n                                \"autoMitigate\": {\r\n                                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                                },\r\n                                \"autoResolve\": {\r\n                                  \"value\": \"[[parameters('autoResolve')]\"\r\n                                },\r\n                                \"autoResolveTime\": {\r\n                                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                                },\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                },\r\n                                \"threshold\": {\r\n                                  \"value\": \"[[parameters('threshold')]\"\r\n                                },\r\n                                \"failingPeriods\": {\r\n                                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                                },\r\n                                \"evaluationPeriods\": {\r\n                                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                                },\r\n                                \"disksToInclude\": {\r\n                                  \"value\": \"[[parameters('disksToInclude')]\"\r\n                                },\r\n                                \"computersToInclude\": {\r\n                                  \"value\": \"[[parameters('computersToInclude')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        },\r\n                        \"alertResourceGroupLocation\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"autoResolve\": {\r\n                  \"value\": \"[[parameters('autoResolve')]\"\r\n                },\r\n                \"autoResolveTime\": {\r\n                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                },\r\n                \"operator\": {\r\n                  \"value\": \"[[parameters('operator')]\"\r\n                },\r\n                \"timeAggregation\": {\r\n                  \"value\": \"[[parameters('timeAggregation')]\"\r\n                },\r\n                \"failingPeriods\": {\r\n                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                },\r\n                \"evaluationPeriods\": {\r\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                },\r\n                \"disksToInclude\": {\r\n                  \"value\": \"[[parameters('disksToInclude')]\"\r\n                },\r\n                \"computersToInclude\": {\r\n                  \"value\": \"[[parameters('computersToInclude')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#46": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VM_OSDiskwriteLatency_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VM OS Disk Write Latency Alert\",\r\n    \"description\": \"Policy to audit/deploy VM OSDiskwriteLatency Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Compute\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\"\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"operator\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Operator\"\r\n        },\r\n        \"allowedvalues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ],\r\n        \"defaultvalue\": \"GreaterThan\"\r\n      },\r\n      \"timeAggregation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"TimeAggregation\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ],\r\n        \"defaultvalue\": \"Average\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"PT24H\"\r\n        ],\r\n        \"defaultValue\": \"PT15M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolve\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolveTime\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve time for the alert in ISO 8601 format\"\r\n        },\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"50\"\r\n      },\r\n      \"failingPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"disaplayname\": \"Failing Periods\",\r\n          \"description\": \"Number of failing periods before alert is fired\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"evaluationPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayname\": \"Evaluation Periods\",\r\n          \"description\": \"The number of aggregated lookback points.\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"computersToInclude\": {\r\n        \"type\": \"array\",\r\n        \"metadata\": {\r\n          \"displayname\": \"Disks to be included to be monitored\",\r\n          \"description\": \"Array of Computer to be monitored\"\r\n        },\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ]\r\n      },\r\n      \"disksToInclude\": {\r\n        \"type\": \"array\",\r\n        \"metadata\": {\r\n          \"displayname\": \"Disks to be included to be monitored\",\r\n          \"description\": \"Array of disk to be monitored for disk both windows and linux\"\r\n        },\r\n        \"defaultValue\": [\r\n          \"C:\",\r\n          \"/\"\r\n        ]\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/displayName\",\r\n                \"equals\": \"[[concat(subscription().displayName, '-VMLowOSDiskwriteLatencyAlert')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/scopes[*]\",\r\n                \"equals\": \"[[subscription().id]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"[[deployment().location]\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolve\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolveTime\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"operator\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"timeAggregation\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"failingPeriods\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationPeriods\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"disksToInclude\": {\r\n                    \"type\": \"array\"\r\n                  },\r\n                  \"computersToInclude\": {\r\n                    \"type\": \"array\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"VMOSDiskwriteLatencyAlert\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupLocation\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n                            \"apiVersion\": \"2022-08-01-preview\",\r\n                            \"name\": \"[[concat(subscription().displayName, '-VMLowOSDiskwriteLatencyAlert')]\",\r\n                            \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                            \"properties\": {\r\n                              \"displayName\": \"[[concat(subscription().displayName, '-VMLowOSDiskwriteLatencyAlert')]\",\r\n                              \"description\": \"Log Alert for Virtual Machine OSDiskwriteLatency\",\r\n                              \"severity\": \"[[parameters('severity')]\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().Id]\"\r\n                              ],\r\n                              \"targetResourceTypes\": [\r\n                                \"Microsoft.Compute/virtualMachines\"\r\n                              ],\r\n                              \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                              \"windowSize\": \"[[parameters('windowSize')]\",\r\n                              \"criteria\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"query\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"| where Namespace == \\\"LogicalDisk\\\" and Name == \\\"WriteLatencyMs\\\"| extend Disk=tostring(todynamic(Tags)[\\\"vm.azm.ms/mountId\\\"])| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, Disk\",\r\n                                    \"metricMeasureColumn\": \"AggregatedValue\",\r\n                                    \"threshold\": \"[[parameters('threshold')]\",\r\n                                    \"operator\": \"[[parameters('operator')]\",\r\n                                    \"resourceIdColumn\": \"_ResourceId\",\r\n                                    \"timeAggregation\": \"[[parameters('timeAggregation')]\",\r\n                                    \"dimensions\": [\r\n                                      {\r\n                                        \"name\": \"Computer\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": \"[[parameters('computersToInclude')]\"\r\n                                      },\r\n                                      {\r\n                                        \"name\": \"Disk\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": \"[[parameters('disksToInclude')]\"\r\n                                      }\r\n                                    ],\r\n                                    \"failingPeriods\": {\r\n                                      \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\r\n                                      \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\r\n                                    }\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                              \"ruleResolveConfiguration\": {\r\n                                \"autoResolved\": \"[[parameters('autoResolve')]\",\r\n                                \"timeToResolve\": \"[[parameters('autoResolveTime')]\"\r\n                              },\r\n                              \"parameters\": {\r\n                                \"alertResourceGroupName\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"alertResourceGroupLocation\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"severity\": {\r\n                                  \"value\": \"[[parameters('severity')]\"\r\n                                },\r\n                                \"windowSize\": {\r\n                                  \"value\": \"[[parameters('windowSize')]\"\r\n                                },\r\n                                \"evaluationFrequency\": {\r\n                                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                                },\r\n                                \"autoMitigate\": {\r\n                                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                                },\r\n                                \"autoResolve\": {\r\n                                  \"value\": \"[[parameters('autoResolve')]\"\r\n                                },\r\n                                \"autoResolveTime\": {\r\n                                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                                },\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                },\r\n                                \"threshold\": {\r\n                                  \"value\": \"[[parameters('threshold')]\"\r\n                                },\r\n                                \"failingPeriods\": {\r\n                                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                                },\r\n                                \"evaluationPeriods\": {\r\n                                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                                },\r\n                                \"disksToInclude\": {\r\n                                  \"value\": \"[[parameters('disksToInclude')]\"\r\n                                },\r\n                                \"computersToInclude\": {\r\n                                  \"value\": \"[[parameters('computersToInclude')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        },\r\n                        \"alertResourceGroupLocation\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"autoResolve\": {\r\n                  \"value\": \"[[parameters('autoResolve')]\"\r\n                },\r\n                \"autoResolveTime\": {\r\n                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                },\r\n                \"operator\": {\r\n                  \"value\": \"[[parameters('operator')]\"\r\n                },\r\n                \"timeAggregation\": {\r\n                  \"value\": \"[[parameters('timeAggregation')]\"\r\n                },\r\n                \"failingPeriods\": {\r\n                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                },\r\n                \"evaluationPeriods\": {\r\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                },\r\n                \"disksToInclude\": {\r\n                  \"value\": \"[[parameters('disksToInclude')]\"\r\n                },\r\n                \"computersToInclude\": {\r\n                  \"value\": \"[[parameters('computersToInclude')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#47": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VM_CPU_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VM CPU Alert\",\r\n    \"description\": \"Policy to audit/deploy VM CPU Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Compute\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\"\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"operator\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Operator\"\r\n        },\r\n        \"allowedvalues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ],\r\n        \"defaultvalue\": \"GreaterThan\"\r\n      },\r\n      \"timeAggregation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"TimeAggregation\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ],\r\n        \"defaultvalue\": \"Average\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"PT24H\"\r\n        ],\r\n        \"defaultValue\": \"PT15M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolve\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolveTime\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve time for the alert in ISO 8601 format\"\r\n        },\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"85\"\r\n      },\r\n      \"failingPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayname\": \"Failing Periods\",\r\n          \"description\": \"Number of failing periods before alert is fired\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/displayName\",\r\n                \"equals\": \"[[concat(subscription().displayName, '-VMHighCPUAlert')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/scopes[*]\",\r\n                \"equals\": \"[[subscription().id]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"[[deployment().location]\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolve\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolveTime\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"operator\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"timeAggregation\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"failingPeriods\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"VMCPUAlert\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupLocation\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n                            \"apiVersion\": \"2022-08-01-preview\",\r\n                            \"name\": \"[[concat(subscription().displayName, '-VMHighCPUAlert')]\",\r\n                            \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                            \"properties\": {\r\n                              \"displayName\": \"[[concat(subscription().displayName, '-VMHighCPUAlert')]\",\r\n                              \"description\": \"Log Alert for Virtual Machine CPU\",\r\n                              \"severity\": \"[[parameters('severity')]\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().Id]\"\r\n                              ],\r\n                              \"targetResourceTypes\": [\r\n                                \"Microsoft.Compute/virtualMachines\"\r\n                              ],\r\n                              \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                              \"windowSize\": \"[[parameters('windowSize')]\",\r\n                              \"criteria\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"query\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"| where Namespace == \\\"Processor\\\" and Name == \\\"UtilizationPercentage\\\"| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId\",\r\n                                    \"metricMeasureColumn\": \"AggregatedValue\",\r\n                                    \"threshold\": \"[[parameters('threshold')]\",\r\n                                    \"operator\": \"[[parameters('operator')]\",\r\n                                    \"resourceIdColumn\": \"_ResourceId\",\r\n                                    \"timeAggregation\": \"[[parameters('timeAggregation')]\",\r\n                                    \"dimensions\": [\r\n                                      {\r\n                                        \"name\": \"Computer\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": [\r\n                                          \"*\"\r\n                                        ]\r\n                                      }\r\n                                    ],\r\n                                    \"failingPeriods\": {\r\n                                      \"numberOfEvaluationPeriods\": \"1\",\r\n                                      \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\r\n                                    }\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                              \"ruleResolveConfiguration\": {\r\n                                \"autoResolved\": \"[[parameters('autoResolve')]\",\r\n                                \"timeToResolve\": \"[[parameters('autoResolveTime')]\"\r\n                              },\r\n                              \"parameters\": {\r\n                                \"alertResourceGroupName\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"alertResourceGroupLocation\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"severity\": {\r\n                                  \"value\": \"[[parameters('severity')]\"\r\n                                },\r\n                                \"windowSize\": {\r\n                                  \"value\": \"[[parameters('windowSize')]\"\r\n                                },\r\n                                \"evaluationFrequency\": {\r\n                                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                                },\r\n                                \"autoMitigate\": {\r\n                                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                                },\r\n                                \"autoResolve\": {\r\n                                  \"value\": \"[[parameters('autoResolve')]\"\r\n                                },\r\n                                \"autoResolveTime\": {\r\n                                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                                },\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                },\r\n                                \"threshold\": {\r\n                                  \"value\": \"[[parameters('threshold')]\"\r\n                                },\r\n                                \"failingPeriods\": {\r\n                                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        },\r\n                        \"alertResourceGroupLocation\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"autoResolve\": {\r\n                  \"value\": \"[[parameters('autoResolve')]\"\r\n                },\r\n                \"autoResolveTime\": {\r\n                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                },\r\n                \"operator\": {\r\n                  \"value\": \"[[parameters('operator')]\"\r\n                },\r\n                \"timeAggregation\": {\r\n                  \"value\": \"[[parameters('timeAggregation')]\"\r\n                },\r\n                \"failingPeriods\": {\r\n                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#48": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VM_Memory_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VM Memory Alert\",\r\n    \"description\": \"Policy to audit/deploy VM Memory Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Compute\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\"\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"operator\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Operator\"\r\n        },\r\n        \"allowedvalues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ],\r\n        \"defaultvalue\": \"LessThan\"\r\n      },\r\n      \"timeAggregation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"TimeAggregation\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ],\r\n        \"defaultvalue\": \"Average\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"PT24H\"\r\n        ],\r\n        \"defaultValue\": \"PT15M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolve\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolveTime\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve time for the alert in ISO 8601 format\"\r\n        },\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"10\"\r\n      },\r\n      \"failingPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayname\": \"Failing Periods\",\r\n          \"description\": \"Number of failing periods before alert is fired\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"evaluationPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayname\": \"Evaluation Periods\",\r\n          \"description\": \"The number of aggregated lookback points.\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/displayName\",\r\n                \"equals\": \"[[concat(subscription().displayName, '-VMLowMemoryAlert')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/scopes[*]\",\r\n                \"equals\": \"[[subscription().id]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"[[deployment().location]\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolve\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolveTime\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"operator\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"timeAggregation\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"failingPeriods\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationPeriods\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"VMMemoryAlert\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupLocation\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n                            \"apiVersion\": \"2022-08-01-preview\",\r\n                            \"name\": \"[[concat(subscription().displayName, '-VMLowMemoryAlert')]\",\r\n                            \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                            \"properties\": {\r\n                              \"displayName\": \"[[concat(subscription().displayName, '-VMLowMemoryAlert')]\",\r\n                              \"description\": \"Log Alert for Virtual Machine Memory\",\r\n                              \"severity\": \"[[parameters('severity')]\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().Id]\"\r\n                              ],\r\n                              \"targetResourceTypes\": [\r\n                                \"Microsoft.Compute/virtualMachines\"\r\n                              ],\r\n                              \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                              \"windowSize\": \"[[parameters('windowSize')]\",\r\n                              \"criteria\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"query\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"|where Namespace == \\\"Memory\\\" and Name == \\\"AvailableMB\\\"| extend TotalMemory = toreal(todynamic(Tags)[\\\"vm.azm.ms/memorySizeMB\\\"]) | extend AvailableMemoryPercentage = (toreal(Val) / TotalMemory) * 100.0| summarize AggregatedValue = avg(AvailableMemoryPercentage) by bin(TimeGenerated, 15m), Computer, _ResourceId\",\r\n                                    \"metricMeasureColumn\": \"AggregatedValue\",\r\n                                    \"threshold\": \"[[parameters('threshold')]\",\r\n                                    \"operator\": \"[[parameters('operator')]\",\r\n                                    \"resourceIdColumn\": \"_ResourceId\",\r\n                                    \"timeAggregation\": \"[[parameters('timeAggregation')]\",\r\n                                    \"dimensions\": [\r\n                                      {\r\n                                        \"name\": \"Computer\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": [\r\n                                          \"*\"\r\n                                        ]\r\n                                      }\r\n                                    ],\r\n                                    \"failingPeriods\": {\r\n                                      \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\r\n                                      \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\r\n                                    }\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                              \"ruleResolveConfiguration\": {\r\n                                \"autoResolved\": \"[[parameters('autoResolve')]\",\r\n                                \"timeToResolve\": \"[[parameters('autoResolveTime')]\"\r\n                              },\r\n                              \"parameters\": {\r\n                                \"alertResourceGroupName\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"alertResourceGroupLocation\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"severity\": {\r\n                                  \"value\": \"[[parameters('severity')]\"\r\n                                },\r\n                                \"windowSize\": {\r\n                                  \"value\": \"[[parameters('windowSize')]\"\r\n                                },\r\n                                \"evaluationFrequency\": {\r\n                                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                                },\r\n                                \"autoMitigate\": {\r\n                                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                                },\r\n                                \"autoResolve\": {\r\n                                  \"value\": \"[[parameters('autoResolve')]\"\r\n                                },\r\n                                \"autoResolveTime\": {\r\n                                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                                },\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                },\r\n                                \"threshold\": {\r\n                                  \"value\": \"[[parameters('threshold')]\"\r\n                                },\r\n                                \"failingPeriods\": {\r\n                                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                                },\r\n                                \"evaluationPeriods\": {\r\n                                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        },\r\n                        \"alertResourceGroupLocation\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"autoResolve\": {\r\n                  \"value\": \"[[parameters('autoResolve')]\"\r\n                },\r\n                \"autoResolveTime\": {\r\n                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                },\r\n                \"operator\": {\r\n                  \"value\": \"[[parameters('operator')]\"\r\n                },\r\n                \"timeAggregation\": {\r\n                  \"value\": \"[[parameters('timeAggregation')]\"\r\n                },\r\n                \"failingPeriods\": {\r\n                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                },\r\n                \"evaluationPeriods\": {\r\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#49": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VNET_DDoSAttack_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VNet DDoS Attack Alert\",\r\n    \"description\": \"Policy to audit/deploy Virtual Network DDoS Attack Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT1M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"0\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/virtualNetworks\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/virtualNetworks\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"ifunderddosattack\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/virtualNetworks/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-DDOSAttackAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for VNet DDOS Attack\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"ifunderddosattack\",\r\n                            \"metricNamespace\": \"Microsoft.Network/virtualNetworks\",\r\n                            \"metricName\": \"ifunderddosattack\",\r\n                            \"operator\": \"GreaterThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Maximum\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#5": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_activitylog_NSG_Delete\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy Activity Log NSG Delete Alert\",\r\n    \"description\": \"Policy to Deploy Activity Log NSG Delete Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\",\r\n          \"_deployed_by_amba\": true\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring on resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/networkSecurityGroups\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/activityLogAlerts\",\r\n          \"name\": \"ActivityNSGDelete\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/ActivityLogAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*]\",\r\n                  \"where\": {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"category\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"Administrative\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"operationName\"\r\n                          },\r\n                          {\r\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"Microsoft.Network/networkSecurityGroups/delete\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                },\r\n                \"equals\": 2\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"[[deployment().location]\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"ActivityNSGDelete\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"microsoft.insights/activityLogAlerts\",\r\n                            \"apiVersion\": \"2020-10-01\",\r\n                            \"name\": \"ActivityNSGDelete\",\r\n                            \"location\": \"global\",\r\n                            \"tags\": {\r\n                              \"_deployed_by_amba\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"description\": \"Activity Log NSG Delete\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().id]\"\r\n                              ],\r\n                              \"condition\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"category\",\r\n                                    \"equals\": \"Administrative\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"operationName\",\r\n                                    \"equals\": \"Microsoft.Network/networkSecurityGroups/delete\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"status\",\r\n                                    \"containsAny\": [\r\n                                      \"succeeded\"\r\n                                    ]\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"parameters\": {\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#50": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VnetGw_TunnelBandwidth_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VNetG Tunnel Bandwidth Alert\",\r\n    \"description\": \"Policy to audit/deploy Virtual Network Gateway Tunnel Bandwidth Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"0\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT1M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/virtualNetworkGateways\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.Network/virtualNetworkGateways/gatewayType\",\r\n            \"equals\": \"VPN\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/virtualNetworkGateways\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"TunnelAverageBandwidth\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/virtualNetworkGateways/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelBandwidthAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for VNet Gateway Tunnel Avg Bandwidth\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"TunnelAverageBandwidth\",\r\n                            \"metricNamespace\": \"Microsoft.Network/virtualNetworkGateways\",\r\n                            \"metricName\": \"TunnelAverageBandwidth\",\r\n                            \"operator\": \"LessThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#51": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VnetGw_TunnelEgress_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VNetG Tunnel Egress Alert\",\r\n    \"description\": \"Policy to audit/deploy Virtual Network Gateway Tunnel Egress Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"0\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"disabled\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/virtualNetworkGateways\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.Network/virtualNetworkGateways/gatewayType\",\r\n            \"equals\": \"VPN\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/virtualNetworkGateways\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"TunnelEgressBytes\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/virtualNetworkGateways/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelEgressAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for VNet Gateway Tunnel Egress Bytes\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"TunnelEgressBytes\",\r\n                            \"metricNamespace\": \"Microsoft.Network/virtualNetworkGateways\",\r\n                            \"metricName\": \"TunnelEgressBytes\",\r\n                            \"operator\": \"LessThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#52": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VnetGw_TunnelEgressPacketDropCount_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VNetG Egress Packet Drop Count Alert\",\r\n    \"description\": \"Policy to audit/deploy Vnet Gateway Egress Packet Drop Count Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"3\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.network/virtualNetworkGateways\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.Network/virtualNetworkGateways/gatewayType\",\r\n            \"equals\": \"VPN\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"microsoft.network/virtualNetworkGateways\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"TunnelEgressPacketDropCount\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/virtualNetworkGateways/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelEgressPacketDropCountAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for Vnet Gateway tunnel TunnelEgressPacketDropCount\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"alertSensitivity\": \"Medium\",\r\n                            \"failingPeriods\": {\r\n                              \"numberOfEvaluationPeriods\": 4,\r\n                              \"minFailingPeriodsToAlert\": 4\r\n                            },\r\n                            \"name\": \"TunnelEgressPacketDropCount\",\r\n                            \"metricNamespace\": \"microsoft.network/virtualNetworkGateways\",\r\n                            \"metricName\": \"TunnelEgressPacketDropCount\",\r\n                            \"operator\": \"GreaterThan\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"DynamicThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#53": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VnetGw_TunnelEgressPacketDropMismatch_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VNetG Egress Packet Drop Mismatch Alert\",\r\n    \"description\": \"Policy to audit/deploy Vnet Gateway Egress Packet Drop Mismatch Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"3\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.network/virtualNetworkGateways\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.Network/virtualNetworkGateways/gatewayType\",\r\n            \"equals\": \"VPN\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"microsoft.network/virtualNetworkGateways\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"TunnelEgressPacketDropTSMismatch\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/virtualNetworkGateways/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelEgressPacketDropTSMismatchAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for Vnet Gateway tunnel TunnelEgressPacketDropTSMismatch\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"alertSensitivity\": \"Medium\",\r\n                            \"failingPeriods\": {\r\n                              \"numberOfEvaluationPeriods\": 4,\r\n                              \"minFailingPeriodsToAlert\": 4\r\n                            },\r\n                            \"name\": \"TunnelEgressPacketDropTSMismatch\",\r\n                            \"metricNamespace\": \"microsoft.network/virtualNetworkGateways\",\r\n                            \"metricName\": \"TunnelEgressPacketDropTSMismatch\",\r\n                            \"operator\": \"GreaterThan\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"DynamicThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#54": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VnetGw_ExpressRouteBitsPerSecond_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VNetG ExpressRoute Bits Per Second Alert\",\r\n    \"description\": \"Policy to audit/deploy Virtual Network Gateway Express Route Bits Per Second Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"0\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT1M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/virtualNetworkGateways\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.Network/virtualNetworkGateways/gatewayType\",\r\n            \"equals\": \"ExpressRoute\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/virtualNetworkGateways\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"ExpressRouteGatewayBitsPerSecond\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/virtualNetworkGateways/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-GatewayERBitsAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for VNet Gateway Express Route Bits Per Second\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"ExpressRouteGatewayBitsPerSecond\",\r\n                            \"metricNamespace\": \"Microsoft.Network/virtualNetworkGateways\",\r\n                            \"metricName\": \"ExpressRouteGatewayBitsPerSecond\",\r\n                            \"operator\": \"LessThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#55": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VnetGw_ExpressRouteCpuUtil_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VNetG ExpressRoute CPU Utilization Alert\",\r\n    \"description\": \"Policy to audit/deploy Virtual Network Gateway Express Route CPU Utilization Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT1M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"80\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/virtualNetworkGateways\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.Network/virtualNetworkGateways/gatewayType\",\r\n            \"equals\": \"ExpressRoute\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/virtualNetworkGateways\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"ExpressRouteGatewayCpuUtilization\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/virtualNetworkGateways/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-GatewayERCPUAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for VNet Gateway Express Route CPU Utilization\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"ExpressRouteGatewayCpuUtilization\",\r\n                            \"metricNamespace\": \"Microsoft.Network/virtualNetworkGateways\",\r\n                            \"metricName\": \"ExpressRouteGatewayCpuUtilization\",\r\n                            \"operator\": \"GreaterThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#56": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VnetGw_TunnelIngress_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VNetG Tunnel Ingress Alert\",\r\n    \"description\": \"Policy to audit/deploy Virtual Network Gateway Tunnel Ingress Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"0\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"disabled\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/virtualNetworkGateways\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.Network/virtualNetworkGateways/gatewayType\",\r\n            \"equals\": \"VPN\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/virtualNetworkGateways\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"TunnelIngressBytes\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/virtualNetworkGateways/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelIngressAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for VNet Gateway Tunnel ingress Bytes\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"TunnelIngressBytes\",\r\n                            \"metricNamespace\": \"Microsoft.Network/virtualNetworkGateways\",\r\n                            \"metricName\": \"TunnelIngressBytes\",\r\n                            \"operator\": \"LessThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#57": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VnetGw_TunnelIngressPacketDropCount_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VNetG Ingress Packet Drop Count Alert\",\r\n    \"description\": \"Policy to audit/deploy Vnet Gateway Ingress Packet Drop Count Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"3\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.network/virtualNetworkGateways\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.Network/virtualNetworkGateways/gatewayType\",\r\n            \"equals\": \"VPN\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"microsoft.network/virtualNetworkGateways\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"TunnelIngressPacketDropCount\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/virtualNetworkGateways/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelIngressPacketDropCountAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for Vnet Gateway tunnel TunnelIngressPacketDropCount\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"alertSensitivity\": \"Medium\",\r\n                            \"failingPeriods\": {\r\n                              \"numberOfEvaluationPeriods\": 4,\r\n                              \"minFailingPeriodsToAlert\": 4\r\n                            },\r\n                            \"name\": \"TunnelIngressPacketDropCount\",\r\n                            \"metricNamespace\": \"microsoft.network/virtualNetworkGateways\",\r\n                            \"metricName\": \"TunnelIngressPacketDropCount\",\r\n                            \"operator\": \"GreaterThan\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"DynamicThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#58": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VnetGw_TunnelIngressPacketDropMismatch_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VNetG Ingress Packet Drop Mismatch Alert\",\r\n    \"description\": \"Policy to audit/deploy Vnet Gateway Ingress Packet Drop Mismatch Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"3\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.network/virtualNetworkGateways\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.Network/virtualNetworkGateways/gatewayType\",\r\n            \"equals\": \"VPN\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"microsoft.network/virtualNetworkGateways\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"TunnelIngressPacketDropTSMismatch\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/virtualNetworkGateways/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelIngressPacketDropTSMismatchAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for Vnet Gateway tunnel TunnelIngressPacketDropTSMismatch\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"alertSensitivity\": \"Medium\",\r\n                            \"failingPeriods\": {\r\n                              \"numberOfEvaluationPeriods\": 4,\r\n                              \"minFailingPeriodsToAlert\": 4\r\n                            },\r\n                            \"name\": \"TunnelIngressPacketDropTSMismatch\",\r\n                            \"metricNamespace\": \"microsoft.network/virtualNetworkGateways\",\r\n                            \"metricName\": \"TunnelIngressPacketDropTSMismatch\",\r\n                            \"operator\": \"GreaterThan\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"DynamicThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#59": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VPNGw_BandwidthUtil_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VPNG Bandwidth Utilization Alert\",\r\n    \"description\": \"Policy to audit/deploy VPN Gateway Bandwidth Utilization Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"0\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT1M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.network/vpngateways\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"microsoft.network/vpngateways\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"tunnelaveragebandwidth\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/vpngateways/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-GatewayBandwidthAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for VPN Gateway Bandwidth Utilization\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"tunnelaveragebandwidth\",\r\n                            \"metricNamespace\": \"microsoft.network/vpngateways\",\r\n                            \"metricName\": \"tunnelaveragebandwidth\",\r\n                            \"operator\": \"LessThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#6": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_activitylog_ResourceHealth_Unhealthy_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy Resource Health Unhealthy Alert\",\r\n    \"description\": \"Policy to Deploy Resource Health Unhealthy Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Monitoring\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\",\r\n          \"_deployed_by_amba\": true\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring on subscripton level alerts. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/activityLogAlerts\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/ActivityLogAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*]\",\r\n                  \"where\": {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"category\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"ResourceHealth\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                },\r\n                \"equals\": 1\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"[[deployment().location]\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"ResourceHealtAlert\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"microsoft.insights/activityLogAlerts\",\r\n                            \"apiVersion\": \"2020-10-01\",\r\n                            \"name\": \"ResourceHealthUnhealthyAlert\",\r\n                            \"location\": \"global\",\r\n                            \"tags\": {\r\n                              \"_deployed_by_amba\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"description\": \"Resource Health Unhealthy Alert\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().id]\"\r\n                              ],\r\n                              \"condition\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"category\",\r\n                                    \"equals\": \"ResourceHealth\"\r\n                                  },\r\n                                  {\r\n                                    \"anyOf\": [\r\n                                      {\r\n                                        \"field\": \"properties.cause\",\r\n                                        \"equals\": \"PlatformInitiated\"\r\n                                      },\r\n                                      {\r\n                                        \"field\": \"properties.cause\",\r\n                                        \"equals\": \"UserInitiated\"\r\n                                      }\r\n                                    ]\r\n                                  },\r\n                                  {\r\n                                    \"anyOf\": [\r\n                                      {\r\n                                        \"field\": \"properties.currentHealthStatus\",\r\n                                        \"equals\": \"Degraded\"\r\n                                      },\r\n                                      {\r\n                                        \"field\": \"properties.currentHealthStatus\",\r\n                                        \"equals\": \"Unavailable\"\r\n                                      }\r\n                                    ]\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"parameters\": {\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#60": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VPNGw_BGPPeerStatus_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VPNG  BGP Peer Status Alert\",\r\n    \"description\": \"Policy to audit/deploy VPN Gateway BGP Peer Status Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"0\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT1M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.network/vpngateways\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"microsoft.network/vpngateways\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"bgppeerstatus\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/vpngateways/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-BGPPeerStatusAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for VPN Gateway BGP peer status\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"bgppeerstatus\",\r\n                            \"metricNamespace\": \"microsoft.network/vpngateways\",\r\n                            \"metricName\": \"bgppeerstatus\",\r\n                            \"operator\": \"LessThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Total\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#61": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VPNGw_Egress_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VPNG Egress Alert\",\r\n    \"description\": \"Policy to audit/deploy VPN Gateway Egress Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"0\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"disabled\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.network/vpngateways\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"microsoft.network/vpngateways\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"tunnelegressbytes\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/vpngateways/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelEgressAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for VPN Gateway tunnel egress bytes\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"tunnelegressbytes\",\r\n                            \"metricNamespace\": \"microsoft.network/vpngateways\",\r\n                            \"metricName\": \"tunnelegressbytes\",\r\n                            \"operator\": \"LessThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#62": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VPNGw_TunnelEgressPacketDropCount_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VPNG Egress Packet Drop Count Alert\",\r\n    \"description\": \"Policy to audit/deploy VPN Gateway Egress Packet Drop Count Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"3\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.network/vpngateways\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"microsoft.network/vpngateways\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"TunnelEgressPacketDropCount\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/vpngateways/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelEgressPacketDropCountAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for VPN Gateway tunnel TunnelEgressPacketDropCount\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"alertSensitivity\": \"Medium\",\r\n                            \"failingPeriods\": {\r\n                              \"numberOfEvaluationPeriods\": 4,\r\n                              \"minFailingPeriodsToAlert\": 4\r\n                            },\r\n                            \"name\": \"TunnelEgressPacketDropCount\",\r\n                            \"metricNamespace\": \"microsoft.network/vpngateways\",\r\n                            \"metricName\": \"TunnelEgressPacketDropCount\",\r\n                            \"operator\": \"GreaterThan\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"DynamicThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#63": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VPNGw_TunnelEgressPacketDropMismatch_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VPNG Egress Packet Drop Mismatch Alert\",\r\n    \"description\": \"Policy to audit/deploy VPN Gateway Egress Packet Drop Mismatch Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"3\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.network/vpngateways\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"microsoft.network/vpngateways\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"TunnelEgressPacketDropTSMismatch\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/vpngateways/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelEgressPacketDropTSMismatchAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for VPN Gateway tunnel TunnelEgressPacketDropTSMismatch\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"alertSensitivity\": \"Medium\",\r\n                            \"failingPeriods\": {\r\n                              \"numberOfEvaluationPeriods\": 4,\r\n                              \"minFailingPeriodsToAlert\": 4\r\n                            },\r\n                            \"name\": \"TunnelEgressPacketDropTSMismatch\",\r\n                            \"metricNamespace\": \"microsoft.network/vpngateways\",\r\n                            \"metricName\": \"TunnelEgressPacketDropTSMismatch\",\r\n                            \"operator\": \"GreaterThan\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"DynamicThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#64": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VPNGw_Ingress_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VPNG Ingress Alert\",\r\n    \"description\": \"Policy to audit/deploy VPN Gateway Ingress Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"0\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"disabled\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.network/vpngateways\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"microsoft.network/vpngateways\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"tunnelingressbytes\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/vpngateways/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelIngressAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for VPN Gateway tunnel ingress bytes\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"tunnelingressbytes\",\r\n                            \"metricNamespace\": \"microsoft.network/vpngateways\",\r\n                            \"metricName\": \"tunnelingressbytes\",\r\n                            \"operator\": \"LessThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#65": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VPNGw_TunnelIngressPacketDropCount_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VPNG Ingress Packet Drop Count Alert\",\r\n    \"description\": \"Policy to audit/deploy VPN Gateway Ingress Packet Drop Count Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"3\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.network/vpngateways\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"microsoft.network/vpngateways\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"TunnelIngressPacketDropCount\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/vpngateways/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelIngressPacketDropCountAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for VPN Gateway tunnel TunnelIngressPacketDropCount\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"alertSensitivity\": \"Medium\",\r\n                            \"failingPeriods\": {\r\n                              \"numberOfEvaluationPeriods\": 4,\r\n                              \"minFailingPeriodsToAlert\": 4\r\n                            },\r\n                            \"name\": \"TunnelIngressPacketDropCount\",\r\n                            \"metricNamespace\": \"microsoft.network/vpngateways\",\r\n                            \"metricName\": \"TunnelIngressPacketDropCount\",\r\n                            \"operator\": \"GreaterThan\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"DynamicThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#66": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VPNGw_TunnelIngressPacketDropMismatch_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VPNG Ingress Packet Drop Mismatch Alert\",\r\n    \"description\": \"Policy to audit/deploy VPN Gateway Ingress Packet Drop Mismatch Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"3\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.network/vpngateways\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"microsoft.network/vpngateways\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"TunnelIngressPacketDropTSMismatch\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/vpngateways/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelIngressPacketDropTSMismatchAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for VPN Gateway tunnel TunnelIngressPacketDropTSMismatch\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"alertSensitivity\": \"Medium\",\r\n                            \"failingPeriods\": {\r\n                              \"numberOfEvaluationPeriods\": 4,\r\n                              \"minFailingPeriodsToAlert\": 4\r\n                            },\r\n                            \"name\": \"TunnelIngressPacketDropTSMismatch\",\r\n                            \"metricNamespace\": \"microsoft.network/vpngateways\",\r\n                            \"metricName\": \"TunnelIngressPacketDropTSMismatch\",\r\n                            \"operator\": \"GreaterThan\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"DynamicThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#67": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_RecoveryVault_BackupHealthMonitor_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy RV Backup Health Monitoring Alerts\",\r\n    \"description\": \"Policy to audit/update Recovery Vault Backup Health Alerting to Azure monitor alerts\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.0\",\r\n      \"category\": \"Site Recovery\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"modify\",\r\n          \"audit\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"modify\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.RecoveryServices/Vaults\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.RecoveryServices/vaults/monitoringSettings.azureMonitorAlertSettings.alertsForAllJobFailures\",\r\n            \"notEquals\": \"Enabled\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"conflictEffect\": \"audit\",\r\n          \"operations\": [\r\n            {\r\n              \"operation\": \"addOrReplace\",\r\n              \"field\": \"Microsoft.RecoveryServices/vaults/monitoringSettings.classicAlertSettings.alertsForCriticalOperations\",\r\n              \"value\": \"Disabled\"\r\n            },\r\n            {\r\n              \"operation\": \"addOrReplace\",\r\n              \"field\": \"Microsoft.RecoveryServices/vaults/monitoringSettings.azureMonitorAlertSettings.alertsForAllJobFailures\",\r\n              \"value\": \"Enabled\"\r\n            }\r\n          ]\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#68": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_AG_ApplicationGatewayTotalTime_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy AGW ApplicationGatewayTotalTime Alert\",\r\n    \"description\": \"Policy to audit/deploy Azure Application Gateway ApplicationGatewayTotalTime Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"Category\": \"Networking\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT1M\"\r\n      },\r\n      \"alertSensitivity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert Sensitivity\",\r\n          \"description\": \"Alert Sensitivity for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Low\",\r\n          \"Medium\",\r\n          \"High\"\r\n        ],\r\n        \"defaultValue\": \"Medium\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/applicationgateways\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.Network/applicationgateways/sku.name\",\r\n            \"In\": [\r\n              \"Standard_v2\",\r\n              \"WAF_v2\"\r\n            ]\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/applicationgateways\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"ApplicationGatewayTotalTime\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/applicationgateways/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"alertSensitivity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-agApplicationGatewayTotalTime')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for App Gateway ApplicationGatewayTotalTime\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"ApplicationGatewayTotalTime\",\r\n                            \"metricNamespace\": \"Microsoft.Network/applicationgateways\",\r\n                            \"metricName\": \"ApplicationGatewayTotalTime\",\r\n                            \"operator\": \"GreaterThan\",\r\n                            \"alertSensitivity\": \"[[parameters('alertSensitivity')]\",\r\n                            \"failingPeriods\": {\r\n                              \"minFailingPeriodsToAlert\": 2,\r\n                              \"numberOfEvaluationPeriods\": 2\r\n                            },\r\n                            \"timeAggregation\": \"Total\",\r\n                            \"criterionType\": \"DynamicThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"alertSensitivity\": {\r\n                          \"value\": \"[[parameters('alertSensitivity')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"alertSensitivity\": {\r\n                  \"value\": \"[[parameters('alertSensitivity')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}",
    "$fxv#69": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_AG_BackendLastByteResponseTime_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy AGW BackendLastByteResponseTime Alert\",\r\n    \"description\": \"Policy to audit/deploy Azure Application Gateway BackendLastByteResponseTime Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"Category\": \"Networking\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT1M\"\r\n      },\r\n      \"alertSensitivity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert Sensitivity\",\r\n          \"description\": \"Alert Sensitivity for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Low\",\r\n          \"Medium\",\r\n          \"High\"\r\n        ],\r\n        \"defaultValue\": \"Medium\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/applicationgateways\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.Network/applicationgateways/sku.name\",\r\n            \"In\": [\r\n              \"Standard_v2\",\r\n              \"WAF_v2\"\r\n            ]\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/applicationgateways\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"BackendLastByteResponseTime\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/applicationgateways/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"alertSensitivity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-agBackendLastByteResponseTime')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for App Gateway BackendLastByteResponseTime\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"BackendLastByteResponseTime\",\r\n                            \"metricNamespace\": \"Microsoft.Network/applicationgateways\",\r\n                            \"metricName\": \"BackendLastByteResponseTime\",\r\n                            \"operator\": \"GreaterThan\",\r\n                            \"alertSensitivity\": \"[[parameters('alertSensitivity')]\",\r\n                            \"failingPeriods\": {\r\n                              \"minFailingPeriodsToAlert\": 2,\r\n                              \"numberOfEvaluationPeriods\": 2\r\n                            },\r\n                            \"timeAggregation\": \"Total\",\r\n                            \"criterionType\": \"DynamicThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"alertSensitivity\": {\r\n                          \"value\": \"[[parameters('alertSensitivity')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"alertSensitivity\": {\r\n                  \"value\": \"[[parameters('alertSensitivity')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}",
    "$fxv#7": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_activitylog_RouteTable_Update\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy Activity Log Route Table Update Alert\",\r\n    \"description\": \"Policy to Deploy Activity Log Route Table Update Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\",\r\n          \"_deployed_by_amba\": true\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring on resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/routeTables\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/activityLogAlerts\",\r\n          \"name\": \"ActivityUDRUpdate\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/ActivityLogAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*]\",\r\n                  \"where\": {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"category\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"Administrative\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"operationName\"\r\n                          },\r\n                          {\r\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"Microsoft.Network/routeTables/routes/write\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                },\r\n                \"equals\": 2\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"[[deployment().location]\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"ActivityUDRUpdate\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"microsoft.insights/activityLogAlerts\",\r\n                            \"apiVersion\": \"2020-10-01\",\r\n                            \"name\": \"ActivityUDRUpdate\",\r\n                            \"location\": \"global\",\r\n                            \"tags\": {\r\n                              \"_deployed_by_amba\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"description\": \"Activity Log Route table update\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().id]\"\r\n                              ],\r\n                              \"condition\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"category\",\r\n                                    \"equals\": \"Administrative\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"operationName\",\r\n                                    \"equals\": \"Microsoft.Network/routeTables/routes/write\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"status\",\r\n                                    \"containsAny\": [\r\n                                      \"succeeded\"\r\n                                    ]\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"parameters\": {\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#70": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_AG_CapacityUnits_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy AGW Capacity Units Alert\",\r\n    \"description\": \"Policy to audit/deploy Azure Application Gateway CapacityUnits Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"Category\": \"Networking\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT1M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"75\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/applicationgateways\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.Network/applicationgateways/sku.name\",\r\n            \"In\": [\r\n              \"Standard_v2\",\r\n              \"WAF_v2\"\r\n            ]\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/applicationgateways\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"CapacityUnits\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/applicationgateways/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-agCapacityUnits')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for App Gateway Capacity Units\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"CapacityUnits\",\r\n                            \"metricNamespace\": \"Microsoft.Network/applicationgateways\",\r\n                            \"metricName\": \"CapacityUnits\",\r\n                            \"operator\": \"GreaterThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}",
    "$fxv#71": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_AG_ComputeUnits_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy AGW Compute Units Alert\",\r\n    \"description\": \"Policy to audit/deploy Azure Application Gateway ComputeUnits Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"Category\": \"Networking\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT1M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"75\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/applicationgateways\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.Network/applicationgateways/sku.name\",\r\n            \"In\": [\r\n              \"Standard_v2\",\r\n              \"WAF_v2\"\r\n            ]\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/applicationgateways\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"ComputeUnits\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/Microsoft.Network/applicationgateways/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-agComputeUnits')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for App Gateway Compute Units\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"ComputeUnits\",\r\n                            \"metricNamespace\": \"Microsoft.Network/applicationgateways\",\r\n                            \"metricName\": \"ComputeUnits\",\r\n                            \"operator\": \"GreaterThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}",
    "$fxv#72": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_AG_CPUUtilization_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy AGW CPU Utilization Alert\",\r\n    \"description\": \"Policy to audit/deploy Azure Application Gateway CPU Utilization Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"Category\": \"Networking\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT1M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"80\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/applicationgateways\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.Network/applicationgateways/sku.name\",\r\n            \"notIn\": [\r\n              \"Standard_v2\",\r\n              \"WAF_v2\"\r\n            ]\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/applicationgateways\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"CpuUtilization\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/applicationgateways/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-agCpuUtilization')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for App Gateway CPU Utilization\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"CpuUtilization\",\r\n                            \"metricNamespace\": \"Microsoft.Network/applicationgateways\",\r\n                            \"metricName\": \"CpuUtilization\",\r\n                            \"operator\": \"GreaterThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}",
    "$fxv#73": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_AG_FailedRequests_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy AGW FailedRequests Alert\",\r\n    \"description\": \"Policy to audit/deploy Azure Application Gateway FailedRequests Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"Category\": \"Networking\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT1M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/applicationgateways\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/applicationgateways\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"FailedRequests\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/applicationgateways/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-agFailedRequests')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for App Gateway FailedRequests\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"FailedRequests\",\r\n                            \"metricNamespace\": \"Microsoft.Network/applicationgateways\",\r\n                            \"metricName\": \"FailedRequests\",\r\n                            \"operator\": \"GreaterThan\",\r\n                            \"alertSensitivity\": \"Medium\",\r\n                            \"failingPeriods\": {\r\n                              \"minFailingPeriodsToAlert\": 2,\r\n                              \"numberOfEvaluationPeriods\": 2\r\n                            },\r\n                            \"timeAggregation\": \"Total\",\r\n                            \"criterionType\": \"DynamicThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}",
    "$fxv#74": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_AG_ResponseStatus_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy AGW ResponseStatus Alert\",\r\n    \"description\": \"Policy to audit/deploy Azure Application Gateway ResponseStatus Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"Category\": \"Networking\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT1M\"\r\n      },\r\n      \"alertSensitivity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert Sensitivity\",\r\n          \"description\": \"Alert Sensitivity for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Low\",\r\n          \"Medium\",\r\n          \"High\"\r\n        ],\r\n        \"defaultValue\": \"Medium\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/applicationgateways\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/applicationgateways\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"ResponseStatus\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/applicationgateways/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"alertSensitivity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-agResponseStatus')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for App Gateway ResponseStatus\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"ResponseStatus\",\r\n                            \"metricNamespace\": \"Microsoft.Network/applicationgateways\",\r\n                            \"metricName\": \"ResponseStatus\",\r\n                            \"operator\": \"GreaterThan\",\r\n                            \"alertSensitivity\": \"[[parameters('alertSensitivity')]\",\r\n                            \"failingPeriods\": {\r\n                              \"minFailingPeriodsToAlert\": 2,\r\n                              \"numberOfEvaluationPeriods\": 2\r\n                            },\r\n                            \"timeAggregation\": \"Total\",\r\n                            \"dimensions\": [\r\n                              {\r\n                                \"name\": \"HttpStatusGroup\",\r\n                                \"operator\": \"Include\",\r\n                                \"values\": [\r\n                                  \"4xx\",\r\n                                  \"5xx\"\r\n                                ]\r\n                              }\r\n                            ],\r\n                            \"criterionType\": \"DynamicThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"alertSensitivity\": {\r\n                          \"value\": \"[[parameters('alertSensitivity')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"alertSensitivity\": {\r\n                  \"value\": \"[[parameters('alertSensitivity')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}",
    "$fxv#75": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_AG_UnhealthyHostCount_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy AGW Unhealthy Host Count Alert\",\r\n    \"description\": \"Policy to audit/deploy Azure Application Gateway Unhealthy Host Count Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"Category\": \"Networking\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT1M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"20\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/applicationgateways\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/applicationgateways\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"UnhealthyHostCount\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/loadBalancers/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-agUnhealthyHostCount')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for App Gateway Unhealthy Host Count\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"CpuUtilization\",\r\n                            \"metricNamespace\": \"Microsoft.Network/applicationgateways\",\r\n                            \"metricName\": \"UnhealthyHostCount\",\r\n                            \"operator\": \"GreaterThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}",
    "$fxv#76": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_ERP_ExpressRouteBitsIn_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy ER Direct ExpressRoute Bits In Alert\",\r\n    \"description\": \"Policy to audit/deploy ER Direct Connection BitsInPerSecond Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"Category\": \"Networking\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"0\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"disabled\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/expressRoutePorts\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/expressRoutePorts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"PortBitsInPerSecond\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/expressRoutePorts/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-DirectERBitsInAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for ER Direct Connection BitsInPerSecond\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"PortBitsInPerSecond\",\r\n                            \"metricNamespace\": \"Microsoft.Network/expressRoutePorts\",\r\n                            \"metricName\": \"PortBitsInPerSecond\",\r\n                            \"operator\": \"LessThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}",
    "$fxv#77": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_ERP_ExpressRouteBitsOut_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy ER Direct ExpressRoute Bits Out Alert\",\r\n    \"description\": \"Policy to audit/deploy ER Direct Connection BitsOutPerSecond Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"Category\": \"Networking\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"0\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"disabled\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/expressRoutePorts\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/expressRoutePorts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"PortBitsOutPerSecond\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/expressRoutePorts/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-DirectERBitsOutAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for ER Direct Connection BitsOutPerSecond\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"PortBitsOutPerSecond\",\r\n                            \"metricNamespace\": \"Microsoft.Network/expressRoutePorts\",\r\n                            \"metricName\": \"PortBitsOutPerSecond\",\r\n                            \"operator\": \"LessThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}",
    "$fxv#78": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_ERP_ExpressRoutLineProtocol_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy ER Direct ExpressRoute LineProtocol Alert\",\r\n    \"description\": \"Policy to audit/deploy ER Direct LineProtocol Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"Category\": \"Networking\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"0\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"0.9\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"disabled\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/expressRoutePorts\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/expressRoutePorts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"LineProtocol\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/expressRoutePorts/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-DirectERLineProtocolAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for ER Direct Connection LineProtocolPerSecond\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"LineProtocol\",\r\n                            \"metricNamespace\": \"Microsoft.Network/expressRoutePorts\",\r\n                            \"metricName\": \"LineProtocol\",\r\n                            \"operator\": \"LessThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}",
    "$fxv#79": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_ERP_ExpressRoutRxLightLevell_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy ER Direct ExpressRoute RxLightLevel High Alert\",\r\n    \"description\": \"Policy to audit/deploy ER Direct RxLightLevel High Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"Category\": \"Networking\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"0\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"disabled\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/expressRoutePorts\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/expressRoutePorts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"RxLightLevel\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\r\n                \"equals\": \"GreaterThan\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/expressRoutePorts/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-DirectERRxLightLevelHighAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for ER Direct Connection RxLightLevelHigh\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"RxLightLevel\",\r\n                            \"metricNamespace\": \"Microsoft.Network/expressRoutePorts\",\r\n                            \"metricName\": \"RxLightLevel\",\r\n                            \"operator\": \"GreaterThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}",
    "$fxv#8": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_activitylog_ServiceHealth_HealthAdvisory\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy Service Health Advisory Alert\",\r\n    \"description\": \"Policy to Deploy Service Health Advisory Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.1.0\",\r\n      \"category\": \"Monitoring\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\",\r\n          \"_deployed_by_amba\": true\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"ALZMonitorActionGroupEmail\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Action Group Email\",\r\n          \"description\": \"Email address to send alerts to\"\r\n        },\r\n        \"defaultValue\": \"action@mail.com\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring  Subscription level alerts. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/activityLogAlerts\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/ActivityLogAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*]\",\r\n                  \"where\": {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"category\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"ServiceHealth\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"properties.incidentType\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"ActionRequired\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                },\r\n                \"equals\": 2\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"[[deployment().location]\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"ALZMonitorActionGroupEmail\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"ALZ-SvcHealth-Health\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"ALZMonitorActionGroupEmail\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"microsoft.insights/activityLogAlerts\",\r\n                            \"apiVersion\": \"2020-10-01\",\r\n                            \"location\": \"global\",\r\n                            \"dependsOn\": [\r\n                              \"[[concat(subscription().Id, '/resourceGroups/', parameters('alertResourceGroupName'), '/providers/Microsoft.Insights/actionGroups/AlzActionGrp')]\"\r\n                            ],\r\n                            \"tags\": {\r\n                              \"_deployed_by_amba\": true\r\n                            },\r\n                            \"name\": \"ServiceHealthAdvisoryEvent\",\r\n                            \"properties\": {\r\n                              \"actions\": {\r\n                                \"actionGroups\": [\r\n                                  {\r\n                                    \"actionGroupId\": \"[[concat(subscription().Id, '/resourceGroups/', parameters('alertResourceGroupName'), '/providers/Microsoft.Insights/actionGroups/AlzActionGrp')]\"\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"description\": \"Service Health Advisory Alert\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().id]\"\r\n                              ],\r\n                              \"condition\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"category\",\r\n                                    \"equals\": \"ServiceHealth\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"properties.incidentType\",\r\n                                    \"equals\": \"ActionRequired\"\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"parameters\": {\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          },\r\n                          {\r\n                            \"type\": \"Microsoft.Insights/actionGroups\",\r\n                            \"apiVersion\": \"2022-04-01\",\r\n                            \"name\": \"AlzActionGrp\",\r\n                            \"location\": \"global\",\r\n                            \"tags\": {\r\n                              \"_deployed_by_amba\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"groupShortName\": \"AlzActionGrp\",\r\n                              \"enabled\": true,\r\n                              \"emailReceivers\": [\r\n                                {\r\n                                  \"name\": \"AlzMail\",\r\n                                  \"emailAddress\": \"[[parameters('ALZMonitorActionGroupEmail')]\",\r\n                                  \"useCommonAlertSchema\": true\r\n                                }\r\n                              ]\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        },\r\n                        \"ALZMonitorActionGroupEmail\": {\r\n                          \"value\": \"[[parameters('ALZMonitorActionGroupEmail')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"ALZMonitorActionGroupEmail\": {\r\n                  \"value\": \"[[parameters('ALZMonitorActionGroupEmail')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#80": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_ERP_ExpressRoutRxLightLevellow_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy ER Direct ExpressRoute RxLightLevel Low Alert\",\r\n    \"description\": \"Policy to audit/deploy ER Direct RxLightLevel Low Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"Category\": \"Networking\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"-10\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"disabled\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/expressRoutePorts\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/expressRoutePorts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"RxLightLevel\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\r\n                \"equals\": \"LessThan\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/expressRoutePorts/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-DirectERRxLightLevelLowAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for ER Direct Connection RxLightLevelLow\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"RxLightLevel\",\r\n                            \"metricNamespace\": \"Microsoft.Network/expressRoutePorts\",\r\n                            \"metricName\": \"RxLightLevel\",\r\n                            \"operator\": \"LessThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}",
    "$fxv#81": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_ERP_ExpressRoutTxLightLevell_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy ER Direct ExpressRoute TxLightLevel High Alert\",\r\n    \"description\": \"Policy to audit/deploy ER Direct TxLightLevel High Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"Category\": \"Networking\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"0\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"disabled\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/expressRoutePorts\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/expressRoutePorts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"TxLightLevel\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\r\n                \"equals\": \"GreaterThan\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/expressRoutePorts/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-DirectERTxLightLevelHighAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for ER Direct Connection TxLightLevelHigh\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"TxLightLevel\",\r\n                            \"metricNamespace\": \"Microsoft.Network/expressRoutePorts\",\r\n                            \"metricName\": \"TxLightLevel\",\r\n                            \"operator\": \"GreaterThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}",
    "$fxv#82": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_ERP_ExpressRoutTxLightLevellow_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy ER Direct ExpressRoute TxLightLevel Low Alert\",\r\n    \"description\": \"Policy to audit/deploy ER Direct TxLightLevel Low Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"Category\": \"Networking\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"-10\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"disabled\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/expressRoutePorts\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/expressRoutePorts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"TxLightLevel\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\r\n                \"equals\": \"LessThan\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/expressRoutePorts/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-DirectERTxLightLevelLowAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for ER Direct Connection TxLightLevelLow\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"TxLightLevel\",\r\n                            \"metricNamespace\": \"Microsoft.Network/expressRoutePorts\",\r\n                            \"metricName\": \"TxLightLevel\",\r\n                            \"operator\": \"LessThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}",
    "$fxv#83": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_ALB_DataPathAvailability_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy ALB Data Path Availability Alert\",\r\n    \"description\": \"Policy to audit/deploy Azure Load Balancer Data Path Availability Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"Category\": \"Networking\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"0\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT1M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"90\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/loadBalancers\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.Network/loadBalancers/sku.name\",\r\n            \"in\": [\r\n              \"Standard\",\r\n              \"Gateway\"\r\n            ]\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/loadBalancers\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"VipAvailability\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/loadBalancers/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-ALBDataPathAvailability')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for ALB Data Path Availability\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"VipAvailability\",\r\n                            \"metricNamespace\": \"Microsoft.Network/loadBalancers\",\r\n                            \"metricName\": \"VipAvailability\",\r\n                            \"operator\": \"LessThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#84": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_ALB_GlobalBackendAvailability_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy ALB Global Backend Availability Alert\",\r\n    \"description\": \"Policy to audit/deploy Azure Load Balancer Global Backend Availability Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"Category\": \"Networking\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"0\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT1M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"90\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/loadBalancers\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.Network/loadBalancers/sku.tier\",\r\n            \"equals\": \"Global\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/loadBalancers\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"GlobalBackendAvailability\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/loadBalancers/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-ALBGlobalBackendAvailability')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for Global Backend Availability\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"GlobalBackendAvailability\",\r\n                            \"metricNamespace\": \"Microsoft.Network/loadBalancers\",\r\n                            \"metricName\": \"GlobalBackendAvailability\",\r\n                            \"operator\": \"LessThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#85": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_ALB_HealthProbeStatus_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy ALB Health Probe Status Alert\",\r\n    \"description\": \"Policy to audit/deploy Azure Load Balancer Health Probe Status Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"Category\": \"Networking\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT1M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"90\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/loadBalancers\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.Network/loadBalancers/sku.name\",\r\n            \"in\": [\r\n              \"Standard\",\r\n              \"Gateway\"\r\n            ]\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.Network/loadBalancers/sku.tier\",\r\n            \"equals\": \"Regional\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/loadBalancers\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"DipAvailability\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/loadBalancers/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-ALBHealthProbeStatus')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for ALB Health Probe Status\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"DipAvailability\",\r\n                            \"metricNamespace\": \"Microsoft.Network/loadBalancers\",\r\n                            \"metricName\": \"DipAvailability\",\r\n                            \"operator\": \"LessThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#86": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_ALB_UsedSNATPorts_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy ALB Used SNAT Ports Alert\",\r\n    \"description\": \"Policy to audit/deploy Azure Load Balancer Used SNAT Ports Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"Category\": \"Networking\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT1M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"900\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/loadBalancers\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Network/loadBalancers\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"UsedSNATPorts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/loadBalancers/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-ALBUsedSNATPorts')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for ALB Used SNAT Ports\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"UsedSNATPorts\",\r\n                            \"metricNamespace\": \"Microsoft.Network/loadBalancers\",\r\n                            \"metricName\": \"UsedSNATPorts\",\r\n                            \"operator\": \"GreaterThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#87": "{\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Alerting-Connectivity\",\r\n  \"properties\": {\r\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts for Connectivity\",\r\n    \"description\": \"Initiative to deploy AMBA alerts relevant to the ALZ Connectivity management group\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.2\",\r\n      \"category\": \"Monitoring\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": true\r\n    },\r\n    \"parameters\": {\r\n      \"ALZMonitorResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"ALZ-Monitoring-RG\",\r\n        \"metadata\": {\r\n          \"displayName\": \"ALZ Monitor Resource Group Name\",\r\n          \"description\": \"Name of the resource group where the ALZ Monitor resources will be deployed\"\r\n        }\r\n      },\r\n      \"ALZMonitorResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"defaultValue\": {\r\n          \"_deployed_by_alz_monitor\": true\r\n        },\r\n        \"metadata\": {\r\n          \"displayName\": \"ALZ Monitor Resource Group Tags\",\r\n          \"description\": \"Tags to be applied to the resource group where the ALZ Monitor resources will be deployed\"\r\n        }\r\n      },\r\n      \"ALZMonitorResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"centralus\",\r\n        \"metadata\": {\r\n          \"displayName\": \"ALZ Monitor Resource Group Location\",\r\n          \"description\": \"Location of the resource group where the ALZ Monitor resources will be deployed\"\r\n        }\r\n      },\r\n      \"ERCIRQoSDropBitsinPerSecAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"2\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"ERC IRQoS Drop Bits in Per Sec Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"ERCIRQoSDropBitsinPerSecWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"ERC IRQoS Drop Bits in Per Sec Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"ERCIRQoSDropBitsinPerSecEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"ERC IRQoS Drop Bits in Per Sec Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"ERCIRQoSDropBitsinPerSecPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"ERC IRQoS Drop Bits in Per Sec Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"ERCIRQoSDropBitsinPerSecAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"ERC IRQoS Drop Bits in Per Sec Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"ERCIRQoSDropBitsoutPerSecAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"2\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"ERC IRQoS Drop Bits out Per Sec Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"ERCIRQoSDropBitsoutPerSecWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"ERC IRQoS Drop Bits out Per Sec Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"ERCIRQoSDropBitsoutPerSecEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"ERC IRQoS Drop Bits out Per Sec Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"ERCIRQoSDropBitsoutPerSecPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"ERC IRQoS Drop Bits out Per Sec Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"ERCIRQoSDropBitsoutPerSecAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"ERC IRQoS Drop Bits out Per Sec Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"VPNGwBGPPeerStatusAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"3\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN Gw BGP Peer Status Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"VPNGwBGPPeerStatusWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN Gw BGP Peer Status Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"VPNGwBGPPeerStatusEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN Gw BGP Peer Status Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"VPNGwBGPPeerStatusPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN Gw BGP Peer Status Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"VPNGwBGPPeerStatusAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN Gw BGP Peer Status Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"VPNGwBGPPeerStatusThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN Gw BGP Peer Status Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"VnetGwERCpuUtilAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"3\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw ER Cpu Util Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"VnetGwERCpuUtilWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw ER Cpu Util Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"VnetGwERCpuUtilEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw ER Cpu Util Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"VnetGwERCpuUtilPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw ER Cpu Util Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"VnetGwERCpuUtilAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw ER Cpu Util Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"VnetGwERCpuUtilThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"80\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw ER Cpu Util Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelBWAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"0\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel BW Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelBWWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel BW Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelBWEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel BW Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelBWPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel BW Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelBWAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel BW Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelBWThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel BW Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelEgressAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"0\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel Egress Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelEgressWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel Egress Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelEgressEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel Egress Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelEgressPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel Egress Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelEgressAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel Egress Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelEgressThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel Egress Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelIngressAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"0\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel Ingress Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelIngressWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel Ingress Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelIngressEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel Ingress Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelIngressPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel Ingress Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelIngressAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel Ingress Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelIngressThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel Ingress Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"VPNGWBandWidthUtilAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"0\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Band Width Util Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"VPNGWBandWidthUtilWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Band Width Util Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"VPNGWBandWidthUtilEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Band Width Util Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"VPNGWBandWidthUtilPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Band Width Util Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"VPNGWBandWidthUtilAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Band Width Util Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"VPNGWBandWidthUtilThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Band Width Util Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"VPNGWEgressAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"0\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Egress Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"VPNGWEgressWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Egress Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"VPNGWEgressEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Egress Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"VPNGWEgressPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Egress Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"VPNGWEgressAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Egress Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"VPNGWEgressThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Egress Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"VPNGWTunnelEgressPacketDropCountAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"3\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Tunnel Egress Packet Drop Count Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"VPNGWTunnelEgressPacketDropCountWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Tunnel Egress Packet Drop Count Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"VPNGWTunnelEgressPacketDropCountFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Tunnel Egress Packet Drop Count Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"VPNGWTunnelEgressPacketDropCountPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Tunnel Egress Packet Drop Count Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"VPNGWTunnelEgressPacketDropCountAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VPNGWTunnelEgressPacketDropMismatchAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"3\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Tunnel Egress Packet Drop Mismatch Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"VPNGWTunnelEgressPacketDropMismatchWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Tunnel Egress Packet Drop Mismatch Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"VPNGWTunnelEgressPacketDropMismatchFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Tunnel Egress Packet Drop Mismatch Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"VPNGWTunnelEgressPacketDropMismatchPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Tunnel Egress Packet Drop Mismatch Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"VPNGWTunnelEgressPacketDropMismatchAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Tunnel Egress Packet Drop Mismatch Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"VPNGWIngressAlertSeverity\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"0\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Ingress Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"VPNGWIngressWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Ingress Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"VPNGWIngressEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Ingress Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"VPNGWIngressPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Ingress Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"VPNGWIngressAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Ingress Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"VPNGWIngressThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Ingress Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"VPNGWIngressAutoMitigate\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Ingress Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        }\r\n      },\r\n      \"VPNGWTunnelIngressPacketDropCountAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"3\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Tunnel Ingress Packet Drop Count Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"VPNGWTunnelIngressPacketDropCountWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Tunnel Ingress Packet Drop Count Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"VPNGWTunnelIngressPacketDropCountFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Tunnel Ingress Packet Drop Count Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"VPNGWTunnelIngressPacketDropCountPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Tunnel Ingress Packet Drop Count Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"VPNGWTunnelIngressPacketDropCountAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Tunnel Ingress Packet Drop Count Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"VPNGWTunnelIngressPacketDropMismatchAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"3\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Tunnel Ingress Packet Drop Mismatch Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"VPNGWTunnelIngressPacketDropMismatchWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Tunnel Ingress Packet Drop Mismatch Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"VPNGWTunnelIngressPacketDropMismatchFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Tunnel Ingress Packet Drop Mismatch Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"VPNGWTunnelIngressPacketDropMismatchPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Tunnel Ingress Packet Drop Mismatch Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"VPNGWTunnelIngressPacketDropMismatchAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VPN GW Tunnel Ingress Packet Drop Mismatch Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"PDNSZCapacityUtilAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"2\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PDNSZ Capacity Util Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"PDNSZCapacityUtilWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1H\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PDNSZ Capacity Util Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"PDNSZCapacityUtilEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1H\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PDNSZ Capacity Util Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"PDNSZCapacityUtilPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PDNSZ Capacity Util Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"PDNSZCapacityUtilAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"PDNSZ Capacity Util Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"PDNSZCapacityUtilThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"80\",\r\n        \"metadata\": {\r\n          \"displayName\": \"PDNSZ Capacity Util Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"PDNSZQueryVolumeAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"4\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PDNSZ Query Volume Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"PDNSZQueryVolumeWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1H\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PDNSZ Query Volume Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"PDNSZQueryVolumeEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1H\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PDNSZ Query Volume Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"PDNSZQueryVolumePolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PDNSZ Query Volume Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"PDNSZQueryVolumeAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"PDNSZ Query Volume Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"PDNSZQueryVolumeThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"500\",\r\n        \"metadata\": {\r\n          \"displayName\": \"PDNSZ Query Volume Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"PDNSZRecordSetCapacityAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"2\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PDNSZ Record Set Capacity Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"PDNSZRecordSetCapacityWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1H\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PDNSZ Record Set Capacity Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"PDNSZRecordSetCapacityEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1H\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PDNSZ Record Set Capacity Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"PDNSZRecordSetCapacityPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PDNSZ Record Set Capacity Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"PDNSZRecordSetCapacityAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"PDNSZ Record Set Capacity Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"PDNSZRecordSetCapacityThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"80\",\r\n        \"metadata\": {\r\n          \"displayName\": \"PDNSZ Record Set Capacity Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"PDNSZRegistrationCapacityUtilAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"2\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PDNSZ Registration Capacity Util Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"PDNSZRegistrationCapacityUtilWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1H\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PDNSZ Registration Capacity Util Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"PDNSZRegistrationCapacityUtilEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1H\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PDNSZ Registration Capacity Util Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"PDNSZRegistrationCapacityUtilPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PDNSZ Registration Capacity Util Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"PDNSZRegistrationCapacityUtilAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"PDNSZ Registration Capacity Util Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"PDNSZRegistrationCapacityUtilThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"80\",\r\n        \"metadata\": {\r\n          \"displayName\": \"PDNSZ Registration Capacity Util Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"PIPDDoSAttackAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"1\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP DDoS Attack Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"PIPDDoSAttackWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP DDoS Attack Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"PIPDDoSAttackEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP DDoS Attack Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"PIPDDoSAttackPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP DDoS Attack Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"PIPDDoSAttackAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP DDoS Attack Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"PIPDDoSAttackThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"0\",\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP DDoS Attack Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"PIPPacketsInDDoSAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"4\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP Packets In DDoS Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"PIPPacketsInDDoSWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP Packets In DDoS Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"PIPPacketsInDDoSEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP Packets In DDoS Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"PIPPacketsInDDoSPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP Packets In DDoS Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"PIPPacketsInDDoSAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP Packets In DDoS Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"PIPPacketsInDDoSThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"40000\",\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP Packets In DDoS Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"PIPVIPAvailabilityAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"1\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP VIP Availability Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"PIPVIPAvailabilityWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP VIP Availability Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"PIPVIPAvailabilityEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP VIP Availability Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"PIPVIPAvailabilityPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP VIP Availability Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"PIPVIPAvailabilityAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP VIP Availability Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"PIPVIPAvailabilityThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\",\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP VIP Availability Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"PIPBytesInDDoSAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"4\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP Bytes In DDoS Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"PIPBytesInDDoSWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP Bytes In DDoS Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"PIPBytesInDDoSEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP Bytes In DDoS Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"PIPBytesInDDoSPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP Bytes In DDoS Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"PIPBytesInDDoSAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP Bytes In DDoS Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"PIPBytesInDDoSThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"8000000\",\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP Bytes In DDoS Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"ERGwExpressRouteBitsInAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"0\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"ER Gw Express Route Bits In Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"ERGwExpressRouteBitsInWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"ER Gw Express Route Bits In Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"ERGwExpressRouteBitsInEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"ER Gw Express Route Bits In Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"ERGwExpressRouteBitsInPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"ER Gw Express Route Bits In Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"ERGwExpressRouteBitsInAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"ER Gw Express Route Bits In Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"ERGwExpressRouteBitsInThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\",\r\n        \"metadata\": {\r\n          \"displayName\": \"ER Gw Express Route Bits In Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"ERGwExpressRouteBitsOutAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"0\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"ER Gw Express Route Bits Out Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"ERGwExpressRouteBitsOutWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"ER Gw Express Route Bits Out Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"ERGwExpressRouteBitsOutEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"ER Gw Express Route Bits Out Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"ERGwExpressRouteBitsOutPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"ER Gw Express Route Bits Out Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"ERGwExpressRouteBitsOutAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"ER Gw Express Route Bits Out Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"ERGwExpressRouteBitsOutThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\",\r\n        \"metadata\": {\r\n          \"displayName\": \"ER Gw Express Route Bits Out Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"ERGwExpressRouteCpuUtilAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"1\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"ER Gw Express Route Cpu Util Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"ERGwExpressRouteCpuUtilWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"ER Gw Express Route Cpu Util Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"ERGwExpressRouteCpuUtilEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"ER Gw Express Route Cpu Util Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"ERGwExpressRouteCpuUtilPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"ER Gw Express Route Cpu Util Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"ERGwExpressRouteCpuUtilAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"ER Gw Express Route Cpu Util Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"ERGwExpressRouteCpuUtilThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"80\",\r\n        \"metadata\": {\r\n          \"displayName\": \"ER Gw Express Route Cpu Util Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"VNETDDOSAttackAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"1\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VNET DDoS Attack Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"VNETDDOSAttackWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VNET DDoS Attack Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"VNETDDOSAttackEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VNET DDoS Attack Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"VNETDDOSAttackPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VNET DDoS Attack Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"VNETDDOSAttackAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VNET DDoS Attack Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"VNETDDOSAttackThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VNET DDoS Attack Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelEgressPacketDropCountAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"1\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel Egress Packet Drop Count Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelEgressPacketDropCountWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel Egress Packet Drop Count Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelEgressPacketDropCountEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel Egress Packet Drop Count Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelEgressPacketDropCountPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel Egress Packet Drop Count Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelEgressPacketDropCountAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel Egress Packet Drop Count Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelEgressPacketDropMismatchAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"3\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel Egress Packet Drop Mismatch Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelEgressPacketDropMismatchWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel Egress Packet Drop Mismatch Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelEgressPacketDropMismatchEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel Egress Packet Drop Mismatch Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelEgressPacketDropMismatchPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel Egress Packet Drop Mismatch Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelEgressPacketDropMismatchAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel Egress Packet Drop Mismatch Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"VnetGwExpressRouteBitsPerSecondAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"0\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Express Route Bits Per Second Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"VnetGwExpressRouteBitsPerSecondWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Express Route Bits Per Second Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"VnetGwExpressRouteBitsPerSecondEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Express Route Bits Per Second Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"VnetGwExpressRouteBitsPerSecondPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Express Route Bits Per Second Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"VnetGwExpressRouteBitsPerSecondAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Express Route Bits Per Second Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"VnetGwExpressRouteBitsPerSecondThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Express Route Bits Per Second Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelIngressPacketDropMismatchAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"3\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel Ingress Packet Drop Mismatch Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelIngressPacketDropMismatchWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel Ingress Packet Drop Mismatch Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelIngressPacketDropMismatchEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel Ingress Packet Drop Mismatch Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelIngressPacketDropMismatchPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel Ingress Packet Drop Mismatch Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelIngressPacketDropMismatchAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel Ingress Packet Drop Mismatch Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelIngressPacketDropCountAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"3\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel Ingress Packet Drop Count Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelIngressPacketDropCountWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel Ingress Packet Drop Count Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelIngressPacketDropCountEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel Ingress Packet Drop Count Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelIngressPacketDropCountPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel Ingress Packet Drop Count Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"VnetGwTunnelIngressPacketDropCountAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Vnet Gw Tunnel Ingress Packet Drop Count Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"ERCIRBgpAvailabilityAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"0\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"ERCIR Bgp Availability Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"ERCIRBgpAvailabilityWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"ERCIR Bgp Availability Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"ERCIRBgpAvailabilityEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"ERCIR Bgp Availability Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"ERCIRBgpAvailabilityPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"ERCIR Bgp Availability Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"ERCIRBgpAvailabilityAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"ERCIR Bgp Availability Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"ERCIRBgpAvailabilityThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"90\",\r\n        \"metadata\": {\r\n          \"displayName\": \"ERCIR Bgp Availability Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"ERCIRArpAvailabilityAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"0\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"ERCIR Arp Availability Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"ERCIRArpAvailabilityWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"ERCIR Arp Availability Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"ERCIRArpAvailabilityFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"ERCIR Arp Availability Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"ERCIRArpAvailabilityPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"ERCIR ARP Availability Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"ERCIRArpAvailabilityAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"ERCIR Arp Availability Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"ERCIRArpAvailabilityThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"90\",\r\n        \"metadata\": {\r\n          \"displayName\": \"ERCIR Arp Availability Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"AFWSNATPortUtilizationAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"1\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"AFW SNAT Port Utilization Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"AFWSNATPortUtilizationWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"AFW SNAT Port Utilization Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"AFWSNATPortUtilizationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"AFW SNAT Port Utilization Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"AFWSNATPortUtilizationPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"AFW SNAT Port Utilization Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"AFWSNATPortUtilizationAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"AFW SNAT Port Utilization Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"AFWSNATPortUtilizationThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"80\",\r\n        \"metadata\": {\r\n          \"displayName\": \"AFW SNAT Port Utilization Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"FirewallHealthAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"0\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Firewall Health Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"FirewallHealthWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Firewall Health Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"FirewallHealthEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Firewall Health Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"FirewallHealthPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Firewall Health Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"FirewallHealthAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Firewall Health Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"FirewallHealthThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"90\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Firewall Health Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"activityFWDeleteAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Activity FW Delete Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"activityNSGDeleteAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Activity NSG Delete Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"activityUDRUpdateAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Activity UDR Update Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"activityVPNGWDeleteAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Activity VPN GW Delete Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_ERCIRQoSDropBitsinPerSec\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_ERCIR_QosDropBitsInPerSecond_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('ERCIRQoSDropBitsinPerSecAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('ERCIRQoSDropBitsinPerSecWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('ERCIRQoSDropBitsinPerSecEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('ERCIRQoSDropBitsinPerSecPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('ERCIRQoSDropBitsinPerSecAlertState')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_ERCIRQoSDropBitsoutPerSec\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_ERCIR_QosDropBitsOutPerSecond_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('ERCIRQoSDropBitsoutPerSecAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('ERCIRQoSDropBitsoutPerSecWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('ERCIRQoSDropBitsoutPerSecEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('ERCIRQoSDropBitsoutPerSecPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('ERCIRQoSDropBitsoutPerSecAlertState')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VPNGwBGPPeerStatus\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VPNGw_BGPPeerStatus_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VPNGwBGPPeerStatusAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VPNGwBGPPeerStatusWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VPNGwBGPPeerStatusEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VPNGwBGPPeerStatusPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VPNGwBGPPeerStatusAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VPNGwBGPPeerStatusThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VnetGwERCpuUtil\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VnetGw_ExpressRouteCpuUtil_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VnetGwERCpuUtilAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VnetGwERCpuUtilWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VnetGwERCpuUtilEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VnetGwERCpuUtilPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VnetGwERCpuUtilAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VnetGwERCpuUtilThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VnetGwTunnelBW\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VnetGw_TunnelBandwidth_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelBWAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelBWWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelBWEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelBWPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelBWAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelBWThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VnetGwTunnelEgress\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VnetGw_TunnelEgress_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelEgressAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelEgressWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelEgressEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelEgressPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelEgressAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelEgressThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VnetGwTunnelIngress\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VnetGw_TunnelIngress_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelIngressAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelIngressWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelIngressEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelIngressPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelIngressAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelIngressThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VPNGWBandWidthUtil\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VPNGw_BandwidthUtil_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VPNGWBandWidthUtilAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VPNGWBandWidthUtilWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VPNGWBandWidthUtilEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VPNGWBandWidthUtilPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VPNGWBandWidthUtilAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VPNGWBandWidthUtilThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VPNGWEgress\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VPNGw_Egress_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VPNGWEgressAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VPNGWEgressWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VPNGWEgressEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VPNGWEgressPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VPNGWEgressAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VPNGWEgressThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VPNGWTunnelEgressPacketDropCount\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VPNGw_TunnelEgressPacketDropCount_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelEgressPacketDropCountAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelEgressPacketDropCountWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelEgressPacketDropCountFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelEgressPacketDropCountPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelEgressPacketDropCountAlertState')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VPNGWTunnelEgressPacketDropMismatch\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VPNGw_TunnelEgressPacketDropMismatch_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelEgressPacketDropMismatchAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelEgressPacketDropMismatchWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelEgressPacketDropMismatchFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelEgressPacketDropMismatchPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelEgressPacketDropMismatchAlertState')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VPNGWIngress\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VPNGw_Ingress_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VPNGWIngressAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VPNGWIngressWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VPNGWIngressEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VPNGWIngressPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VPNGWIngressAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VPNGWIngressThreshold')]\"\r\n          },\r\n          \"autoMitigate\": {\r\n            \"value\": \"[[parameters('VPNGWIngressAutoMitigate')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VPNGWTunnelIngressPacketDropCount\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VPNGw_TunnelIngressPacketDropCount_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelIngressPacketDropCountAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelIngressPacketDropCountWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelIngressPacketDropCountFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelIngressPacketDropCountPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelIngressPacketDropCountAlertState')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VPNGWTunnelIngressPacketDropMismatch\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VPNGw_TunnelIngressPacketDropMismatch_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelIngressPacketDropMismatchAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelIngressPacketDropMismatchWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelIngressPacketDropMismatchFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelIngressPacketDropMismatchPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelIngressPacketDropMismatchAlertState')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_PDNSZCapacityUtil\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_PDNSZ_CapacityUtil_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('PDNSZCapacityUtilAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('PDNSZCapacityUtilWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('PDNSZCapacityUtilEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('PDNSZCapacityUtilPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('PDNSZCapacityUtilAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('PDNSZCapacityUtilThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_PDNSZQueryVolume\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_PDNSZ_QueryVolume_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('PDNSZQueryVolumeAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('PDNSZQueryVolumeWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('PDNSZQueryVolumeEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('PDNSZQueryVolumePolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('PDNSZQueryVolumeAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('PDNSZQueryVolumeThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_PDNSZRecordSetCapacity\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_PDNSZ_RecordSetCapacity_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('PDNSZRecordSetCapacityAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('PDNSZRecordSetCapacityWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('PDNSZRecordSetCapacityEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('PDNSZRecordSetCapacityPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('PDNSZRecordSetCapacityAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('PDNSZRecordSetCapacityThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_PDNSZRegistrationCapacityUtil\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_DNSZ_RegistrationCapacityUtil_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('PDNSZRegistrationCapacityUtilAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('PDNSZRegistrationCapacityUtilWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('PDNSZRegistrationCapacityUtilEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('PDNSZRegistrationCapacityUtilPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('PDNSZRegistrationCapacityUtilAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('PDNSZRegistrationCapacityUtilThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_ERGwExpressRouteBitsIn\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_ERGw_ExpressRouteBitsIn_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('ERGwExpressRouteBitsInAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('ERGwExpressRouteBitsInWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('ERGwExpressRouteBitsInEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('ERGwExpressRouteBitsInPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('ERGwExpressRouteBitsInAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('ERGwExpressRouteBitsInThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_ERGwExpressRouteBitsOut\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_ERGw_ExpressRouteBitsOut_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('ERGwExpressRouteBitsOutAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('ERGwExpressRouteBitsOutWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('ERGwExpressRouteBitsOutEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('ERGwExpressRouteBitsOutPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('ERGwExpressRouteBitsOutAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('ERGwExpressRouteBitsOutThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_ERGwExpressRouteCpuUtil\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_ERGw_ExpressRouteCpuUtil_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('ERGwExpressRouteCpuUtilAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('ERGwExpressRouteCpuUtilWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('ERGwExpressRouteCpuUtilEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('ERGwExpressRouteCpuUtilPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('ERGwExpressRouteCpuUtilAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('ERGwExpressRouteCpuUtilThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VnetGwTunnelEgressPacketDropCount\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VnetGw_TunnelEgressPacketDropCount_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelEgressPacketDropCountAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelEgressPacketDropCountWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelEgressPacketDropCountEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelEgressPacketDropCountPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelEgressPacketDropCountAlertState')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VnetGwTunnelEgressPacketDropMismatch\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VnetGw_TunnelEgressPacketDropMismatch_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelEgressPacketDropMismatchAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelEgressPacketDropMismatchWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelEgressPacketDropMismatchEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelEgressPacketDropMismatchPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelEgressPacketDropMismatchAlertState')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VnetGwExpressRouteBitsPerSecond\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VnetGw_ExpressRouteBitsPerSecond_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VnetGwExpressRouteBitsPerSecondAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VnetGwExpressRouteBitsPerSecondWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VnetGwExpressRouteBitsPerSecondEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VnetGwExpressRouteBitsPerSecondPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VnetGwExpressRouteBitsPerSecondAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VnetGwExpressRouteBitsPerSecondThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VnetGwTunnelIngressPacketDropMismatchWindowSize\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VnetGw_TunnelIngressPacketDropMismatch_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelIngressPacketDropMismatchAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelIngressPacketDropMismatchWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelIngressPacketDropMismatchEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelIngressPacketDropMismatchPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelIngressPacketDropMismatchAlertState')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VnetGwTunnelIngressPacketDropCountWindowSize\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VnetGw_TunnelIngressPacketDropCount_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelIngressPacketDropCountAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelIngressPacketDropCountWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelIngressPacketDropCountEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelIngressPacketDropCountPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelIngressPacketDropCountAlertState')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_ERCIRBgpAvailability\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_ERCIR_BgpAvailability_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('ERCIRBgpAvailabilityAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('ERCIRBgpAvailabilityWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('ERCIRBgpAvailabilityEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('ERCIRBgpAvailabilityPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('ERCIRBgpAvailabilityAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('ERCIRBgpAvailabilityThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_ERCIRArpAvailability\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_ERCIR_ArpAvailability_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('ERCIRArpAvailabilityAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('ERCIRArpAvailabilityWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('ERCIRArpAvailabilityFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('ERCIRArpAvailabilityPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('ERCIRArpAvailabilityAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('ERCIRArpAvailabilityThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_AFWSNATPortUtilization\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_AFW_SNATPortUtilization_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('AFWSNATPortUtilizationAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('AFWSNATPortUtilizationWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('AFWSNATPortUtilizationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('AFWSNATPortUtilizationPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('AFWSNATPortUtilizationAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('AFWSNATPortUtilizationThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_PIPBytesInDDoSEvaluationFrequency\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_PublicIp_BytesInDDoSAttack_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('PIPBytesInDDoSAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('PIPBytesInDDoSWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('PIPBytesInDDoSEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('PIPBytesInDDoSPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('PIPBytesInDDoSAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('PIPBytesInDDoSThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_PIPDDoSAttack\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_PublicIp_DDoSAttack_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('PIPDDoSAttackAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('PIPDDoSAttackWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('PIPDDoSAttackEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('PIPDDoSAttackPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('PIPDDoSAttackAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('PIPDDoSAttackThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_PIPPacketsInDDoS\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_PublicIp_PacketsInDDoSAttack_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('PIPPacketsInDDoSAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('PIPPacketsInDDoSWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('PIPPacketsInDDoSEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('PIPPacketsInDDoSPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('PIPPacketsInDDoSAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('PIPPacketsInDDoSThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_PIPVIPAvailability\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_PublicIp_VIPAvailability_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('PIPVIPAvailabilityAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('PIPVIPAvailabilityWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('PIPVIPAvailabilityEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('PIPVIPAvailabilityPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('PIPVIPAvailabilityAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('PIPVIPAvailabilityThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VNETDDOSAttack\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VNET_DDoSAttack_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VNETDDOSAttackAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VNETDDOSAttackWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VNETDDOSAttackEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VNETDDOSAttackPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VNETDDOSAttackAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VNETDDOSAttackThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_FirewallHealth\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_AFW_FirewallHealth_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('FirewallHealthAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('FirewallHealthWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('FirewallHealthEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('FirewallHealthPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('FirewallHealthAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('FirewallHealthThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_activityFWDelete\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_activitylog_Firewall_Delete')]\",\r\n        \"parameters\": {\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('activityFWDeleteAlertState')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_activityNSGDelete\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_activitylog_NSG_Delete')]\",\r\n        \"parameters\": {\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('activityNSGDeleteAlertState')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_activityUDRUpdate\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_activitylog_RouteTable_Update')]\",\r\n        \"parameters\": {\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('activityUDRUpdateAlertState')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_activityVPNGWDelete\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_activitylog_VPNGateway_Delete')]\",\r\n        \"parameters\": {\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('activityVPNGWDeleteAlertState')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      }\r\n    ],\r\n    \"policyType\": \"Custom\",\r\n    \"policyDefinitionGroups\": null\r\n  }\r\n}\r\n",
    "$fxv#88": "{\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Alerting-Identity\",\r\n  \"properties\": {\r\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts for Identity\",\r\n    \"description\": \"Initiative to deploy AMBA alerts relevant to the ALZ Identity management group\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.2\",\r\n      \"category\": \"Monitoring\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": true\r\n    },\r\n    \"parameters\": {\r\n      \"ALZMonitorResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"ALZ-Monitoring-RG\",\r\n        \"metadata\": {\r\n          \"displayName\": \"ALZ Monitor Resource Group Name\",\r\n          \"description\": \"Name of the resource group where the alerting resources will be deployed\"\r\n        }\r\n      },\r\n      \"ALZMonitorResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"defaultValue\": {\r\n          \"_deployed_by_alz_monitor\": true\r\n        },\r\n        \"metadata\": {\r\n          \"displayName\": \"ALZ Monitor Resource Group Tags\",\r\n          \"description\": \"Tags for the resource group where the alerting resources will be deployed\"\r\n        }\r\n      },\r\n      \"ALZMonitorResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"centralus\",\r\n        \"metadata\": {\r\n          \"displayName\": \"ALZ Monitor Resource Group Location\",\r\n          \"description\": \"Location of the resource group where the alerting resources will be deployed\"\r\n        }\r\n      },\r\n      \"KVRequestAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"2\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"KeyVault Request Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"KVRequestWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"KeyVault Request Alert Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"KVRequestEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"KeyVault Request Alert Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"KVRequestPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"KeyVault Request Alert Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"KVRequestAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"KeyVault Request Alert State\",\r\n          \"description\": \"State of the alert, true will enable the alert, false will disable the alert\"\r\n        }\r\n      },\r\n      \"KvAvailabilityAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"1\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"KeyVault Availability Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"KvAvailabilityWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"KeyVault Availability Alert Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"KvAvailabilityEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"KeyVault Availability Alert Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"KvAvailabilityPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"KeyVault Availability Alert Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"KvAvailabilityAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"KeyVault Availability Alert State\",\r\n          \"description\": \"State of the alert, true will enable the alert, false will disable the alert\"\r\n        }\r\n      },\r\n      \"KVAvailabilityThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"20\",\r\n        \"metadata\": {\r\n          \"displayName\": \"KeyVault Availability Alert Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"KvLatencyAvailabilityAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"3\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"KeyVault Latency Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"KvLatencyAvailabilityWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"KeyVault Latency Alert Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"KvLatencyAvailabilityEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"KeyVault Latency Alert Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"KvLatencyAvailabilityPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"KeyVault Latency Alert Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"KvLatencyAvailabilityAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"KeyVault Latency Alert State\",\r\n          \"description\": \"State of the alert, true will enable the alert, false will disable the alert\"\r\n        }\r\n      },\r\n      \"KvLatencyAvailabilityThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1000\",\r\n        \"metadata\": {\r\n          \"displayName\": \"KeyVault Latency Alert Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"KVCapacityAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"1\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"KeyVault Capacity Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"KVCapacityWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"KeyVault Capacity Alert Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"KVCapacityEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"KeyVault Capacity Alert Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"KVCapacityPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"KeyVault Capacity Alert Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist, disabled will not deploy the alert\"\r\n        }\r\n      },\r\n      \"KVCapacityAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"KeyVault Capacity Alert State\",\r\n          \"description\": \"State of the alert, true will enable the alert, false will disable the alert\"\r\n        }\r\n      },\r\n      \"KVCapacityThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"75\",\r\n        \"metadata\": {\r\n          \"displayName\": \"KeyVault Capacity Alert Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"activityKVDeleteAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Activity Log KeyVault Delete Alert State\",\r\n          \"description\": \"State of the alert, true will enable the alert, false will disable the alert\"\r\n        }\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_KVRequest\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_KeyVault_Requests_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('KVRequestAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('KVRequestWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('KVRequestEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('KVRequestPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('KVRequestAlertState')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_KvAvailability\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_KeyVault_Availability_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('KvAvailabilityAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('KvAvailabilityWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('KvAvailabilityEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('KvAvailabilityPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('KvAvailabilityAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('KVAvailabilityThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_KvLatencyAvailability\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_KeyVault_Latency_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('KvLatencyAvailabilityAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('KvLatencyAvailabilityWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('KvLatencyAvailabilityEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('KvLatencyAvailabilityPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('KvLatencyAvailabilityAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('KvLatencyAvailabilityThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_KVCapacity\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_KeyVault_Capacity_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('KVCapacityAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('KVCapacityWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('KVCapacityEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('KVCapacityPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('KVCapacityAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('KVCapacityThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_activityKVDelete\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_activitylog_KeyVault_Delete')]\",\r\n        \"parameters\": {\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('activityKVDeleteAlertState')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      }\r\n    ],\r\n    \"policyType\": \"Custom\",\r\n    \"policyDefinitionGroups\": null\r\n  }\r\n}\r\n",
    "$fxv#89": "{\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Alerting-LandingZone\",\r\n  \"properties\": {\r\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts for Landing Zone\",\r\n    \"description\": \"Initiative to deploy AMBA alerts relevant to the ALZ LandingZone management group\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.2\",\r\n      \"category\": \"Monitoring\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": true\r\n    },\r\n    \"parameters\": {\r\n      \"ALZMonitorResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"ALZ-Monitoring-RG\",\r\n        \"metadata\": {\r\n          \"displayName\": \"ALZ Monitor Resource Group Name\",\r\n          \"description\": \"Name of the resource group where the ALZ Monitor resources will be deployed\"\r\n        }\r\n      },\r\n      \"ALZMonitorResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"defaultValue\": {\r\n          \"_deployed_by_alz_monitor\": true\r\n        },\r\n        \"metadata\": {\r\n          \"displayName\": \"ALZ Monitor Resource Group Tags\",\r\n          \"description\": \"Tags for the resource group where the ALZ Monitor resources will be deployed\"\r\n        }\r\n      },\r\n      \"ALZMonitorResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"centralus\",\r\n        \"metadata\": {\r\n          \"displayName\": \"ALZ Monitor Resource Group Location\",\r\n          \"description\": \"Location of the resource group where the ALZ Monitor resources will be deployed\"\r\n        }\r\n      },\r\n      \"KVRequestAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"2\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Key Vault Request Alert Severity\",\r\n          \"description\": \"Severity of the alert for Key Vault Request\"\r\n        }\r\n      },\r\n      \"KVRequestWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Key Vault Request Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"KVRequestEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Key Vault Request Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"KVRequestPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Key Vault Request Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist\"\r\n        }\r\n      },\r\n      \"KVRequestAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Key Vault Request Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"KvAvailabilityAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"1\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Key Vault Availability Alert Severity\",\r\n          \"description\": \"Severity of the alert for Key Vault Availability\"\r\n        }\r\n      },\r\n      \"KvAvailabilityWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Key Vault Availability Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"KvAvailabilityEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Key Vault Availability Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"KvAvailabilityPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Key Vault Availability Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist\"\r\n        }\r\n      },\r\n      \"KvAvailabilityAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Key Vault Availability Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"KVAvailabilityThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"20\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Key Vault Availability Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"KvLatencyAvailabilityAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"3\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Key Vault Latency Availability Alert Severity\",\r\n          \"description\": \"Severity of the alert for Key Vault Latency Availability\"\r\n        }\r\n      },\r\n      \"KvLatencyAvailabilityWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Key Vault Latency Availability Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"KvLatencyAvailabilityEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Key Vault Latency Availability Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"KvLatencyAvailabilityPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Key Vault Latency Availability Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist\"\r\n        }\r\n      },\r\n      \"KvLatencyAvailabilityAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Key Vault Latency Availability Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"KvLatencyAvailabilityThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1000\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Key Vault Latency Availability Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"KVCapacityAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"1\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Key Vault Capacity Alert Severity\",\r\n          \"description\": \"Severity of the alert for Key Vault Capacity\"\r\n        }\r\n      },\r\n      \"KVCapacityWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Key Vault Capacity Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"KVCapacityEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Key Vault Capacity Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"KVCapacityPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Key Vault Capacity Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist\"\r\n        }\r\n      },\r\n      \"KVCapacityAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Key Vault Capacity Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"KVCapacityThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"75\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Key Vault Capacity Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"activityKVDeleteAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Activity Key Vault Delete Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"StorageAccountAvailabilityAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"1\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Storage Account Availability Alert Severity\",\r\n          \"description\": \"Severity of the alert for Storage Account Availability\"\r\n        }\r\n      },\r\n      \"StorageAccountAvailabilityWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Storage Account Availability Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"StorageAccountAvailabilityFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Storage Account Availability Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"StorageAccountAvailabilityPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Storage Account Availability Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist\"\r\n        }\r\n      },\r\n      \"StorageAccountAvailabilityAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Storage Account Availability Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"StorageAccountAvailabilityThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"90\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Storage Account Availability Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"PIPDDoSAttackAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"1\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP DDoS Attack Alert Severity\",\r\n          \"description\": \"Severity of the alert for PIP DDoS Attack\"\r\n        }\r\n      },\r\n      \"PIPDDoSAttackWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP DDoS Attack Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"PIPDDoSAttackEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP DDoS Attack Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"PIPDDoSAttackPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP DDoS Attack Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist\"\r\n        }\r\n      },\r\n      \"PIPDDoSAttackAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP DDoS Attack Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"PIPDDoSAttackThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"0\",\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP DDoS Attack Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"PIPPacketsInDDoSAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"4\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP Packets In DDoS Alert Severity\",\r\n          \"description\": \"Severity of the alert for PIP Packets In DDoS\"\r\n        }\r\n      },\r\n      \"PIPPacketsInDDoSWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP Packets In DDoS Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"PIPPacketsInDDoSEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP Packets In DDoS Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"PIPPacketsInDDoSPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP Packets In DDoS Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist\"\r\n        }\r\n      },\r\n      \"PIPPacketsInDDoSAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP Packets In DDoS Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"PIPPacketsInDDoSThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"40000\",\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP Packets In DDoS Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"PIPVIPAvailabilityAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"1\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP VIP Availability Alert Severity\",\r\n          \"description\": \"Severity of the alert for PIP VIP Availability\"\r\n        }\r\n      },\r\n      \"PIPVIPAvailabilityWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP VIP Availability Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"PIPVIPAvailabilityEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP VIP Availability Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"PIPVIPAvailabilityPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP VIP Availability Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist\"\r\n        }\r\n      },\r\n      \"PIPVIPAvailabilityAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP VIP Availability Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"PIPVIPAvailabilityThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\",\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP VIP Availability Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"PIPBytesInDDoSAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"4\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP Bytes In DDoS Alert Severity\",\r\n          \"description\": \"Severity of the alert for PIP Bytes In DDoS\"\r\n        }\r\n      },\r\n      \"PIPBytesInDDoSWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP Bytes In DDoS Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"PIPBytesInDDoSEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP Bytes In DDoS Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"PIPBytesInDDoSPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP Bytes In DDoS Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist\"\r\n        }\r\n      },\r\n      \"PIPBytesInDDoSAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP Bytes In DDoS Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"PIPBytesInDDoSThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"8000000\",\r\n        \"metadata\": {\r\n          \"displayName\": \"PIP Bytes In DDoS Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"RVBackupHealthMonitorPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"modify\",\r\n        \"allowedValues\": [\r\n          \"modify\",\r\n          \"audit\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Recovery Vault Backup Health Monitor Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, modify will modify the alert if it exists, or audit if it does not exist\"\r\n        }\r\n      },\r\n      \"VNETDDOSAttackAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"1\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VNET DDoS Attack Alert Severity\",\r\n          \"description\": \"Severity of the alert for VNET DDoS Attack\"\r\n        }\r\n      },\r\n      \"VNETDDOSAttackWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VNET DDoS Attack Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"VNETDDOSAttackEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VNET DDoS Attack Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"VNETDDOSAttackPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VNET DDoS Attack Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist\"\r\n        }\r\n      },\r\n      \"VNETDDOSAttackAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VNET DDoS Attack Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"VNETDDOSAttackThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VNET DDoS Attack Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"activityNSGDeleteAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Activity NSG Delete Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"activityUDRUpdateAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Activity UDR Update Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"VMHeartBeatRGAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"1\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Heart Beat RG Alert Severity\",\r\n          \"description\": \"Severity of the alert for VM Heart Beat RG\"\r\n        }\r\n      },\r\n      \"VMHeartBeatRGWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT15M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Heart Beat RG Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"VMHeartBeatRGEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Heart Beat RG Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"VMHeartBeatRGAutoMitigate\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Heart Beat RG Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        }\r\n      },\r\n      \"VMHeartBeatRGAutoResolve\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Heart Beat RG Auto Resolve\",\r\n          \"description\": \"Auto Resolve for the alert\"\r\n        }\r\n      },\r\n      \"VMHeartBeatRGAutoResolveTime\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"00:10:00\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Heart Beat RG Auto Resolve Time\",\r\n          \"description\": \"Auto Resolve Time for the alert\"\r\n        }\r\n      },\r\n      \"VMHeartBeatRGPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Heart Beat RG Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist\"\r\n        }\r\n      },\r\n      \"VMHeartBeatRGAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Heart Beat RG Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"VMHeartBeatRGThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"10\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Heart Beat RG Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"VMHeartBeatRGOperator\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"GreaterThan\",\r\n        \"allowedValues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Heart Beat RG Operator\",\r\n          \"description\": \"Operator for the alert\"\r\n        }\r\n      },\r\n      \"VMHeartBeatRGTimeAggregation\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"Average\",\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Heart Beat RG Time Aggregation\",\r\n          \"description\": \"Time Aggregation for the alert\"\r\n        }\r\n      },\r\n      \"VMNetworkInAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"2\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Network In Alert Severity\",\r\n          \"description\": \"Severity of the alert for VM Network In\"\r\n        }\r\n      },\r\n      \"VMNetworkInWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT15M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Network In Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"VMNetworkInEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Network In Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"VMNetworkInAutoMitigate\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Network In Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        }\r\n      },\r\n      \"VMNetworkInAutoResolve\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Network In Auto Resolve\",\r\n          \"description\": \"Auto Resolve for the alert\"\r\n        }\r\n      },\r\n      \"VMNetworkInAutoResolveTime\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"00:10:00\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Network In Auto Resolve Time\",\r\n          \"description\": \"Auto Resolve Time for the alert\"\r\n        }\r\n      },\r\n      \"VMNetworkInPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Network In Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist\"\r\n        }\r\n      },\r\n      \"VMNetworkInAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Network In Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"VMNetworkInThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"10000000\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Network In Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"VMNetworkInOperator\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"GreaterThan\",\r\n        \"allowedValues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Network In Operator\",\r\n          \"description\": \"Operator for the alert\"\r\n        }\r\n      },\r\n      \"VMNetworkInTimeAggregation\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"Average\",\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Network In Time Aggregation\",\r\n          \"description\": \"Time Aggregation for the alert\"\r\n        }\r\n      },\r\n      \"VMNetworkInEvaluationPeriods\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Network In Evaluation Periods\",\r\n          \"description\": \"Evaluation Periods for the alert\"\r\n        }\r\n      },\r\n      \"VMNetworkInFailingPeriods\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Network In Failing Periods\",\r\n          \"description\": \"Failing Periods for the alert\"\r\n        }\r\n      },\r\n      \"VMNetworkInComputersToInclude\": {\r\n        \"type\": \"array\",\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Network In Computers To Include\",\r\n          \"description\": \"Computers To Include for the alert\"\r\n        }\r\n      },\r\n      \"VMNetworkInNetworkInterfaceToInclude\": {\r\n        \"type\": \"array\",\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Network In Network Interface To Include\",\r\n          \"description\": \"Network Interface To Include for the alert\"\r\n        }\r\n      },\r\n      \"VMNetworkOutAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"2\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Network Out Alert Severity\",\r\n          \"description\": \"Severity of the alert for VM Network Out\"\r\n        }\r\n      },\r\n      \"VMNetworkOutWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT15M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Network Out Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"VMNetworkOutEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Network Out Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"VMNetworkOutAutoMitigate\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Network Out Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        }\r\n      },\r\n      \"VMNetworkOutAutoResolve\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Network Out Auto Resolve\",\r\n          \"description\": \"Auto Resolve for the alert\"\r\n        }\r\n      },\r\n      \"VMNetworkOutAutoResolveTime\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"00:10:00\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Network Out Auto Resolve Time\",\r\n          \"description\": \"Auto Resolve Time for the alert\"\r\n        }\r\n      },\r\n      \"VMNetworkOutPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Network Out Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist\"\r\n        }\r\n      },\r\n      \"VMNetworkOutAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Network Out Alert State\",\r\n          \"description\": \"Alert state for the alert, true will enable the alert, false will disable the alert\"\r\n        }\r\n      },\r\n      \"VMNetworkOutThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"10000000\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Network Out Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"VMNetworkOutOperator\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"GreaterThan\",\r\n        \"allowedValues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Network Out Operator\",\r\n          \"description\": \"Operator for the alert\"\r\n        }\r\n      },\r\n      \"VMNetworkOutTimeAggregation\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"Average\",\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Network Out Time Aggregation\",\r\n          \"description\": \"Time Aggregation for the alert\"\r\n        }\r\n      },\r\n      \"VMNetworkOutEvaluationPeriods\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Network Out Evaluation Periods\",\r\n          \"description\": \"Evaluation Periods for the alert\"\r\n        }\r\n      },\r\n      \"VMNetworkOutFailingPeriods\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Network Out Failing Periods\",\r\n          \"description\": \"Failing Periods for the alert\"\r\n        }\r\n      },\r\n      \"VMNetworkOutComputersToInclude\": {\r\n        \"type\": \"array\",\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Network Out Computers To Include\",\r\n          \"description\": \"Computers To Include for the alert\"\r\n        }\r\n      },\r\n      \"VMNetworkOutNetworkInterfaceToInclude\": {\r\n        \"type\": \"array\",\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Network Out Network Interface To Include\",\r\n          \"description\": \"Network Interface To Include for the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskReadLatencyAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"2\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Read Latency Alert Severity\",\r\n          \"description\": \"Severity of the alert for VM OS Disk Read Latency\"\r\n        }\r\n      },\r\n      \"VMOSDiskReadLatencyWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT15M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Read Latency Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskReadLatencyEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Read Latency Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskReadLatencyAutoMitigate\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Read Latency Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskReadLatencyAutoResolve\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Read Latency Auto Resolve\",\r\n          \"description\": \"Auto Resolve for the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskReadLatencyAutoResolveTime\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"00:10:00\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Read Latency Auto Resolve Time\",\r\n          \"description\": \"Auto Resolve Time for the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskReadLatencyPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Read Latency Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist\"\r\n        }\r\n      },\r\n      \"VMOSDiskReadLatencyAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Read Latency Alert State\",\r\n          \"description\": \"Alert state for the alert, true will enable the alert, false will disable the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskReadLatencyThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"30\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Read Latency Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskReadLatencyOperator\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"LessThan\",\r\n        \"allowedValues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Read Latency Operator\",\r\n          \"description\": \"Operator for the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskReadLatencyTimeAggregation\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"Average\",\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Read Latency Time Aggregation\",\r\n          \"description\": \"Time Aggregation for the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskReadLatencyEvaluationPeriods\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Read Latency Evaluation Periods\",\r\n          \"description\": \"Evaluation Periods for the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskReadLatencyFailingPeriods\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Read Latency Failing Periods\",\r\n          \"description\": \"Failing Periods for the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskReadLatencyComputersToInclude\": {\r\n        \"type\": \"array\",\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Read Latency Computers To Include\",\r\n          \"description\": \"Computers To Include for the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskReadLatencyDisksToInclude\": {\r\n        \"type\": \"array\",\r\n        \"defaultValue\": [\r\n          \"C:\",\r\n          \"/\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Read Latency Disks To Include\",\r\n          \"description\": \"Disks To Include for the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskWriteLatencyAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"2\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Write Latency Alert Severity\",\r\n          \"description\": \"Severity of the alert for VM OS Disk Write Latency\"\r\n        }\r\n      },\r\n      \"VMOSDiskWriteLatencyWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT15M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Write Latency Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskWriteLatencyEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Write Latency Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskWriteLatencyAutoMitigate\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Write Latency Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskWriteLatencyAutoResolve\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Write Latency Auto Resolve\",\r\n          \"description\": \"Auto Resolve for the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskWriteLatencyAutoResolveTime\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"00:10:00\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Write Latency Auto Resolve Time\",\r\n          \"description\": \"Auto Resolve Time for the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskWriteLatencyPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Write Latency Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist\"\r\n        }\r\n      },\r\n      \"VMOSDiskWriteLatencyAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Write Latency Alert State\",\r\n          \"description\": \"Alert state for the alert, true will enable the alert, false will disable the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskWriteLatencyThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"50\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Write Latency Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskWriteLatencyOperator\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"LessThan\",\r\n        \"allowedValues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Write Latency Operator\",\r\n          \"description\": \"Operator for the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskWriteLatencyTimeAggregation\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"Average\",\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Write Latency Time Aggregation\",\r\n          \"description\": \"Time Aggregation for the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskWriteLatencyEvaluationPeriods\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Write Latency Evaluation Periods\",\r\n          \"description\": \"Evaluation Periods for the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskWriteLatencyFailingPeriods\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Write Latency Failing Periods\",\r\n          \"description\": \"Failing Periods for the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskWriteLatencyComputersToInclude\": {\r\n        \"type\": \"array\",\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Write Latency Computers To Include\",\r\n          \"description\": \"Computers To Include for the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskWriteLatencyDisksToInclude\": {\r\n        \"type\": \"array\",\r\n        \"defaultValue\": [\r\n          \"C:\",\r\n          \"/\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Write Latency Disks To Include\",\r\n          \"description\": \"Disks To Include for the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskSpaceAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"2\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Space Alert Severity\",\r\n          \"description\": \"Severity of the alert for VM OS Disk Space\"\r\n        }\r\n      },\r\n      \"VMOSDiskSpaceWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT15M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Space Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskSpaceEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Space Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskSpaceAutoMitigate\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Space Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskSpaceAutoResolve\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Space Auto Resolve\",\r\n          \"description\": \"Auto Resolve for the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskSpaceAutoResolveTime\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"00:10:00\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Space Auto Resolve Time\",\r\n          \"description\": \"Auto Resolve Time for the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskSpacePolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Space Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist\"\r\n        }\r\n      },\r\n      \"VMOSDiskSpaceAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Space Alert State\",\r\n          \"description\": \"Alert state for the alert, true will enable the alert, false will disable the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskSpaceThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"10\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Space Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskSpaceOperator\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"LessThan\",\r\n        \"allowedValues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Space Operator\",\r\n          \"description\": \"Operator for the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskSpaceTimeAggregation\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"Average\",\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Space Time Aggregation\",\r\n          \"description\": \"Time Aggregation for the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskSpaceEvaluationPeriods\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Space Evaluation Periods\",\r\n          \"description\": \"Evaluation Periods for the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskSpaceFailingPeriods\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Space Failing Periods\",\r\n          \"description\": \"Failing Periods for the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskSpaceComputersToInclude\": {\r\n        \"type\": \"array\",\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Space Computers To Include\",\r\n          \"description\": \"Computers To Include for the alert\"\r\n        }\r\n      },\r\n      \"VMOSDiskSpaceDisksToInclude\": {\r\n        \"type\": \"array\",\r\n        \"defaultValue\": [\r\n          \"C:\",\r\n          \"/\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM OS Disk Space Disks To Include\",\r\n          \"description\": \"Disks To Include for the alert\"\r\n        }\r\n      },\r\n      \"VMPercentCPUAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"2\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Percent CPU Alert Severity\",\r\n          \"description\": \"Severity of the alert for VM Percent CPU\"\r\n        }\r\n      },\r\n      \"VMPercentCPUWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT15M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Percent CPU Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"VMPercentCPUEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Percent CPU Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"VMPercentCPUAutoMitigate\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Percent CPU Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        }\r\n      },\r\n      \"VMPercentCPUAutoResolve\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Percent CPU Auto Resolve\",\r\n          \"description\": \"Auto Resolve for the alert\"\r\n        }\r\n      },\r\n      \"VMPercentCPUAutoResolveTime\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"00:10:00\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Percent CPU Auto Resolve Time\",\r\n          \"description\": \"Auto Resolve Time for the alert\"\r\n        }\r\n      },\r\n      \"VMPercentCPUPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Percent CPU Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist\"\r\n        }\r\n      },\r\n      \"VMPercentCPUAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Percent CPU Alert State\",\r\n          \"description\": \"Alert state for the alert, true will enable the alert, false will disable the alert\"\r\n        }\r\n      },\r\n      \"VMPercentCPUThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"85\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Percent CPU Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"VMPercentCPUOperator\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"GreaterThan\",\r\n        \"allowedValues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Percent CPU Operator\",\r\n          \"description\": \"Operator for the alert\"\r\n        }\r\n      },\r\n      \"VMPercentCPUTimeAggregation\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"Average\",\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Percent CPU Time Aggregation\",\r\n          \"description\": \"Time Aggregation for the alert\"\r\n        }\r\n      },\r\n      \"VMPercentMemoryAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"2\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Percent Memory Alert Severity\",\r\n          \"description\": \"Severity of the alert for VM Percent Memory\"\r\n        }\r\n      },\r\n      \"VMPercentMemoryWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT15M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Percent Memory Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"VMPercentMemoryEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Percent Memory Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"VMPercentMemoryAutoMitigate\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Percent Memory Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        }\r\n      },\r\n      \"VMPercentMemoryAutoResolve\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Percent Memory Auto Resolve\",\r\n          \"description\": \"Auto Resolve for the alert\"\r\n        }\r\n      },\r\n      \"VMPercentMemoryAutoResolveTime\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"00:10:00\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Percent Memory Auto Resolve Time\",\r\n          \"description\": \"Auto Resolve Time for the alert\"\r\n        }\r\n      },\r\n      \"VMPercentMemoryPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Percent Memory Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist\"\r\n        }\r\n      },\r\n      \"VMPercentMemoryAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Percent Memory Alert State\",\r\n          \"description\": \"Alert state for the alert, true will enable the alert, false will disable the alert\"\r\n        }\r\n      },\r\n      \"VMPercentMemoryThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"10\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Percent Memory Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"VMPercentMemoryOperator\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"LessThan\",\r\n        \"allowedValues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Percent Memory Operator\",\r\n          \"description\": \"Operator for the alert\"\r\n        }\r\n      },\r\n      \"VMPercentMemoryTimeAggregation\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"Average\",\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Percent Memory Time Aggregation\",\r\n          \"description\": \"Time Aggregation for the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskSpaceAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"2\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Space Alert Severity\",\r\n          \"description\": \"Severity of the alert for VM Data Disk Space\"\r\n        }\r\n      },\r\n      \"VMDataDiskSpaceWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT15M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Space Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskSpaceEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Space Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskSpaceAutoMitigate\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Space Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskSpaceAutoResolve\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Space Auto Resolve\",\r\n          \"description\": \"Auto Resolve for the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskSpaceAutoResolveTime\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"00:10:00\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Space Auto Resolve Time\",\r\n          \"description\": \"Auto Resolve Time for the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskSpacePolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Space Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist\"\r\n        }\r\n      },\r\n      \"VMDataDiskSpaceAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Space Alert State\",\r\n          \"description\": \"Alert state for the alert, true will enable the alert, false will disable the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskSpaceThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"10\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Space Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskSpaceOperator\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"LessThan\",\r\n        \"allowedValues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Space Operator\",\r\n          \"description\": \"Operator for the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskSpaceTimeAggregation\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"Average\",\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Space Time Aggregation\",\r\n          \"description\": \"Time Aggregation for the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskSpaceEvaluationPeriods\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Space Evaluation Periods\",\r\n          \"description\": \"Evaluation Periods for the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskSpaceFailingPeriods\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Space Failing Periods\",\r\n          \"description\": \"Failing Periods for the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskSpaceDisksToInclude\": {\r\n        \"type\": \"array\",\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Space Disks To Include\",\r\n          \"description\": \"Disks To Include for the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskReadLatencyAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"2\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Read Latency Alert Severity\",\r\n          \"description\": \"Severity of the alert for VM Data Disk Read Latency\"\r\n        }\r\n      },\r\n      \"VMDataDiskReadLatencyWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT15M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Read Latency Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskReadLatencyEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Read Latency Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskReadLatencyAutoMitigate\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Read Latency Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskReadLatencyAutoResolve\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Read Latency Auto Resolve\",\r\n          \"description\": \"Auto Resolve for the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskReadLatencyAutoResolveTime\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"00:10:00\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Read Latency Auto Resolve Time\",\r\n          \"description\": \"Auto Resolve Time for the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskReadLatencyPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Read Latency Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist\"\r\n        }\r\n      },\r\n      \"VMDataDiskReadLatencyAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Read Latency Alert State\",\r\n          \"description\": \"Alert state for the alert, true will enable the alert, false will disable the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskReadLatencyThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"30\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Read Latency Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskReadLatencyOperator\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"LessThan\",\r\n        \"allowedValues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Read Latency Operator\",\r\n          \"description\": \"Operator for the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskReadLatencyTimeAggregation\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"Average\",\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Read Latency Time Aggregation\",\r\n          \"description\": \"Time Aggregation for the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskReadLatencyEvaluationPeriods\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Read Latency Evaluation Periods\",\r\n          \"description\": \"Evaluation Periods for the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskReadLatencyFailingPeriods\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Read Latency Failing Periods\",\r\n          \"description\": \"Failing Periods for the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskReadLatencyComputersToInclude\": {\r\n        \"type\": \"array\",\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Read Latency Computers To Include\",\r\n          \"description\": \"Computers To Include for the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskReadLatencyDisksToInclude\": {\r\n        \"type\": \"array\",\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Read Latency Disks To Include\",\r\n          \"description\": \"Disks To Include for the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskWriteLatencyAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"2\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Write Latency Alert Severity\",\r\n          \"description\": \"Severity of the alert for VM Data Disk Write Latency\"\r\n        }\r\n      },\r\n      \"VMDataDiskWriteLatencyWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT15M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Write Latency Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskWriteLatencyEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Write Latency Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskWriteLatencyAutoMitigate\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Write Latency Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskWriteLatencyAutoResolve\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Write Latency Auto Resolve\",\r\n          \"description\": \"Auto Resolve for the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskWriteLatencyAutoResolveTime\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"00:10:00\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Write Latency Auto Resolve Time\",\r\n          \"description\": \"Auto Resolve Time for the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskWriteLatencyPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Write Latency Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist\"\r\n        }\r\n      },\r\n      \"VMDataDiskWriteLatencyAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Write Latency Alert State\",\r\n          \"description\": \"Alert state for the alert, true will enable the alert, false will disable the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskWriteLatencyThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"30\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Write Latency Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskWriteLatencyOperator\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"LessThan\",\r\n        \"allowedValues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Write Latency Operator\",\r\n          \"description\": \"Operator for the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskWriteLatencyTimeAggregation\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"Average\",\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Write Latency Time Aggregation\",\r\n          \"description\": \"Time Aggregation for the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskWriteLatencyEvaluationPeriods\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Write Latency Evaluation Periods\",\r\n          \"description\": \"Evaluation Periods for the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskWriteLatencyFailingPeriods\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\",\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Write Latency Failing Periods\",\r\n          \"description\": \"Failing Periods for the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskWriteLatencyComputersToInclude\": {\r\n        \"type\": \"array\",\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Write Latency Computers To Include\",\r\n          \"description\": \"Computers To Include for the alert\"\r\n        }\r\n      },\r\n      \"VMDataDiskWriteLatencyDisksToInclude\": {\r\n        \"type\": \"array\",\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"VM Data Disk Write Latency Disks To Include\",\r\n          \"description\": \"Disks To Include for the alert\"\r\n        }\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_KVRequest\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_KeyVault_Requests_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('KVRequestAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('KVRequestWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('KVRequestEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('KVRequestPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('KVRequestAlertState')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_KvAvailability\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_KeyVault_Availability_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('KvAvailabilityAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('KvAvailabilityWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('KvAvailabilityEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('KvAvailabilityPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('KvAvailabilityAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('KVAvailabilityThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_KvLatencyAvailability\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_KeyVault_Latency_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('KvLatencyAvailabilityAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('KvLatencyAvailabilityWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('KvLatencyAvailabilityEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('KvLatencyAvailabilityPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('KvLatencyAvailabilityAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('KvLatencyAvailabilityThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_KVCapacity\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_KeyVault_Capacity_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('KVCapacityAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('KVCapacityWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('KVCapacityEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('KVCapacityPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('KVCapacityAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('KVCapacityThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_activityKVDelete\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_activitylog_KeyVault_Delete')]\",\r\n        \"parameters\": {\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('activityKVDeleteAlertState')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_StorageAccountAvailability\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_StorageAccount_Availability_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('StorageAccountAvailabilityAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('StorageAccountAvailabilityWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('StorageAccountAvailabilityFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('StorageAccountAvailabilityPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('StorageAccountAvailabilityAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('StorageAccountAvailabilityThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_PIPBytesInDDoS\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_PublicIp_BytesInDDoSAttack_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('PIPBytesInDDoSAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('PIPBytesInDDoSWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('PIPBytesInDDoSEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('PIPBytesInDDoSPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('PIPBytesInDDoSAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('PIPBytesInDDoSThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_PIPDDoSAttack\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_PublicIp_DDoSAttack_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('PIPDDoSAttackAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('PIPDDoSAttackWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('PIPDDoSAttackEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('PIPDDoSAttackPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('PIPDDoSAttackAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('PIPDDoSAttackThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_PIPPacketsInDDoS\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_PublicIp_PacketsInDDoSAttack_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('PIPPacketsInDDoSAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('PIPPacketsInDDoSWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('PIPPacketsInDDoSEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('PIPPacketsInDDoSPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('PIPPacketsInDDoSAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('PIPPacketsInDDoSThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_PIPVIPAvailability\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_PublicIp_VIPAvailability_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('PIPVIPAvailabilityAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('PIPVIPAvailabilityWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('PIPVIPAvailabilityEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('PIPVIPAvailabilityPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('PIPVIPAvailabilityAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('PIPVIPAvailabilityThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_activityNSGDelete\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_activitylog_NSG_Delete')]\",\r\n        \"parameters\": {\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('activityNSGDeleteAlertState')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_activityUDRUpdate\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_activitylog_RouteTable_Update')]\",\r\n        \"parameters\": {\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('activityUDRUpdateAlertState')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_RVBackupHealthMonitor\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_RecoveryVault_BackupHealthMonitor_Alert')]\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('RVBackupHealthMonitorPolicyEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VNETDDOSAttack\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VNET_DDoSAttack_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VNETDDOSAttackAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VNETDDOSAttackWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VNETDDOSAttackEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VNETDDOSAttackPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VNETDDOSAttackAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VNETDDOSAttackThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VMHeartBeatRG\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VM_HeartBeat_Alert')]\",\r\n        \"parameters\": {\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          },\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VMHeartBeatRGAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VMHeartBeatRGWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VMHeartBeatRGEvaluationFrequency')]\"\r\n          },\r\n          \"autoMitigate\": {\r\n            \"value\": \"[[parameters('VMHeartBeatRGAutoMitigate')]\"\r\n          },\r\n          \"autoResolve\": {\r\n            \"value\": \"[[parameters('VMHeartBeatRGAutoResolve')]\"\r\n          },\r\n          \"autoResolveTime\": {\r\n            \"value\": \"[[parameters('VMHeartBeatRGAutoResolveTime')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VMHeartBeatRGPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VMHeartBeatRGAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VMHeartBeatRGThreshold')]\"\r\n          },\r\n          \"operator\": {\r\n            \"value\": \"[[parameters('VMHeartBeatRGOperator')]\"\r\n          },\r\n          \"timeAggregation\": {\r\n            \"value\": \"[[parameters('VMHeartBeatRGTimeAggregation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VMNetworkIn\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VM_NetworkIn_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VMNetworkInAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VMNetworkInWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VMNetworkInEvaluationFrequency')]\"\r\n          },\r\n          \"autoMitigate\": {\r\n            \"value\": \"[[parameters('VMNetworkInAutoMitigate')]\"\r\n          },\r\n          \"autoResolve\": {\r\n            \"value\": \"[[parameters('VMNetworkInAutoResolve')]\"\r\n          },\r\n          \"autoResolveTime\": {\r\n            \"value\": \"[[parameters('VMNetworkInAutoResolveTime')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VMNetworkInPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VMNetworkInAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VMNetworkInThreshold')]\"\r\n          },\r\n          \"operator\": {\r\n            \"value\": \"[[parameters('VMNetworkInOperator')]\"\r\n          },\r\n          \"timeAggregation\": {\r\n            \"value\": \"[[parameters('VMNetworkInTimeAggregation')]\"\r\n          },\r\n          \"failingPeriods\": {\r\n            \"value\": \"[[parameters('VMNetworkInFailingPeriods')]\"\r\n          },\r\n          \"evaluationPeriods\": {\r\n            \"value\": \"[[parameters('VMNetworkInEvaluationPeriods')]\"\r\n          },\r\n          \"computersToInclude\": {\r\n            \"value\": \"[[parameters('VMNetworkInComputersToInclude')]\"\r\n          },\r\n          \"networkInterfacesToInclude\": {\r\n            \"value\": \"[[parameters('VMNetworkInNetworkInterfaceToInclude')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VMNetworkOut\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VM_NetworkOut_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VMNetworkOutAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VMNetworkOutWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VMNetworkOutEvaluationFrequency')]\"\r\n          },\r\n          \"autoMitigate\": {\r\n            \"value\": \"[[parameters('VMNetworkOutAutoMitigate')]\"\r\n          },\r\n          \"autoResolve\": {\r\n            \"value\": \"[[parameters('VMNetworkOutAutoResolve')]\"\r\n          },\r\n          \"autoResolveTime\": {\r\n            \"value\": \"[[parameters('VMNetworkOutAutoResolveTime')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VMNetworkOutPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VMNetworkOutAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VMNetworkOutThreshold')]\"\r\n          },\r\n          \"operator\": {\r\n            \"value\": \"[[parameters('VMNetworkOutOperator')]\"\r\n          },\r\n          \"timeAggregation\": {\r\n            \"value\": \"[[parameters('VMNetworkOutTimeAggregation')]\"\r\n          },\r\n          \"failingPeriods\": {\r\n            \"value\": \"[[parameters('VMNetworkOutFailingPeriods')]\"\r\n          },\r\n          \"evaluationPeriods\": {\r\n            \"value\": \"[[parameters('VMNetworkOutEvaluationPeriods')]\"\r\n          },\r\n          \"computersToInclude\": {\r\n            \"value\": \"[[parameters('VMNetworkOutComputersToInclude')]\"\r\n          },\r\n          \"networkInterfacesToInclude\": {\r\n            \"value\": \"[[parameters('VMNetworkOutNetworkInterfaceToInclude')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VMOSDiskReadLatency\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VM_OSDiskreadLatency_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VMOSDiskReadLatencyAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VMOSDiskReadLatencyWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VMOSDiskReadLatencyEvaluationFrequency')]\"\r\n          },\r\n          \"autoMitigate\": {\r\n            \"value\": \"[[parameters('VMOSDiskReadLatencyAutoMitigate')]\"\r\n          },\r\n          \"autoResolve\": {\r\n            \"value\": \"[[parameters('VMOSDiskReadLatencyAutoResolve')]\"\r\n          },\r\n          \"autoResolveTime\": {\r\n            \"value\": \"[[parameters('VMOSDiskReadLatencyAutoResolveTime')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VMOSDiskReadLatencyPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VMOSDiskReadLatencyAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VMOSDiskReadLatencyThreshold')]\"\r\n          },\r\n          \"operator\": {\r\n            \"value\": \"[[parameters('VMOSDiskReadLatencyOperator')]\"\r\n          },\r\n          \"timeAggregation\": {\r\n            \"value\": \"[[parameters('VMOSDiskReadLatencyTimeAggregation')]\"\r\n          },\r\n          \"failingPeriods\": {\r\n            \"value\": \"[[parameters('VMOSDiskReadLatencyFailingPeriods')]\"\r\n          },\r\n          \"evaluationPeriods\": {\r\n            \"value\": \"[[parameters('VMOSDiskReadLatencyEvaluationPeriods')]\"\r\n          },\r\n          \"computersToInclude\": {\r\n            \"value\": \"[[parameters('VMOSDiskReadLatencyComputersToInclude')]\"\r\n          },\r\n          \"disksToInclude\": {\r\n            \"value\": \"[[parameters('VMOSDiskReadLatencyDisksToInclude')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VMOSDiskWriteLatency\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VM_OSDiskwriteLatency_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VMOSDiskWriteLatencyAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VMOSDiskWriteLatencyWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VMOSDiskWriteLatencyEvaluationFrequency')]\"\r\n          },\r\n          \"autoMitigate\": {\r\n            \"value\": \"[[parameters('VMOSDiskWriteLatencyAutoMitigate')]\"\r\n          },\r\n          \"autoResolve\": {\r\n            \"value\": \"[[parameters('VMOSDiskWriteLatencyAutoResolve')]\"\r\n          },\r\n          \"autoResolveTime\": {\r\n            \"value\": \"[[parameters('VMOSDiskWriteLatencyAutoResolveTime')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VMOSDiskWriteLatencyPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VMOSDiskWriteLatencyAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VMOSDiskWriteLatencyThreshold')]\"\r\n          },\r\n          \"operator\": {\r\n            \"value\": \"[[parameters('VMOSDiskWriteLatencyOperator')]\"\r\n          },\r\n          \"timeAggregation\": {\r\n            \"value\": \"[[parameters('VMOSDiskWriteLatencyTimeAggregation')]\"\r\n          },\r\n          \"failingPeriods\": {\r\n            \"value\": \"[[parameters('VMOSDiskWriteLatencyFailingPeriods')]\"\r\n          },\r\n          \"evaluationPeriods\": {\r\n            \"value\": \"[[parameters('VMOSDiskWriteLatencyEvaluationPeriods')]\"\r\n          },\r\n          \"computersToInclude\": {\r\n            \"value\": \"[[parameters('VMOSDiskWriteLatencyComputersToInclude')]\"\r\n          },\r\n          \"disksToInclude\": {\r\n            \"value\": \"[[parameters('VMOSDiskWriteLatencyDisksToInclude')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VMOSDiskSpace\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VM_OSDiskSpace_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VMOSDiskSpaceAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VMOSDiskSpaceWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VMOSDiskSpaceEvaluationFrequency')]\"\r\n          },\r\n          \"autoMitigate\": {\r\n            \"value\": \"[[parameters('VMOSDiskSpaceAutoMitigate')]\"\r\n          },\r\n          \"autoResolve\": {\r\n            \"value\": \"[[parameters('VMOSDiskSpaceAutoResolve')]\"\r\n          },\r\n          \"autoResolveTime\": {\r\n            \"value\": \"[[parameters('VMOSDiskSpaceAutoResolveTime')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VMOSDiskSpacePolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VMOSDiskSpaceAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VMOSDiskSpaceThreshold')]\"\r\n          },\r\n          \"operator\": {\r\n            \"value\": \"[[parameters('VMOSDiskSpaceOperator')]\"\r\n          },\r\n          \"timeAggregation\": {\r\n            \"value\": \"[[parameters('VMOSDiskSpaceTimeAggregation')]\"\r\n          },\r\n          \"failingPeriods\": {\r\n            \"value\": \"[[parameters('VMOSDiskSpaceFailingPeriods')]\"\r\n          },\r\n          \"evaluationPeriods\": {\r\n            \"value\": \"[[parameters('VMOSDiskSpaceEvaluationPeriods')]\"\r\n          },\r\n          \"computersToInclude\": {\r\n            \"value\": \"[[parameters('VMOSDiskSpaceComputersToInclude')]\"\r\n          },\r\n          \"disksToInclude\": {\r\n            \"value\": \"[[parameters('VMOSDiskSpaceDisksToInclude')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VMPercentCPU\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VM_CPU_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VMPercentCPUAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VMPercentCPUWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VMPercentCPUEvaluationFrequency')]\"\r\n          },\r\n          \"autoMitigate\": {\r\n            \"value\": \"[[parameters('VMPercentCPUAutoMitigate')]\"\r\n          },\r\n          \"autoResolve\": {\r\n            \"value\": \"[[parameters('VMPercentCPUAutoResolve')]\"\r\n          },\r\n          \"autoResolveTime\": {\r\n            \"value\": \"[[parameters('VMPercentCPUAutoResolveTime')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VMPercentCPUPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VMPercentCPUAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VMPercentCPUThreshold')]\"\r\n          },\r\n          \"operator\": {\r\n            \"value\": \"[[parameters('VMPercentCPUOperator')]\"\r\n          },\r\n          \"timeAggregation\": {\r\n            \"value\": \"[[parameters('VMPercentCPUTimeAggregation')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VMPercentMemory\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VM_Memory_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VMPercentMemoryAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VMPercentMemoryWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VMPercentMemoryEvaluationFrequency')]\"\r\n          },\r\n          \"autoMitigate\": {\r\n            \"value\": \"[[parameters('VMPercentMemoryAutoMitigate')]\"\r\n          },\r\n          \"autoResolve\": {\r\n            \"value\": \"[[parameters('VMPercentMemoryAutoResolve')]\"\r\n          },\r\n          \"autoResolveTime\": {\r\n            \"value\": \"[[parameters('VMPercentMemoryAutoResolveTime')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VMPercentMemoryPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VMPercentMemoryAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VMPercentMemoryThreshold')]\"\r\n          },\r\n          \"operator\": {\r\n            \"value\": \"[[parameters('VMPercentMemoryOperator')]\"\r\n          },\r\n          \"timeAggregation\": {\r\n            \"value\": \"[[parameters('VMPercentMemoryTimeAggregation')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VMDataDiskSpace\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VM_dataDiskSpace_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VMDataDiskSpaceAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VMDataDiskSpaceWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VMDataDiskSpaceEvaluationFrequency')]\"\r\n          },\r\n          \"autoMitigate\": {\r\n            \"value\": \"[[parameters('VMDataDiskSpaceAutoMitigate')]\"\r\n          },\r\n          \"autoResolve\": {\r\n            \"value\": \"[[parameters('VMDataDiskSpaceAutoResolve')]\"\r\n          },\r\n          \"autoResolveTime\": {\r\n            \"value\": \"[[parameters('VMDataDiskSpaceAutoResolveTime')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VMDataDiskSpacePolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VMDataDiskSpaceAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VMDataDiskSpaceThreshold')]\"\r\n          },\r\n          \"operator\": {\r\n            \"value\": \"[[parameters('VMDataDiskSpaceOperator')]\"\r\n          },\r\n          \"timeAggregation\": {\r\n            \"value\": \"[[parameters('VMDataDiskSpaceTimeAggregation')]\"\r\n          },\r\n          \"failingPeriods\": {\r\n            \"value\": \"[[parameters('VMDataDiskSpaceFailingPeriods')]\"\r\n          },\r\n          \"evaluationPeriods\": {\r\n            \"value\": \"[[parameters('VMDataDiskSpaceEvaluationPeriods')]\"\r\n          },\r\n          \"disksToInclude\": {\r\n            \"value\": \"[[parameters('VMDataDiskSpaceDisksToInclude')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VMDataDiskReadLatency\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VM_dataDiskReadLatency_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VMDataDiskReadLatencyAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VMDataDiskReadLatencyWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VMDataDiskReadLatencyEvaluationFrequency')]\"\r\n          },\r\n          \"autoMitigate\": {\r\n            \"value\": \"[[parameters('VMDataDiskReadLatencyAutoMitigate')]\"\r\n          },\r\n          \"autoResolve\": {\r\n            \"value\": \"[[parameters('VMDataDiskReadLatencyAutoResolve')]\"\r\n          },\r\n          \"autoResolveTime\": {\r\n            \"value\": \"[[parameters('VMDataDiskReadLatencyAutoResolveTime')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VMDataDiskReadLatencyPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VMDataDiskReadLatencyAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VMDataDiskReadLatencyThreshold')]\"\r\n          },\r\n          \"operator\": {\r\n            \"value\": \"[[parameters('VMDataDiskReadLatencyOperator')]\"\r\n          },\r\n          \"timeAggregation\": {\r\n            \"value\": \"[[parameters('VMDataDiskReadLatencyTimeAggregation')]\"\r\n          },\r\n          \"failingPeriods\": {\r\n            \"value\": \"[[parameters('VMDataDiskReadLatencyFailingPeriods')]\"\r\n          },\r\n          \"evaluationPeriods\": {\r\n            \"value\": \"[[parameters('VMDataDiskReadLatencyEvaluationPeriods')]\"\r\n          },\r\n          \"computersToInclude\": {\r\n            \"value\": \"[[parameters('VMDataDiskReadLatencyComputersToInclude')]\"\r\n          },\r\n          \"disksToInclude\": {\r\n            \"value\": \"[[parameters('VMDataDiskReadLatencyDisksToInclude')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VMDataDiskWriteLatency\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VM_dataDiskWriteLatency_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VMDataDiskWriteLatencyAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VMDataDiskWriteLatencyWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VMDataDiskWriteLatencyEvaluationFrequency')]\"\r\n          },\r\n          \"autoMitigate\": {\r\n            \"value\": \"[[parameters('VMDataDiskWriteLatencyAutoMitigate')]\"\r\n          },\r\n          \"autoResolve\": {\r\n            \"value\": \"[[parameters('VMDataDiskWriteLatencyAutoResolve')]\"\r\n          },\r\n          \"autoResolveTime\": {\r\n            \"value\": \"[[parameters('VMDataDiskWriteLatencyAutoResolveTime')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VMDataDiskWriteLatencyPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VMDataDiskWriteLatencyAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VMDataDiskWriteLatencyThreshold')]\"\r\n          },\r\n          \"operator\": {\r\n            \"value\": \"[[parameters('VMDataDiskWriteLatencyOperator')]\"\r\n          },\r\n          \"timeAggregation\": {\r\n            \"value\": \"[[parameters('VMDataDiskWriteLatencyTimeAggregation')]\"\r\n          },\r\n          \"failingPeriods\": {\r\n            \"value\": \"[[parameters('VMDataDiskWriteLatencyFailingPeriods')]\"\r\n          },\r\n          \"evaluationPeriods\": {\r\n            \"value\": \"[[parameters('VMDataDiskWriteLatencyEvaluationPeriods')]\"\r\n          },\r\n          \"computersToInclude\": {\r\n            \"value\": \"[[parameters('VMDataDiskWriteLatencyComputersToInclude')]\"\r\n          },\r\n          \"disksToInclude\": {\r\n            \"value\": \"[[parameters('VMDataDiskWriteLatencyDisksToInclude')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      }\r\n    ],\r\n    \"policyType\": \"Custom\",\r\n    \"policyDefinitionGroups\": null\r\n  }\r\n}\r\n",
    "$fxv#9": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_activitylog_ServiceHealth_Incident\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy Service Health Incident Alert\",\r\n    \"description\": \"Policy to Deploy Service Health Incident Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.1.1\",\r\n      \"category\": \"Monitoring\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\",\r\n          \"_deployed_by_amba\": true\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"ALZMonitorActionGroupEmail\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Action Group Email\",\r\n          \"description\": \"Email address to send alerts to\"\r\n        },\r\n        \"defaultValue\": \"action@mail.com\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring  Subscription level alerts. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/activityLogAlerts\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/ActivityLogAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*]\",\r\n                  \"where\": {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"category\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"ServiceHealth\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"properties.incidentType\"\r\n                          },\r\n                          {\r\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"Incident\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                },\r\n                \"equals\": 2\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"[[deployment().location]\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"ALZMonitorActionGroupEmail\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"ServiceHealthIncident\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"ALZMonitorActionGroupEmail\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"microsoft.insights/activityLogAlerts\",\r\n                            \"apiVersion\": \"2020-10-01\",\r\n                            \"name\": \"ServiceHealthIncident\",\r\n                            \"location\": \"global\",\r\n                            \"dependsOn\": [\r\n                              \"[[concat(subscription().Id, '/resourceGroups/', parameters('alertResourceGroupName'), '/providers/Microsoft.Insights/actionGroups/AlzActionGrp')]\"\r\n                            ],\r\n                            \"tags\": {\r\n                              \"_deployed_by_amba\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"actions\": {\r\n                                \"actionGroups\": [\r\n                                  {\r\n                                    \"actionGroupId\": \"[[concat(subscription().Id, '/resourceGroups/', parameters('alertResourceGroupName'), '/providers/Microsoft.Insights/actionGroups/AlzActionGrp')]\"\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"description\": \"ServiceHealthIncidentAlert\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().id]\"\r\n                              ],\r\n                              \"condition\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"category\",\r\n                                    \"equals\": \"ServiceHealth\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"properties.incidentType\",\r\n                                    \"equals\": \"Incident\"\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"parameters\": {\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          },\r\n                          {\r\n                            \"type\": \"Microsoft.Insights/actionGroups\",\r\n                            \"apiVersion\": \"2022-04-01\",\r\n                            \"name\": \"AlzActionGrp\",\r\n                            \"location\": \"global\",\r\n                            \"tags\": {\r\n                              \"_deployed_by_amba\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"groupShortName\": \"AlzActionGrp\",\r\n                              \"enabled\": true,\r\n                              \"emailReceivers\": [\r\n                                {\r\n                                  \"name\": \"AlzMail\",\r\n                                  \"emailAddress\": \"[[parameters('ALZMonitorActionGroupEmail')]\",\r\n                                  \"useCommonAlertSchema\": true\r\n                                }\r\n                              ]\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        },\r\n                        \"ALZMonitorActionGroupEmail\": {\r\n                          \"value\": \"[[parameters('ALZMonitorActionGroupEmail')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                },\r\n                \"ALZMonitorActionGroupEmail\": {\r\n                  \"value\": \"[[parameters('ALZMonitorActionGroupEmail')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#90": "{\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Alerting-Management\",\r\n  \"properties\": {\r\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts for Management\",\r\n    \"description\": \"Initiative to deploy AMBA alerts relevant to the ALZ Management management group\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.2\",\r\n      \"category\": \"Monitoring\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": true\r\n    },\r\n    \"parameters\": {\r\n      \"ALZMonitorResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"ALZ-Monitoring-RG\",\r\n        \"metadata\": {\r\n          \"displayName\": \"ALZ Monitoring Resource Group Name\",\r\n          \"description\": \"Name of the resource group to deploy the ALZ monitoring resources to\"\r\n        }\r\n      },\r\n      \"ALZMonitorResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"defaultValue\": {\r\n          \"_deployed_by_alz_monitor\": true\r\n        },\r\n        \"metadata\": {\r\n          \"displayName\": \"ALZ Monitoring Resource Group Tags\",\r\n          \"description\": \"Tags to apply to the resource group\"\r\n        }\r\n      },\r\n      \"ALZMonitorResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"centralus\",\r\n        \"metadata\": {\r\n          \"displayName\": \"ALZ Monitoring Resource Group Location\",\r\n          \"description\": \"Location of the resource group\"\r\n        }\r\n      },\r\n      \"AATotalJobAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"2\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"AA Total Job Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"AATotalJobAlertWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"AA Total Job Alert Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"AATotalJobAlertEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"AA Total Job Alert Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"AATotalJobAlertPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"AA Total Job Alert Policy Effect\",\r\n          \"description\": \"Policy effect for the alert\"\r\n        }\r\n      },\r\n      \"AATotalJobAlertAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"AA Total Job Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"AATotalJobAlertThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"20\",\r\n        \"metadata\": {\r\n          \"displayName\": \"AA Total Job Alert Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"RVBackupHealthPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"modify\",\r\n        \"allowedValues\": [\r\n          \"modify\",\r\n          \"audit\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"RV Backup Health Monitor Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, modify will create the alert if it does not exist and enable it on your Recovery Vaults, audit will only audit if alerting is enabled on Recovery Vaults, disabled will not create the alert on Recovery Vaults\"\r\n        }\r\n      },\r\n      \"StorageAccountAvailabilityAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"1\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Storage Account Availability Alert Severity\",\r\n          \"description\": \"Severity of the alert\"\r\n        }\r\n      },\r\n      \"StorageAccountAvailabilityWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Storage Account Availability Alert Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        }\r\n      },\r\n      \"StorageAccountAvailabilityFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Storage Account Availability Alert Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        }\r\n      },\r\n      \"StorageAccountAvailabilityPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"metadata\": {\r\n          \"displayName\": \"Storage Account Availability Alert Policy Effect\",\r\n          \"description\": \"Policy effect for the alert, deployIfNotExists will create the alert if it does not exist, disabled will not create the alert\"\r\n        }\r\n      },\r\n      \"StorageAccountAvailabilityAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Storage Account Availability Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"StorageAccountAvailabilityThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"90\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Storage Account Availability Alert Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        }\r\n      },\r\n      \"activityLAWDeleteAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Activity Log Alert Delete Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      },\r\n      \"activityLAWKeyRegenAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Activity Log Alert Key Regen Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        }\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_activityLAWDelete\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_activitylog_LAWorkspace_Delete')]\",\r\n        \"parameters\": {\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('activityLAWDeleteAlertState')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_activityLAWKeyRegen\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_activitylog_LAWorkspace_KeyRegen')]\",\r\n        \"parameters\": {\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('activityLAWKeyRegenAlertState')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_AATotalJob\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_AA_TotalJob_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('AATotalJobAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('AATotalJobAlertWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('AATotalJobAlertEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('AATotalJobAlertPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('AATotalJobAlertAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('AATotalJobAlertThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_RVBackupHealth\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_RecoveryVault_BackupHealthMonitor_Alert')]\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('RVBackupHealthPolicyEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_StorageAccountAvailability\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_StorageAccount_Availability_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('StorageAccountAvailabilityAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('StorageAccountAvailabilityWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('StorageAccountAvailabilityFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('StorageAccountAvailabilityPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('StorageAccountAvailabilityAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('StorageAccountAvailabilityThreshold')]\"\r\n          }\r\n        }\r\n      }\r\n    ],\r\n    \"policyType\": \"Custom\",\r\n    \"policyDefinitionGroups\": null\r\n  }\r\n}\r\n",
    "$fxv#91": "{\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Alerting-ServiceHealth\",\r\n  \"properties\": {\r\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts for Service Health\",\r\n    \"description\": \"Initiative to deploy AMBA Service Health alerts to Azure services\",\r\n    \"metadata\": {\r\n      \"version\": \"1.1.0\",\r\n      \"category\": \"Monitoring\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": true\r\n    },\r\n    \"parameters\": {\r\n      \"ALZMonitorResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"ALZ-Monitoring-RG\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Name of the resource group to deploy the alerts to\"\r\n        }\r\n      },\r\n      \"ALZMonitorResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"defaultValue\": {\r\n          \"_deployed_by_alz_monitor\": true\r\n        },\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags to apply to the resource group\"\r\n        }\r\n      },\r\n      \"ALZMonitorResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"centralus\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the resource group\"\r\n        }\r\n      },\r\n      \"ResHlthUnhealthyAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Health Unhealthy Alert State\",\r\n          \"description\": \"State of the Resource Health Unhealthy alert\"\r\n        }\r\n      },\r\n      \"SvcHlthAdvisoryAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Service Health Advisory Alert State\",\r\n          \"description\": \"State of the Service Health Advisory alert\"\r\n        }\r\n      },\r\n      \"SvcHlthIncidentAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Service Health Incident Alert State\",\r\n          \"description\": \"State of the Service Health Incident alert\"\r\n        }\r\n      },\r\n      \"SvcHlthMaintenanceAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Service Health Maintenance Alert State\",\r\n          \"description\": \"State of the Service Health Maintenance alert\"\r\n        }\r\n      },\r\n      \"svcHlthSecAdvisoryAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Service Health Security Advisory Alert State\",\r\n          \"description\": \"State of the Service Health Security Advisory alert\"\r\n        }\r\n      },\r\n      \"ALZMonitorActionGroupEmail\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"action@mail.com\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Action Group Email\",\r\n          \"description\": \"Email address to send alerts to\"\r\n        }\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"MonitorDisable\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Monitor Disable\",\r\n          \"description\": \"Disable the Monitor\"\r\n        }\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_ResHlthUnhealthy\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_activitylog_ResourceHealth_Unhealthy_Alert')]\",\r\n        \"parameters\": {\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('ResHlthUnhealthyAlertState')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_SvcHlthAdvisory\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_activitylog_ServiceHealth_HealthAdvisory')]\",\r\n        \"parameters\": {\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('SvcHlthAdvisoryAlertState')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          },\r\n          \"ALZMonitorActionGroupEmail\": {\r\n            \"value\": \"[[parameters('ALZMonitorActionGroupEmail')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_SvcHlthIncident\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_activitylog_ServiceHealth_Incident')]\",\r\n        \"parameters\": {\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('SvcHlthIncidentAlertState')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          },\r\n          \"ALZMonitorActionGroupEmail\": {\r\n            \"value\": \"[[parameters('ALZMonitorActionGroupEmail')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_SvcHlthMaintenance\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_activitylog_ServiceHealth_Maintenance')]\",\r\n        \"parameters\": {\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('SvcHlthMaintenanceAlertState')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          },\r\n          \"ALZMonitorActionGroupEmail\": {\r\n            \"value\": \"[[parameters('ALZMonitorActionGroupEmail')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_svcHlthSecAdvisory\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_activitylog_ServiceHealth_SecurityAdvisory')]\",\r\n        \"parameters\": {\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('svcHlthSecAdvisoryAlertState')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          },\r\n          \"ALZMonitorActionGroupEmail\": {\r\n            \"value\": \"[[parameters('ALZMonitorActionGroupEmail')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_AlertProcessing_Rule\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_AlertProcessing_Rule')]\",\r\n        \"parameters\": {\r\n          \"ALZMonitorResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"ALZMonitorResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"ALZMonitorResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          },\r\n          \"ALZMonitorActionGroupEmail\": {\r\n            \"value\": \"[[parameters('ALZMonitorActionGroupEmail')]\"\r\n          },\r\n          \"MonitorDisable\": {\r\n            \"value\": \"[[parameters('MonitorDisable')]\"\r\n          }\r\n        }\r\n      }\r\n    ],\r\n    \"policyType\": \"Custom\",\r\n    \"policyDefinitionGroups\": null\r\n  }\r\n}\r\n",
    "cloudEnv": "[environment().name]",
    "defaultDeploymentLocationByCloudType": {
      "AzureCloud": "northeurope",
      "AzureChinaCloud": "chinaeast2",
      "AzureUSGovernment": "usgovvirginia"
    },
    "templateVars": {
      "scope": "/providers/Microsoft.Management/managementGroups/contoso",
      "defaultDeploymentLocation": "\"location\": \"northeurope\"",
      "localizedDeploymentLocation": "[format('\"location\": \"{0}\"', variables('defaultDeploymentLocationByCloudType')[variables('cloudEnv')])]"
    },
    "targetDeploymentLocationByCloudType": {
      "AzureCloud": "[coalesce(parameters('location'), 'northeurope')]",
      "AzureChinaCloud": "[coalesce(parameters('location'), 'chinaeast2')]",
      "AzureUSGovernment": "[coalesce(parameters('location'), 'usgovvirginia')]"
    },
    "deploymentLocation": "[format('\"location\": \"{0}\"', variables('targetDeploymentLocationByCloudType')[variables('cloudEnv')])]",
    "loadPolicyDefinitions": {
      "All": [
        "[variables('$fxv#0')]",
        "[variables('$fxv#1')]",
        "[variables('$fxv#2')]",
        "[variables('$fxv#3')]",
        "[variables('$fxv#4')]",
        "[variables('$fxv#5')]",
        "[variables('$fxv#6')]",
        "[variables('$fxv#7')]",
        "[variables('$fxv#8')]",
        "[variables('$fxv#9')]",
        "[variables('$fxv#10')]",
        "[variables('$fxv#11')]",
        "[variables('$fxv#12')]",
        "[variables('$fxv#13')]",
        "[variables('$fxv#14')]",
        "[variables('$fxv#15')]",
        "[variables('$fxv#16')]",
        "[variables('$fxv#17')]",
        "[variables('$fxv#18')]",
        "[variables('$fxv#19')]",
        "[variables('$fxv#20')]",
        "[variables('$fxv#21')]",
        "[variables('$fxv#22')]",
        "[variables('$fxv#23')]",
        "[variables('$fxv#24')]",
        "[variables('$fxv#25')]",
        "[variables('$fxv#26')]",
        "[variables('$fxv#27')]",
        "[variables('$fxv#28')]",
        "[variables('$fxv#29')]",
        "[variables('$fxv#30')]",
        "[variables('$fxv#31')]",
        "[variables('$fxv#32')]",
        "[variables('$fxv#33')]",
        "[variables('$fxv#34')]",
        "[variables('$fxv#35')]",
        "[variables('$fxv#36')]",
        "[variables('$fxv#37')]",
        "[variables('$fxv#38')]",
        "[variables('$fxv#39')]",
        "[variables('$fxv#40')]",
        "[variables('$fxv#41')]",
        "[variables('$fxv#42')]",
        "[variables('$fxv#43')]",
        "[variables('$fxv#44')]",
        "[variables('$fxv#45')]",
        "[variables('$fxv#46')]",
        "[variables('$fxv#47')]",
        "[variables('$fxv#48')]",
        "[variables('$fxv#49')]",
        "[variables('$fxv#50')]",
        "[variables('$fxv#51')]",
        "[variables('$fxv#52')]",
        "[variables('$fxv#53')]",
        "[variables('$fxv#54')]",
        "[variables('$fxv#55')]",
        "[variables('$fxv#56')]",
        "[variables('$fxv#57')]",
        "[variables('$fxv#58')]",
        "[variables('$fxv#59')]",
        "[variables('$fxv#60')]",
        "[variables('$fxv#61')]",
        "[variables('$fxv#62')]",
        "[variables('$fxv#63')]",
        "[variables('$fxv#64')]",
        "[variables('$fxv#65')]",
        "[variables('$fxv#66')]",
        "[variables('$fxv#67')]",
        "[variables('$fxv#68')]",
        "[variables('$fxv#69')]",
        "[variables('$fxv#70')]",
        "[variables('$fxv#71')]",
        "[variables('$fxv#72')]",
        "[variables('$fxv#73')]",
        "[variables('$fxv#74')]",
        "[variables('$fxv#75')]",
        "[variables('$fxv#76')]",
        "[variables('$fxv#77')]",
        "[variables('$fxv#78')]",
        "[variables('$fxv#79')]",
        "[variables('$fxv#80')]",
        "[variables('$fxv#81')]",
        "[variables('$fxv#82')]",
        "[variables('$fxv#83')]",
        "[variables('$fxv#84')]",
        "[variables('$fxv#85')]",
        "[variables('$fxv#86')]"
      ],
      "AzureCloud": [],
      "AzureChinaCloud": [],
      "AzureUSGovernment": []
    },
    "loadPolicySetDefinitions": {
      "All": [
        "[variables('$fxv#87')]",
        "[variables('$fxv#88')]",
        "[variables('$fxv#89')]",
        "[variables('$fxv#90')]",
        "[variables('$fxv#91')]"
      ],
      "AzureCloud": [],
      "AzureChinaCloud": [],
      "AzureUSGovernment": []
    },
    "policyDefinitionsByCloudType": {
      "All": "[variables('policyDefinitionsAll')]",
      "AzureCloud": "[variables('policyDefinitionsAzureCloud')]",
      "AzureChinaCloud": "[variables('policyDefinitionsAzureChinaCloud')]",
      "AzureUSGovernment": "[variables('policyDefinitionsAzureUSGovernment')]"
    },
    "policySetDefinitionsByCloudType": {
      "All": "[variables('policySetDefinitionsAll')]",
      "AzureCloud": "[variables('policySetDefinitionsAzureCloud')]",
      "AzureChinaCloud": "[variables('policySetDefinitionsAzureChinaCloud')]",
      "AzureUSGovernment": "[variables('policySetDefinitionsAzureUSGovernment')]"
    },
    "policyDefinitions": "[concat(variables('policyDefinitionsByCloudType').All, variables('policyDefinitionsByCloudType')[variables('cloudEnv')])]",
    "policySetDefinitions": "[concat(variables('policySetDefinitionsByCloudType').All, variables('policySetDefinitionsByCloudType')[variables('cloudEnv')])]"
  },
  "resources": [
    {
      "copy": {
        "name": "PolicyDefinitions",
        "count": "[length(variables('policyDefinitions'))]"
      },
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2020-09-01",
      "name": "[variables('policyDefinitions')[copyIndex()].name]",
      "properties": {
        "description": "[variables('policyDefinitions')[copyIndex()].properties.description]",
        "displayName": "[variables('policyDefinitions')[copyIndex()].properties.displayName]",
        "metadata": "[variables('policyDefinitions')[copyIndex()].properties.metadata]",
        "mode": "[variables('policyDefinitions')[copyIndex()].properties.mode]",
        "parameters": "[variables('policyDefinitions')[copyIndex()].properties.parameters]",
        "policyType": "[variables('policyDefinitions')[copyIndex()].properties.policyType]",
        "policyRule": "[variables('policyDefinitions')[copyIndex()].properties.policyRule]"
      }
    },
    {
      "copy": {
        "name": "PolicySetDefinitions",
        "count": "[length(variables('policySetDefinitions'))]"
      },
      "type": "Microsoft.Authorization/policySetDefinitions",
      "apiVersion": "2020-09-01",
      "name": "[variables('policySetDefinitions')[copyIndex()].name]",
      "properties": {
        "description": "[variables('policySetDefinitions')[copyIndex()].properties.description]",
        "displayName": "[variables('policySetDefinitions')[copyIndex()].properties.displayName]",
        "metadata": "[variables('policySetDefinitions')[copyIndex()].properties.metadata]",
        "parameters": "[variables('policySetDefinitions')[copyIndex()].properties.parameters]",
        "policyType": "[variables('policySetDefinitions')[copyIndex()].properties.policyType]",
        "policyDefinitions": "[variables('policySetDefinitions')[copyIndex()].properties.policyDefinitions]",
        "policyDefinitionGroups": "[variables('policySetDefinitions')[copyIndex()].properties.policyDefinitionGroups]"
      },
      "dependsOn": [
        "PolicyDefinitions"
      ]
    }
  ],
  "outputs": {
    "policyDefinitionNames": {
      "type": "array",
      "copy": {
        "count": "[length(variables('policyDefinitions'))]",
        "input": "[variables('policyDefinitions')[copyIndex()].name]"
      }
    },
    "policySetDefinitionNames": {
      "type": "array",
      "copy": {
        "count": "[length(variables('policySetDefinitions'))]",
        "input": "[variables('policySetDefinitions')[copyIndex()].name]"
      }
    }
  }
}