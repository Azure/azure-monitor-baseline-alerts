{
  "$schema": "https://schema.management.azure.com/schemas/2019-08-01/managementGroupDeploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "metadata": {
    "_generator": {
      "name": "bicep",
      "version": "0.39.26.7824",
      "templateHash": "16030781420757594685"
    }
  },
  "parameters": {
    "topLevelManagementGroupPrefix": {
      "type": "string",
      "defaultValue": "alz",
      "metadata": {
        "message": "The JSON version of this file is programatically generated from Bicep. PLEASE DO NOT UPDATE MANUALLY!!",
        "description": "Provide a prefix (unique at tenant-scope) for the Management Group hierarchy and other resources created as part of an Azure landing zone. DEFAULT VALUE = \"alz\""
      }
    },
    "location": {
      "type": "string",
      "defaultValue": "[deployment().location]",
      "metadata": {
        "description": "Optionally set the deployment location for policies with Deploy If Not Exists effect. DEFAULT VALUE = \"deployment().location\""
      }
    },
    "scope": {
      "type": "string",
      "defaultValue": "[tenantResourceId('Microsoft.Management/managementGroups', parameters('topLevelManagementGroupPrefix'))]",
      "metadata": {
        "description": "Optionally set the scope for custom Policy Definitions used in Policy Set Definitions (Initiatives). Must be one of '/', '/subscriptions/id' or '/providers/Microsoft.Management/managementGroups/id'. DEFAULT VALUE = '/providers/Microsoft.Management/managementGroups/${topLevelManagementGroupPrefix}'"
      }
    }
  },
  "variables": {
    "copy": [
      {
        "name": "processPolicyDefinitionsAll",
        "count": "[length(variables('loadPolicyDefinitions').All)]",
        "input": "[replace(replace(variables('loadPolicyDefinitions').All[copyIndex('processPolicyDefinitionsAll')], variables('templateVars').defaultDeploymentLocation, variables('deploymentLocation')), variables('templateVars').localizedDeploymentLocation, variables('deploymentLocation'))]"
      },
      {
        "name": "processPolicyDefinitionsAzureCloud",
        "count": "[length(variables('loadPolicyDefinitions').AzureCloud)]",
        "input": "[replace(replace(variables('loadPolicyDefinitions').AzureCloud[copyIndex('processPolicyDefinitionsAzureCloud')], variables('templateVars').defaultDeploymentLocation, variables('deploymentLocation')), variables('templateVars').localizedDeploymentLocation, variables('deploymentLocation'))]"
      },
      {
        "name": "processPolicyDefinitionsAzureChinaCloud",
        "count": "[length(variables('loadPolicyDefinitions').AzureChinaCloud)]",
        "input": "[replace(replace(variables('loadPolicyDefinitions').AzureChinaCloud[copyIndex('processPolicyDefinitionsAzureChinaCloud')], variables('templateVars').defaultDeploymentLocation, variables('deploymentLocation')), variables('templateVars').localizedDeploymentLocation, variables('deploymentLocation'))]"
      },
      {
        "name": "processPolicyDefinitionsAzureUSGovernment",
        "count": "[length(variables('loadPolicyDefinitions').AzureUSGovernment)]",
        "input": "[replace(replace(variables('loadPolicyDefinitions').AzureUSGovernment[copyIndex('processPolicyDefinitionsAzureUSGovernment')], variables('templateVars').defaultDeploymentLocation, variables('deploymentLocation')), variables('templateVars').localizedDeploymentLocation, variables('deploymentLocation'))]"
      },
      {
        "name": "processPolicySetDefinitionsAll",
        "count": "[length(variables('loadPolicySetDefinitions').All)]",
        "input": "[replace(variables('loadPolicySetDefinitions').All[copyIndex('processPolicySetDefinitionsAll')], variables('templateVars').scope, parameters('scope'))]"
      },
      {
        "name": "processPolicySetDefinitionsAzureCloud",
        "count": "[length(variables('loadPolicySetDefinitions').AzureCloud)]",
        "input": "[replace(variables('loadPolicySetDefinitions').AzureCloud[copyIndex('processPolicySetDefinitionsAzureCloud')], variables('templateVars').scope, parameters('scope'))]"
      },
      {
        "name": "processPolicySetDefinitionsAzureChinaCloud",
        "count": "[length(variables('loadPolicySetDefinitions').AzureChinaCloud)]",
        "input": "[replace(variables('loadPolicySetDefinitions').AzureChinaCloud[copyIndex('processPolicySetDefinitionsAzureChinaCloud')], variables('templateVars').scope, parameters('scope'))]"
      },
      {
        "name": "processPolicySetDefinitionsAzureUSGovernment",
        "count": "[length(variables('loadPolicySetDefinitions').AzureUSGovernment)]",
        "input": "[replace(variables('loadPolicySetDefinitions').AzureUSGovernment[copyIndex('processPolicySetDefinitionsAzureUSGovernment')], variables('templateVars').scope, parameters('scope'))]"
      },
      {
        "name": "policyDefinitionsAll",
        "count": "[length(variables('processPolicyDefinitionsAll'))]",
        "input": "[json(variables('processPolicyDefinitionsAll')[copyIndex('policyDefinitionsAll')])]"
      },
      {
        "name": "policyDefinitionsAzureCloud",
        "count": "[length(variables('processPolicyDefinitionsAzureCloud'))]",
        "input": "[json(variables('processPolicyDefinitionsAzureCloud')[copyIndex('policyDefinitionsAzureCloud')])]"
      },
      {
        "name": "policyDefinitionsAzureChinaCloud",
        "count": "[length(variables('processPolicyDefinitionsAzureChinaCloud'))]",
        "input": "[json(variables('processPolicyDefinitionsAzureChinaCloud')[copyIndex('policyDefinitionsAzureChinaCloud')])]"
      },
      {
        "name": "policyDefinitionsAzureUSGovernment",
        "count": "[length(variables('processPolicyDefinitionsAzureUSGovernment'))]",
        "input": "[json(variables('processPolicyDefinitionsAzureUSGovernment')[copyIndex('policyDefinitionsAzureUSGovernment')])]"
      },
      {
        "name": "policySetDefinitionsAll",
        "count": "[length(variables('processPolicySetDefinitionsAll'))]",
        "input": "[json(variables('processPolicySetDefinitionsAll')[copyIndex('policySetDefinitionsAll')])]"
      },
      {
        "name": "policySetDefinitionsAzureCloud",
        "count": "[length(variables('processPolicySetDefinitionsAzureCloud'))]",
        "input": "[json(variables('processPolicySetDefinitionsAzureCloud')[copyIndex('policySetDefinitionsAzureCloud')])]"
      },
      {
        "name": "policySetDefinitionsAzureChinaCloud",
        "count": "[length(variables('processPolicySetDefinitionsAzureChinaCloud'))]",
        "input": "[json(variables('processPolicySetDefinitionsAzureChinaCloud')[copyIndex('policySetDefinitionsAzureChinaCloud')])]"
      },
      {
        "name": "policySetDefinitionsAzureUSGovernment",
        "count": "[length(variables('processPolicySetDefinitionsAzureUSGovernment'))]",
        "input": "[json(variables('processPolicySetDefinitionsAzureUSGovernment')[copyIndex('policySetDefinitionsAzureUSGovernment')])]"
      }
    ],
    "$fxv#0": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_activitylog_Firewall_Delete\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - Activity Log Azure FireWall Delete Alert\",\n    \"description\": \"Policy to audit/deploy Activity Log Azure Firewall Delete Alert\",\n    \"metadata\": {\n      \"version\": \"1.2.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"alertResourceGroupName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Name\",\n          \"description\": \"Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"rg-amba-monitoring-001\"\n      },\n      \"alertResourceGroupTags\": {\n        \"type\": \"Object\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Tags\",\n          \"description\": \"Tags on the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": {\n          \"Project\": \"amba-monitoring\"\n        }\n      },\n      \"alertResourceGroupLocation\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Location\",\n          \"description\": \"Location of the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"centralus\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name to disable monitoring. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/azureFirewalls\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/activityLogAlerts\",\n          \"name\": \"ActivityAzureFirewallDelete\",\n          \"existenceScope\": \"resourceGroup\",\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\n          \"deploymentScope\": \"subscription\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/ActivityLogAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"count\": {\n                  \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*]\",\n                  \"where\": {\n                    \"anyOf\": [\n                      {\n                        \"allOf\": [\n                          {\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\n                            \"equals\": \"category\"\n                          },\n                          {\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\n                            \"equals\": \"Administrative\"\n                          }\n                        ]\n                      },\n                      {\n                        \"allOf\": [\n                          {\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\n                            \"equals\": \"operationName\"\n                          },\n                          {\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\n                            \"equals\": \"Microsoft.Network/azureFirewalls/delete\"\n                          }\n                        ]\n                      }\n                    ]\n                  }\n                },\n                \"equals\": 2\n              }\n            ]\n          },\n          \"deployment\": {\n            \"location\": \"northeurope\",\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"alertResourceGroupName\": {\n                    \"type\": \"string\"\n                  },\n                  \"alertResourceGroupTags\": {\n                    \"type\": \"object\"\n                  },\n                  \"alertResourceGroupLocation\": {\n                    \"type\": \"string\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"string\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\n                    \"apiVersion\": \"2020-10-01\",\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\n                  },\n                  {\n                    \"type\": \"Microsoft.Resources/deployments\",\n                    \"apiVersion\": \"2019-10-01\",\n                    \"name\": \"ActivityAzureFirewallDelete\",\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\n                    \"dependsOn\": [\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\n                    ],\n                    \"properties\": {\n                      \"mode\": \"Incremental\",\n                      \"template\": {\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                        \"contentVersion\": \"1.0.0.0\",\n                        \"parameters\": {\n                          \"enabled\": {\n                            \"type\": \"string\"\n                          },\n                          \"alertResourceGroupName\": {\n                            \"type\": \"string\"\n                          }\n                        },\n                        \"variables\": {},\n                        \"resources\": [\n                          {\n                            \"type\": \"microsoft.insights/activityLogAlerts\",\n                            \"apiVersion\": \"2020-10-01\",\n                            \"name\": \"ActivityAzureFirewallDelete\",\n                            \"location\": \"global\",\n                            \"tags\": {\n                              \"_deployed_by_amba\": true\n                            },\n                            \"properties\": {\n                              \"description\": \"Activity Log Firewall Delete\",\n                              \"enabled\": \"[[parameters('enabled')]\",\n                              \"scopes\": [\n                                \"[[subscription().id]\"\n                              ],\n                              \"condition\": {\n                                \"allOf\": [\n                                  {\n                                    \"field\": \"category\",\n                                    \"equals\": \"Administrative\"\n                                  },\n                                  {\n                                    \"field\": \"operationName\",\n                                    \"equals\": \"Microsoft.Network/azurefirewalls/delete\"\n                                  },\n                                  {\n                                    \"field\": \"status\",\n                                    \"containsAny\": [\n                                      \"succeeded\"\n                                    ]\n                                  }\n                                ]\n                              },\n                              \"parameters\": {\n                                \"enabled\": {\n                                  \"value\": \"[[parameters('enabled')]\"\n                                }\n                              }\n                            }\n                          }\n                        ]\n                      },\n                      \"parameters\": {\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"alertResourceGroupName\": {\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"alertResourceGroupName\": {\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                },\n                \"alertResourceGroupTags\": {\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\n                },\n                \"alertResourceGroupLocation\": {\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#1": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_AFW_FirewallHealth_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - AFW FirewallHealth Alert\",\n    \"description\": \"Policy to audit/deploy Azure Firewall FirewallHealth Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"90\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/azureFirewalls\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/azureFirewalls\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"FirewallHealth\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/azureFirewalls/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"LessThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-FirewallHealth-threshold-Override_'), field('tags._amba-FirewallHealth-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-FirewallHealth')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for AFW FirewallHealth\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"FirewallHealth\",\n                            \"metricNamespace\": \"Microsoft.Network/azureFirewalls\",\n                            \"metricName\": \"FirewallHealth\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-FirewallHealth-threshold-Override_'), field('tags._amba-FirewallHealth-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#10": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_ERP_ExpressRouteBitsIn_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - ER Direct ExpressRoute Bits In Alert\",\n    \"description\": \"Policy to audit/deploy ER Direct Connection BitsInPerSecond Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Networking\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"disabled\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/expressRoutePorts\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/expressRoutePorts\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"PortBitsInPerSecond\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/expressRoutePorts/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"LessThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-PortBitsInPerSecond-threshold-Override_'), field('tags._amba-PortBitsInPerSecond-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-DirectERBitsInAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for ER Direct Connection BitsInPerSecond\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"PortBitsInPerSecond\",\n                            \"metricNamespace\": \"Microsoft.Network/expressRoutePorts\",\n                            \"metricName\": \"PortBitsInPerSecond\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-PortBitsInPerSecond-threshold-Override_'), field('tags._amba-PortBitsInPerSecond-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#11": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_ERP_ExpressRouteBitsOut_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - ER Direct ExpressRoute Bits Out Alert\",\n    \"description\": \"Policy to audit/deploy ER Direct Connection BitsOutPerSecond Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Networking\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"disabled\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/expressRoutePorts\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/expressRoutePorts\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"PortBitsOutPerSecond\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/expressRoutePorts/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"LessThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-PortBitsOutPerSecond-threshold-Override_'), field('tags._amba-PortBitsOutPerSecond-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-DirectERBitsOutAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for ER Direct Connection BitsOutPerSecond\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"PortBitsOutPerSecond\",\n                            \"metricNamespace\": \"Microsoft.Network/expressRoutePorts\",\n                            \"metricName\": \"PortBitsOutPerSecond\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-PortBitsOutPerSecond-threshold-Override_'), field('tags._amba-PortBitsOutPerSecond-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#12": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_ERP_ExpressRoutLineProtocol_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - ER Direct ExpressRoute LineProtocol Alert\",\n    \"description\": \"Policy to audit/deploy ER Direct LineProtocol Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Networking\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"0.9\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"disabled\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/expressRoutePorts\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/expressRoutePorts\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"LineProtocol\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/expressRoutePorts/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"LessThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-LineProtocol-threshold-Override_'), field('tags._amba-LineProtocol-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-DirectERLineProtocolAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for ER Direct Connection LineProtocolPerSecond\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"LineProtocol\",\n                            \"metricNamespace\": \"Microsoft.Network/expressRoutePorts\",\n                            \"metricName\": \"LineProtocol\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-LineProtocol-threshold-Override_'), field('tags._amba-LineProtocol-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#13": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_ERP_ExpressRoutRxLightLevel_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - ER Direct ExpressRoute RxLightLevel High Alert\",\n    \"description\": \"Policy to audit/deploy ER Direct RxLightLevel High Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Networking\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"1\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"0\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"disabled\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/expressRoutePorts\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/expressRoutePorts\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"RxLightLevel\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/expressRoutePorts/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-RxLightLevel-High-threshold-Override_'), field('tags._amba-RxLightLevel-High-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-DirectERRxLightLevelHighAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for ER Direct Connection RxLightLevelHigh\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"RxLightLevel\",\n                            \"metricNamespace\": \"Microsoft.Network/expressRoutePorts\",\n                            \"metricName\": \"RxLightLevel\",\n                            \"operator\": \"GreaterThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-RxLightLevel-High-threshold-Override_'), field('tags._amba-RxLightLevel-High-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#14": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_ERP_ExpressRoutRxLightLevellow_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - ER Direct ExpressRoute RxLightLevel Low Alert\",\n    \"description\": \"Policy to audit/deploy ER Direct RxLightLevel Low Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Networking\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"1\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"-10\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"disabled\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/expressRoutePorts\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/expressRoutePorts\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"RxLightLevel\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"LessThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/expressRoutePorts/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"LessThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-RxLightLevel-Low-threshold-Override_'), field('tags._amba-RxLightLevel-Low-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-DirectERRxLightLevelLowAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for ER Direct Connection RxLightLevelLow\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"RxLightLevel\",\n                            \"metricNamespace\": \"Microsoft.Network/expressRoutePorts\",\n                            \"metricName\": \"RxLightLevel\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-RxLightLevel-Low-threshold-Override_'), field('tags._amba-RxLightLevel-Low-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#15": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_ERP_ExpressRoutTxLightLevell_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - ER Direct ExpressRoute TxLightLevel High Alert\",\n    \"description\": \"Policy to audit/deploy ER Direct TxLightLevel High Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Networking\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"1\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"0\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"disabled\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/expressRoutePorts\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/expressRoutePorts\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"TxLightLevel\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/expressRoutePorts/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-TxLightLevel-High-threshold-Override_'), field('tags._amba-TxLightLevel-High-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-DirectERTxLightLevelHighAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for ER Direct Connection TxLightLevelHigh\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"TxLightLevel\",\n                            \"metricNamespace\": \"Microsoft.Network/expressRoutePorts\",\n                            \"metricName\": \"TxLightLevel\",\n                            \"operator\": \"GreaterThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-TxLightLevel-High-threshold-Override_'), field('tags._amba-TxLightLevel-High-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#16": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_ERP_ExpressRoutTxLightLevellow_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - ER Direct ExpressRoute TxLightLevel Low Alert\",\n    \"description\": \"Policy to audit/deploy ER Direct TxLightLevel Low Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Networking\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"1\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"-10\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"disabled\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/expressRoutePorts\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/expressRoutePorts\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"TxLightLevel\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"LessThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/expressRoutePorts/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"LessThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-TxLightLevel-Low-threshold-Override_'), field('tags._amba-TxLightLevel-Low-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-DirectERTxLightLevelLowAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for ER Direct Connection TxLightLevelLow\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"TxLightLevel\",\n                            \"metricNamespace\": \"Microsoft.Network/expressRoutePorts\",\n                            \"metricName\": \"TxLightLevel\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-TxLightLevel-Low-threshold-Override_'), field('tags._amba-TxLightLevel-Low-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#17": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_PDNSZ_CapacityUtil_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - PDNSZ Capacity Utilization Alert\",\n    \"description\": \"Policy to audit/deploy Private DNS Zone Capacity Utilization Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT1H\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1H\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"80\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/privateDnsZones\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/privateDnsZones\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"VirtualNetworkLinkCapacityUtilization\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/privateDnsZones/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Maximum\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"GreaterThanOrEqual\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-VirtualNetworkLinkCapacityUtilization-threshold-Override_'), field('tags._amba-VirtualNetworkLinkCapacityUtilization-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-CapacityUtilizationAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Private DNS Zone Virtual Network Link Capacity Utilization\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"VirtualNetworkLinkCapacityUtilization\",\n                            \"metricNamespace\": \"Microsoft.Network/privateDnsZones\",\n                            \"metricName\": \"VirtualNetworkLinkCapacityUtilization\",\n                            \"operator\": \"GreaterThanOrEqual\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Maximum\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-VirtualNetworkLinkCapacityUtilization-threshold-Override_'), field('tags._amba-VirtualNetworkLinkCapacityUtilization-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#18": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_PDNSZ_QueryVolume_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - PDNSZ Query Volume Alert\",\n    \"description\": \"Policy to audit/deploy Private DNS Zone Query Volume Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"4\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT1H\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1H\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"500\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"disabled\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/privateDnsZones\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/privateDnsZones\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"QueryVolume\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/privateDnsZones/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Total\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"GreaterThanOrEqual\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-QueryVolume-threshold-Override_'), field('tags._amba-QueryVolume-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                  \"name\": \"[[concat(parameters('resourceName'), '-QueryVolumeAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Private DNS Query Volume\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"QueryVolume\",\n                            \"metricNamespace\": \"Microsoft.Network/privateDnsZones\",\n                            \"metricName\": \"QueryVolume\",\n                            \"operator\": \"GreaterThanOrEqual\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Total\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-QueryVolume-threshold-Override_'), field('tags._amba-QueryVolume-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#19": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_PDNSZ_RecordSetCapacity_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - PDNSZ Record Set Capacity Alert\",\n    \"description\": \"Policy to audit/deploy Private DNS Zone Record Set Capacity Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT1H\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1H\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"80\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/privateDnsZones\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/privateDnsZones\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"RecordSetCapacityUtilization\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/privateDnsZones/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Maximum\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"GreaterThanOrEqual\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-RecordSetCapacityUtilization-threshold-Override_'), field('tags._amba-RecordSetCapacityUtilization-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-RecordSet_Capacity_Utilization')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Private DNS Zone Record Set Capacity Utilization\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"RecordSetCapacityUtilization\",\n                            \"metricNamespace\": \"Microsoft.Network/privateDnsZones\",\n                            \"metricName\": \"RecordSetCapacityUtilization\",\n                            \"operator\": \"GreaterThanOrEqual\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Maximum\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-RecordSetCapacityUtilization-threshold-Override_'), field('tags._amba-RecordSetCapacityUtilization-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#2": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_AFW_SNATPortUtilization_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - AFW SNATPortUtilization Alert\",\n    \"description\": \"Policy to audit/deploy Azure Firewall SNATPortUtilization Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"1\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"80\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/azureFirewalls\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/azureFirewalls\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"SNATPortUtilization\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/azureFirewalls/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-SNATPortUtilization-threshold-Override_'), field('tags._amba-SNATPortUtilization-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-SNATPortUtilization')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for AFW SNATPortUtilization\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"SNATPortUtilization\",\n                            \"metricNamespace\": \"Microsoft.Network/azureFirewalls\",\n                            \"metricName\": \"SNATPortUtilization\",\n                            \"operator\": \"GreaterThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-SNATPortUtilization-threshold-Override_'), field('tags._amba-SNATPortUtilization-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#20": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_DNSZ_RegistrationCapacityUtil_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - PDNSZ Registration Capacity Utilization Alert\",\n    \"description\": \"Policy to audit/deploy Private DNS Zone Registration Capacity Utilization Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT1H\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1H\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"80\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/privateDnsZones\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/privateDnsZones\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"VirtualNetworkWithRegistrationCapacityUtilization\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/privateDnsZones/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Maximum\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"GreaterThanOrEqual\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-VirtualNetworkWithRegistrationCapacityUtilization-threshold-Override_'), field('tags._amba-VirtualNetworkWithRegistrationCapacityUtilization-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-RequestsAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Private DNS Zone Registration Capacity Utilization\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"VirtualNetworkWithRegistrationCapacityUtilization\",\n                            \"metricNamespace\": \"Microsoft.Network/privateDnsZones\",\n                            \"metricName\": \"VirtualNetworkWithRegistrationCapacityUtilization\",\n                            \"operator\": \"GreaterThanOrEqual\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Maximum\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-VirtualNetworkWithRegistrationCapacityUtilization-threshold-Override_'), field('tags._amba-VirtualNetworkWithRegistrationCapacityUtilization-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#21": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VnetGw_ExpressRouteBitsPerSecond_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - VNetG ExpressRoute Bits Per Second Alert\",\n    \"description\": \"Policy to audit/deploy Virtual Network Gateway Express Route Bits Per Second Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/virtualNetworkGateways\"\n          },\n          {\n            \"field\": \"Microsoft.Network/virtualNetworkGateways/gatewayType\",\n            \"equals\": \"ExpressRoute\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/virtualNetworkGateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"ExpressRouteGatewayBitsPerSecond\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/virtualNetworkGateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].operator\",\n                \"equals\": \"LessThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-ExpressRouteGatewayBitsPerSecond-threshold-Override_'), field('tags._amba-ExpressRouteGatewayBitsPerSecond-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-GatewayERBitsAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for VNet Gateway Express Route Bits Per Second\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"ExpressRouteGatewayBitsPerSecond\",\n                            \"metricNamespace\": \"Microsoft.Network/virtualNetworkGateways\",\n                            \"metricName\": \"ExpressRouteGatewayBitsPerSecond\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-ExpressRouteGatewayBitsPerSecond-threshold-Override_'), field('tags._amba-ExpressRouteGatewayBitsPerSecond-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#22": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VnetGw_ExpressRouteCpuUtil_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - VNetG ExpressRoute CPU Utilization Alert\",\n    \"description\": \"Policy to audit/deploy Virtual Network Gateway Express Route CPU Utilization Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"1\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"80\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/virtualNetworkGateways\"\n          },\n          {\n            \"field\": \"Microsoft.Network/virtualNetworkGateways/gatewayType\",\n            \"equals\": \"ExpressRoute\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/virtualNetworkGateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"ExpressRouteGatewayCpuUtilization\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/virtualNetworkGateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-ExpressRouteGatewayCpuUtilization-threshold-Override_'), field('tags._amba-ExpressRouteGatewayCpuUtilization-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-GatewayERCPUAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for VNet Gateway Express Route CPU Utilization\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"ExpressRouteGatewayCpuUtilization\",\n                            \"metricNamespace\": \"Microsoft.Network/virtualNetworkGateways\",\n                            \"metricName\": \"ExpressRouteGatewayCpuUtilization\",\n                            \"operator\": \"GreaterThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-ExpressRouteGatewayCpuUtilization-threshold-Override_'), field('tags._amba-ExpressRouteGatewayCpuUtilization-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#23": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VnetGw_TunnelBandwidth_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - VNetG Tunnel Bandwidth Alert\",\n    \"description\": \"Policy to audit/deploy Virtual Network Gateway Tunnel Bandwidth Alert\",\n    \"metadata\": {\n      \"version\": \"1.5.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/virtualNetworkGateways\"\n          },\n          {\n            \"field\": \"Microsoft.Network/virtualNetworkGateways/gatewayType\",\n            \"equals\": \"VPN\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/virtualNetworkGateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"TunnelAverageBandwidth\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/virtualNetworkGateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].operator\",\n                \"equals\": \"LessThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-TunnelAverageBandwidth-threshold-Override_'), field('tags._amba-TunnelAverageBandwidth-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelBandwidthAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for VNet Gateway Tunnel Avg Bandwidth\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"TunnelAverageBandwidth\",\n                            \"metricNamespace\": \"Microsoft.Network/virtualNetworkGateways\",\n                            \"metricName\": \"TunnelAverageBandwidth\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-TunnelAverageBandwidth-threshold-Override_'), field('tags._amba-TunnelAverageBandwidth-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#24": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VnetGw_TunnelEgress_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - VNetG Tunnel Egress Alert\",\n    \"description\": \"Policy to audit/deploy Virtual Network Gateway Tunnel Egress Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"disabled\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/virtualNetworkGateways\"\n          },\n          {\n            \"field\": \"Microsoft.Network/virtualNetworkGateways/gatewayType\",\n            \"equals\": \"VPN\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/virtualNetworkGateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"TunnelEgressBytes\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/virtualNetworkGateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].operator\",\n                \"equals\": \"LessThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-TunnelEgressBytes-threshold-Override_'), field('tags._amba-TunnelEgressBytes-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelEgressAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for VNet Gateway Tunnel Egress Bytes\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"TunnelEgressBytes\",\n                            \"metricNamespace\": \"Microsoft.Network/virtualNetworkGateways\",\n                            \"metricName\": \"TunnelEgressBytes\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-TunnelEgressBytes-threshold-Override_'), field('tags._amba-TunnelEgressBytes-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#25": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VnetGw_TunnelEgressPacketDropCount_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - VNetG Egress Packet Drop Count Alert\",\n    \"description\": \"Policy to audit/deploy Vnet Gateway Egress Packet Drop Count Alert\",\n    \"metadata\": {\n      \"version\": \"1.5.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"3\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"failingPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Failing Periods\",\n          \"description\": \"Number of failing periods before alert is fired\"\n        },\n        \"defaultValue\": \"4\"\n      },\n      \"evaluationPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Periods\",\n          \"description\": \"The number of aggregated lookback points.\"\n        },\n        \"defaultValue\": \"4\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name to disable monitoring. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.network/virtualNetworkGateways\"\n          },\n          {\n            \"field\": \"Microsoft.Network/virtualNetworkGateways/gatewayType\",\n            \"equals\": \"VPN\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.network/virtualNetworkGateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"TunnelEgressPacketDropCount\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/virtualNetworkGateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.alertSensitivity\",\n                \"equals\": \"Medium\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.failingPeriods.minFailingPeriodsToAlert\",\n                \"equals\": \"[[parameters('failingPeriods')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.failingPeriods.numberOfEvaluationPeriods\",\n                \"equals\": \"[[parameters('evaluationPeriods')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"failingPeriods\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationPeriods\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelEgressPacketDropCountAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Vnet Gateway tunnel TunnelEgressPacketDropCount\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"alertSensitivity\": \"Medium\",\n                            \"failingPeriods\": {\n                              \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\n                              \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\n                            },\n                            \"name\": \"TunnelEgressPacketDropCount\",\n                            \"metricNamespace\": \"microsoft.network/virtualNetworkGateways\",\n                            \"metricName\": \"TunnelEgressPacketDropCount\",\n                            \"operator\": \"GreaterThan\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"DynamicThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"failingPeriods\": {\n                          \"value\": \"[[parameters('failingPeriods')]\"\n                        },\n                        \"evaluationPeriods\": {\n                          \"value\": \"[[parameters('evaluationPeriods')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"failingPeriods\": {\n                  \"value\": \"[[parameters('failingPeriods')]\"\n                },\n                \"evaluationPeriods\": {\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#26": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VnetGw_TunnelEgressPacketDropMismatch_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - VNetG Egress Packet Drop Mismatch Alert\",\n    \"description\": \"Policy to audit/deploy Vnet Gateway Egress Packet Drop Mismatch Alert\",\n    \"metadata\": {\n      \"version\": \"1.5.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"3\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"failingPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Failing Periods\",\n          \"description\": \"Number of failing periods before alert is fired\"\n        },\n        \"defaultValue\": \"4\"\n      },\n      \"evaluationPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Periods\",\n          \"description\": \"The number of aggregated lookback points.\"\n        },\n        \"defaultValue\": \"4\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name to disable monitoring. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.network/virtualNetworkGateways\"\n          },\n          {\n            \"field\": \"Microsoft.Network/virtualNetworkGateways/gatewayType\",\n            \"equals\": \"VPN\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.network/virtualNetworkGateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"TunnelEgressPacketDropTSMismatch\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/virtualNetworkGateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.alertSensitivity\",\n                \"equals\": \"Medium\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.failingPeriods.minFailingPeriodsToAlert\",\n                \"equals\": \"[[parameters('failingPeriods')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.failingPeriods.numberOfEvaluationPeriods\",\n                \"equals\": \"[[parameters('evaluationPeriods')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"failingPeriods\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationPeriods\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelEgressPacketDropTSMismatchAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Vnet Gateway tunnel TunnelEgressPacketDropTSMismatch\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"alertSensitivity\": \"Medium\",\n                            \"failingPeriods\": {\n                              \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\n                              \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\n                            },\n                            \"name\": \"TunnelEgressPacketDropTSMismatch\",\n                            \"metricNamespace\": \"microsoft.network/virtualNetworkGateways\",\n                            \"metricName\": \"TunnelEgressPacketDropTSMismatch\",\n                            \"operator\": \"GreaterThan\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"DynamicThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"failingPeriods\": {\n                          \"value\": \"[[parameters('failingPeriods')]\"\n                        },\n                        \"evaluationPeriods\": {\n                          \"value\": \"[[parameters('evaluationPeriods')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"failingPeriods\": {\n                  \"value\": \"[[parameters('failingPeriods')]\"\n                },\n                \"evaluationPeriods\": {\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#27": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VnetGw_TunnelIngress_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - VNetG Tunnel Ingress Alert\",\n    \"description\": \"Policy to audit/deploy Virtual Network Gateway Tunnel Ingress Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"disabled\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/virtualNetworkGateways\"\n          },\n          {\n            \"field\": \"Microsoft.Network/virtualNetworkGateways/gatewayType\",\n            \"equals\": \"VPN\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/virtualNetworkGateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"TunnelIngressBytes\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/virtualNetworkGateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].operator\",\n                \"equals\": \"LessThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-TunnelIngressBytes-threshold-Override_'), field('tags._amba-TunnelIngressBytes-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelIngressAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for VNet Gateway Tunnel ingress Bytes\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"TunnelIngressBytes\",\n                            \"metricNamespace\": \"Microsoft.Network/virtualNetworkGateways\",\n                            \"metricName\": \"TunnelIngressBytes\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-TunnelIngressBytes-threshold-Override_'), field('tags._amba-TunnelIngressBytes-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#28": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VnetGw_TunnelIngressPacketDropCount_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - VNetG Ingress Packet Drop Count Alert\",\n    \"description\": \"Policy to audit/deploy Vnet Gateway Ingress Packet Drop Count Alert\",\n    \"metadata\": {\n      \"version\": \"1.5.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"3\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"failingPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Failing Periods\",\n          \"description\": \"Number of failing periods before alert is fired\"\n        },\n        \"defaultValue\": \"4\"\n      },\n      \"evaluationPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Periods\",\n          \"description\": \"The number of aggregated lookback points.\"\n        },\n        \"defaultValue\": \"4\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name to disable monitoring. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.network/virtualNetworkGateways\"\n          },\n          {\n            \"field\": \"Microsoft.Network/virtualNetworkGateways/gatewayType\",\n            \"equals\": \"VPN\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.network/virtualNetworkGateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"TunnelIngressPacketDropCount\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/virtualNetworkGateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.alertSensitivity\",\n                \"equals\": \"Medium\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.failingPeriods.minFailingPeriodsToAlert\",\n                \"equals\": \"[[parameters('failingPeriods')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.failingPeriods.numberOfEvaluationPeriods\",\n                \"equals\": \"[[parameters('evaluationPeriods')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"failingPeriods\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationPeriods\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelIngressPacketDropCountAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Vnet Gateway tunnel TunnelIngressPacketDropCount\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"alertSensitivity\": \"Medium\",\n                            \"failingPeriods\": {\n                              \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\n                              \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\n                            },\n                            \"name\": \"TunnelIngressPacketDropCount\",\n                            \"metricNamespace\": \"microsoft.network/virtualNetworkGateways\",\n                            \"metricName\": \"TunnelIngressPacketDropCount\",\n                            \"operator\": \"GreaterThan\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"DynamicThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"failingPeriods\": {\n                          \"value\": \"[[parameters('failingPeriods')]\"\n                        },\n                        \"evaluationPeriods\": {\n                          \"value\": \"[[parameters('evaluationPeriods')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"failingPeriods\": {\n                  \"value\": \"[[parameters('failingPeriods')]\"\n                },\n                \"evaluationPeriods\": {\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#29": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VnetGw_TunnelIngressPacketDropMismatch_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - VNetG Ingress Packet Drop Mismatch Alert\",\n    \"description\": \"Policy to audit/deploy Vnet Gateway Ingress Packet Drop Mismatch Alert\",\n    \"metadata\": {\n      \"version\": \"1.5.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"3\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"failingPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Failing Periods\",\n          \"description\": \"Number of failing periods before alert is fired\"\n        },\n        \"defaultValue\": \"4\"\n      },\n      \"evaluationPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Periods\",\n          \"description\": \"The number of aggregated lookback points.\"\n        },\n        \"defaultValue\": \"4\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name to disable monitoring. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.network/virtualNetworkGateways\"\n          },\n          {\n            \"field\": \"Microsoft.Network/virtualNetworkGateways/gatewayType\",\n            \"equals\": \"VPN\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.network/virtualNetworkGateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"TunnelIngressPacketDropTSMismatch\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/virtualNetworkGateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.alertSensitivity\",\n                \"equals\": \"Medium\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.failingPeriods.minFailingPeriodsToAlert\",\n                \"equals\": \"[[parameters('failingPeriods')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.failingPeriods.numberOfEvaluationPeriods\",\n                \"equals\": \"[[parameters('evaluationPeriods')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"failingPeriods\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationPeriods\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelIngressPacketDropTSMismatchAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Vnet Gateway tunnel TunnelIngressPacketDropTSMismatch\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"alertSensitivity\": \"Medium\",\n                            \"failingPeriods\": {\n                              \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\n                              \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\n                            },\n                            \"name\": \"TunnelIngressPacketDropTSMismatch\",\n                            \"metricNamespace\": \"microsoft.network/virtualNetworkGateways\",\n                            \"metricName\": \"TunnelIngressPacketDropTSMismatch\",\n                            \"operator\": \"GreaterThan\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"DynamicThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"failingPeriods\": {\n                          \"value\": \"[[parameters('failingPeriods')]\"\n                        },\n                        \"evaluationPeriods\": {\n                          \"value\": \"[[parameters('evaluationPeriods')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"failingPeriods\": {\n                  \"value\": \"[[parameters('failingPeriods')]\"\n                },\n                \"evaluationPeriods\": {\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#3": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_ERCIR_ArpAvailability_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - ExpressRoute Circuits Arp Availability Alert\",\n    \"description\": \"Policy to audit/deploy ExpressRoute Circuits Arp Availability Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"90\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/expressRouteCircuits\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/expressRouteCircuits\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"ArpAvailability\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/expressRouteCircuits/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"LessThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-ArpAvailability-threshold-Override_'), field('tags._amba-ArpAvailability-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-ArpAvailability')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for ExpressRoute Circuit Arp Availability\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"ArpAvailability\",\n                            \"metricNamespace\": \"Microsoft.Network/expressRouteCircuits\",\n                            \"metricName\": \"ArpAvailability\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-ArpAvailability-threshold-Override_'), field('tags._amba-ArpAvailability-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#30": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_activitylog_VPNGateway_Delete\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - Activity Log VPN Gateway Delete Alert\",\n    \"description\": \"Policy to audit/deploy Activity Log VPN Gateway Delete Alert\",\n    \"metadata\": {\n      \"version\": \"1.2.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"alertResourceGroupName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Name\",\n          \"description\": \"Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"rg-amba-monitoring-001\"\n      },\n      \"alertResourceGroupTags\": {\n        \"type\": \"Object\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Tags\",\n          \"description\": \"Tags on the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": {\n          \"Project\": \"amba-monitoring\"\n        }\n      },\n      \"alertResourceGroupLocation\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Location\",\n          \"description\": \"Location of the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"centralus\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/vpnGateways\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/activityLogAlerts\",\n          \"existenceScope\": \"resourcegroup\",\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\n          \"deploymentScope\": \"subscription\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/ActivityLogAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"count\": {\n                  \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*]\",\n                  \"where\": {\n                    \"anyOf\": [\n                      {\n                        \"allOf\": [\n                          {\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\n                            \"equals\": \"category\"\n                          },\n                          {\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\n                            \"equals\": \"Administrative\"\n                          }\n                        ]\n                      },\n                      {\n                        \"allOf\": [\n                          {\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].field\",\n                            \"equals\": \"operationName\"\n                          },\n                          {\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].equals\",\n                            \"equals\": \"Microsoft.Network/vpnGateways/delete\"\n                          }\n                        ]\n                      }\n                    ]\n                  }\n                },\n                \"equals\": 2\n              }\n            ]\n          },\n          \"deployment\": {\n            \"location\": \"northeurope\",\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"alertResourceGroupName\": {\n                    \"type\": \"string\"\n                  },\n                  \"alertResourceGroupTags\": {\n                    \"type\": \"object\"\n                  },\n                  \"alertResourceGroupLocation\": {\n                    \"type\": \"string\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"string\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\n                    \"apiVersion\": \"2021-04-01\",\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\n                  },\n                  {\n                    \"type\": \"Microsoft.Resources/deployments\",\n                    \"apiVersion\": \"2019-10-01\",\n                    \"name\": \"ActivityVPNGatewayDelete\",\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\n                    \"dependsOn\": [\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\n                    ],\n                    \"properties\": {\n                      \"mode\": \"Incremental\",\n                      \"template\": {\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                        \"contentVersion\": \"1.0.0.0\",\n                        \"parameters\": {\n                          \"enabled\": {\n                            \"type\": \"string\"\n                          },\n                          \"alertResourceGroupName\": {\n                            \"type\": \"string\"\n                          }\n                        },\n                        \"variables\": {},\n                        \"resources\": [\n                          {\n                            \"type\": \"microsoft.insights/activityLogAlerts\",\n                            \"apiVersion\": \"2020-10-01\",\n                            \"name\": \"ActivityVPNGatewayDelete\",\n                            \"location\": \"global\",\n                            \"tags\": {\n                              \"_deployed_by_amba\": true\n                            },\n                            \"properties\": {\n                              \"description\": \"Activity Log VPN Gateway Delete\",\n                              \"enabled\": \"[[parameters('enabled')]\",\n                              \"scopes\": [\n                                \"[[subscription().id]\"\n                              ],\n                              \"condition\": {\n                                \"allOf\": [\n                                  {\n                                    \"field\": \"category\",\n                                    \"equals\": \"Administrative\"\n                                  },\n                                  {\n                                    \"field\": \"operationName\",\n                                    \"equals\": \"Microsoft.Network/vpnGateways/delete\"\n                                  },\n                                  {\n                                    \"field\": \"status\",\n                                    \"containsAny\": [\n                                      \"succeeded\"\n                                    ]\n                                  }\n                                ]\n                              },\n                              \"parameters\": {\n                                \"enabled\": {\n                                  \"value\": \"[[parameters('enabled')]\"\n                                }\n                              }\n                            }\n                          }\n                        ]\n                      },\n                      \"parameters\": {\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"alertResourceGroupName\": {\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"alertResourceGroupName\": {\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                },\n                \"alertResourceGroupTags\": {\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\n                },\n                \"alertResourceGroupLocation\": {\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#31": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VPNGw_BandwidthUtil_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - VPNG Bandwidth Utilization Alert\",\n    \"description\": \"Policy to audit/deploy VPN Gateway Bandwidth Utilization Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.network/vpngateways\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.network/vpngateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"tunnelaveragebandwidth\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/vpngateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].operator\",\n                \"equals\": \"LessThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-tunnelaveragebandwidth-threshold-Override_'), field('tags._amba-tunnelaveragebandwidth-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-GatewayBandwidthAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for VPN Gateway Bandwidth Utilization\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"tunnelaveragebandwidth\",\n                            \"metricNamespace\": \"microsoft.network/vpngateways\",\n                            \"metricName\": \"tunnelaveragebandwidth\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-tunnelaveragebandwidth-threshold-Override_'), field('tags._amba-tunnelaveragebandwidth-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#32": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VPNGw_BGPPeerStatus_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - VPNG  BGP Peer Status Alert\",\n    \"description\": \"Policy to audit/deploy VPN Gateway BGP Peer Status Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.network/vpngateways\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.network/vpngateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"bgppeerstatus\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/vpngateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Total\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].operator\",\n                \"equals\": \"LessThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-bgppeerstatus-threshold-Override_'), field('tags._amba-bgppeerstatus-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-BGPPeerStatusAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for VPN Gateway BGP peer status\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"bgppeerstatus\",\n                            \"metricNamespace\": \"microsoft.network/vpngateways\",\n                            \"metricName\": \"bgppeerstatus\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Total\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-bgppeerstatus-threshold-Override_'), field('tags._amba-bgppeerstatus-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#33": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VPNGw_Egress_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - VPNG Egress Alert\",\n    \"description\": \"Policy to audit/deploy VPN Gateway Egress Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"disabled\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.network/vpngateways\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.network/vpngateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"tunnelegressbytes\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/vpngateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].operator\",\n                \"equals\": \"LessThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-tunnelegressbytes-threshold-Override_'), field('tags._amba-tunnelegressbytes-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelEgressAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for VPN Gateway tunnel egress bytes\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"tunnelegressbytes\",\n                            \"metricNamespace\": \"microsoft.network/vpngateways\",\n                            \"metricName\": \"tunnelegressbytes\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-tunnelegressbytes-threshold-Override_'), field('tags._amba-tunnelegressbytes-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#34": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VPNGw_TunnelEgressPacketDropCount_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - VPNG Egress Packet Drop Count Alert\",\n    \"description\": \"Policy to audit/deploy VPN Gateway Egress Packet Drop Count Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"3\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"failingPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Failing Periods\",\n          \"description\": \"Number of failing periods before alert is fired\"\n        },\n        \"defaultValue\": \"4\"\n      },\n      \"evaluationPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Periods\",\n          \"description\": \"The number of aggregated lookback points.\"\n        },\n        \"defaultValue\": \"4\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.network/vpngateways\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.network/vpngateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"TunnelEgressPacketDropCount\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/vpngateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.alertSensitivity\",\n                \"equals\": \"Medium\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.failingPeriods.minFailingPeriodsToAlert\",\n                \"equals\": \"[[parameters('failingPeriods')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.failingPeriods.numberOfEvaluationPeriods\",\n                \"equals\": \"[[parameters('evaluationPeriods')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"failingPeriods\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationPeriods\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelEgressPacketDropCountAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for VPN Gateway tunnel TunnelEgressPacketDropCount\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"alertSensitivity\": \"Medium\",\n                            \"failingPeriods\": {\n                              \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\n                              \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\n                            },\n                            \"name\": \"TunnelEgressPacketDropCount\",\n                            \"metricNamespace\": \"microsoft.network/vpngateways\",\n                            \"metricName\": \"TunnelEgressPacketDropCount\",\n                            \"operator\": \"GreaterThan\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"DynamicThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"failingPeriods\": {\n                          \"value\": \"[[parameters('failingPeriods')]\"\n                        },\n                        \"evaluationPeriods\": {\n                          \"value\": \"[[parameters('evaluationPeriods')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"failingPeriods\": {\n                  \"value\": \"[[parameters('failingPeriods')]\"\n                },\n                \"evaluationPeriods\": {\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#35": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VPNGw_TunnelEgressPacketDropMismatch_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - VPNG Egress Packet Drop Mismatch Alert\",\n    \"description\": \"Policy to audit/deploy VPN Gateway Egress Packet Drop Mismatch Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"3\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"failingPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Failing Periods\",\n          \"description\": \"Number of failing periods before alert is fired\"\n        },\n        \"defaultValue\": \"4\"\n      },\n      \"evaluationPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Periods\",\n          \"description\": \"The number of aggregated lookback points.\"\n        },\n        \"defaultValue\": \"4\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.network/vpngateways\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.network/vpngateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"TunnelEgressPacketDropTSMismatch\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/vpngateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.alertSensitivity\",\n                \"equals\": \"Medium\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.failingPeriods.minFailingPeriodsToAlert\",\n                \"equals\": \"[[parameters('failingPeriods')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.failingPeriods.numberOfEvaluationPeriods\",\n                \"equals\": \"[[parameters('evaluationPeriods')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"failingPeriods\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationPeriods\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelEgressPacketDropTSMismatchAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for VPN Gateway tunnel TunnelEgressPacketDropTSMismatch\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"alertSensitivity\": \"Medium\",\n                            \"failingPeriods\": {\n                              \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\n                              \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\n                            },\n                            \"name\": \"TunnelEgressPacketDropTSMismatch\",\n                            \"metricNamespace\": \"microsoft.network/vpngateways\",\n                            \"metricName\": \"TunnelEgressPacketDropTSMismatch\",\n                            \"operator\": \"GreaterThan\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"DynamicThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"failingPeriods\": {\n                          \"value\": \"[[parameters('failingPeriods')]\"\n                        },\n                        \"evaluationPeriods\": {\n                          \"value\": \"[[parameters('evaluationPeriods')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"failingPeriods\": {\n                  \"value\": \"[[parameters('failingPeriods')]\"\n                },\n                \"evaluationPeriods\": {\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#36": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VPNGw_Ingress_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - VPNG Ingress Alert\",\n    \"description\": \"Policy to audit/deploy VPN Gateway Ingress Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"disabled\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.network/vpngateways\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.network/vpngateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"tunnelingressbytes\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/vpngateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].operator\",\n                \"equals\": \"LessThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-tunnelingressbytes-threshold-Override_'), field('tags._amba-tunnelingressbytes-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelIngressAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for VPN Gateway tunnel ingress bytes\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"tunnelingressbytes\",\n                            \"metricNamespace\": \"microsoft.network/vpngateways\",\n                            \"metricName\": \"tunnelingressbytes\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-tunnelingressbytes-threshold-Override_'), field('tags._amba-tunnelingressbytes-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#37": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VPNGw_TunnelIngressPacketDropCount_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - VPNG Ingress Packet Drop Count Alert\",\n    \"description\": \"Policy to audit/deploy VPN Gateway Ingress Packet Drop Count Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"3\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"failingPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Failing Periods\",\n          \"description\": \"Number of failing periods before alert is fired\"\n        },\n        \"defaultValue\": \"4\"\n      },\n      \"evaluationPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Periods\",\n          \"description\": \"The number of aggregated lookback points.\"\n        },\n        \"defaultValue\": \"4\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.network/vpngateways\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.network/vpngateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"TunnelIngressPacketDropCount\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/vpngateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.alertSensitivity\",\n                \"equals\": \"Medium\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.failingPeriods.minFailingPeriodsToAlert\",\n                \"equals\": \"[[parameters('failingPeriods')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.failingPeriods.numberOfEvaluationPeriods\",\n                \"equals\": \"[[parameters('evaluationPeriods')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"failingPeriods\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationPeriods\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelIngressPacketDropCountAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for VPN Gateway tunnel TunnelIngressPacketDropCount\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"alertSensitivity\": \"Medium\",\n                            \"failingPeriods\": {\n                              \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\n                              \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\n                            },\n                            \"name\": \"TunnelIngressPacketDropCount\",\n                            \"metricNamespace\": \"microsoft.network/vpngateways\",\n                            \"metricName\": \"TunnelIngressPacketDropCount\",\n                            \"operator\": \"GreaterThan\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"DynamicThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"failingPeriods\": {\n                          \"value\": \"[[parameters('failingPeriods')]\"\n                        },\n                        \"evaluationPeriods\": {\n                          \"value\": \"[[parameters('evaluationPeriods')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"failingPeriods\": {\n                  \"value\": \"[[parameters('failingPeriods')]\"\n                },\n                \"evaluationPeriods\": {\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#38": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VPNGw_TunnelIngressPacketDropMismatch_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - VPNG Ingress Packet Drop Mismatch Alert\",\n    \"description\": \"Policy to audit/deploy VPN Gateway Ingress Packet Drop Mismatch Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"3\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"failingPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Failing Periods\",\n          \"description\": \"Number of failing periods before alert is fired\"\n        },\n        \"defaultValue\": \"4\"\n      },\n      \"evaluationPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Periods\",\n          \"description\": \"The number of aggregated lookback points.\"\n        },\n        \"defaultValue\": \"4\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.network/vpngateways\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.network/vpngateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"TunnelIngressPacketDropTSMismatch\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/vpngateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.alertSensitivity\",\n                \"equals\": \"Medium\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.failingPeriods.minFailingPeriodsToAlert\",\n                \"equals\": \"[[parameters('failingPeriods')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.failingPeriods.numberOfEvaluationPeriods\",\n                \"equals\": \"[[parameters('evaluationPeriods')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"failingPeriods\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationPeriods\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelIngressPacketDropTSMismatchAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for VPN Gateway tunnel TunnelIngressPacketDropTSMismatch\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"alertSensitivity\": \"Medium\",\n                            \"failingPeriods\": {\n                              \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\n                              \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\n                            },\n                            \"name\": \"TunnelIngressPacketDropTSMismatch\",\n                            \"metricNamespace\": \"microsoft.network/vpngateways\",\n                            \"metricName\": \"TunnelIngressPacketDropTSMismatch\",\n                            \"operator\": \"GreaterThan\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"DynamicThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"failingPeriods\": {\n                          \"value\": \"[[parameters('failingPeriods')]\"\n                        },\n                        \"evaluationPeriods\": {\n                          \"value\": \"[[parameters('evaluationPeriods')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"failingPeriods\": {\n                  \"value\": \"[[parameters('failingPeriods')]\"\n                },\n                \"evaluationPeriods\": {\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#39": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_AFW_ApplicationRuleHit_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"[Preview]: Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - AFW ApplicationRuleHit Alert\",\n    \"description\": \"Policy to audit/deploy Azure Firewall ApplicationRuleHit Alert\",\n    \"metadata\": {\n      \"version\": \"1.3.0-preview\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"1\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"50\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/azureFirewalls\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/azureFirewalls\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"ApplicationRuleHit\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/azureFirewalls/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Total\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-ApplicationRuleHit-threshold-Override_'), field('tags._amba-ApplicationRuleHit-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-ApplicationRuleHit')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for AFW ApplicationRuleHit\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"ApplicationRuleHit\",\n                            \"metricNamespace\": \"Microsoft.Network/azureFirewalls\",\n                            \"metricName\": \"ApplicationRuleHit\",\n                            \"operator\": \"GreaterThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Total\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-ApplicationRuleHit-threshold-Override_'), field('tags._amba-ApplicationRuleHit-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#4": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_ERCIR_BgpAvailability_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - ExpressRoute Circuits Bgp Availability Alert\",\n    \"description\": \"Policy to audit/deploy ExpressRoute Circuits Bgp Availability Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"90\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/expressRouteCircuits\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/expressRouteCircuits\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"BgpAvailability\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/expressRouteCircuits/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"LessThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-BgpAvailability-threshold-Override_'), field('tags._amba-BgpAvailability-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-BgpAvailability')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for ExpressRoute Circuit Bgp Availability\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"BgpAvailability\",\n                            \"metricNamespace\": \"Microsoft.Network/expressRouteCircuits\",\n                            \"metricName\": \"BgpAvailability\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-BgpAvailability-threshold-Override_'), field('tags._amba-BgpAvailability-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#40": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_AFW_NetworkRuleHit_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"[Preview]: Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - AFW NetworkRuleHit Alert\",\n    \"description\": \"Policy to audit/deploy Azure Firewall NetworkRuleHit Alert\",\n    \"metadata\": {\n      \"version\": \"1.3.0-preview\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"1\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"50\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/azureFirewalls\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/azureFirewalls\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"NetworkRuleHit\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/azureFirewalls/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Total\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-NetworkRuleHit-threshold-Override_'), field('tags._amba-NetworkRuleHit-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-NetworkRuleHit')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for AFW NetworkRuleHit\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"NetworkRuleHit\",\n                            \"metricNamespace\": \"Microsoft.Network/azureFirewalls\",\n                            \"metricName\": \"NetworkRuleHit\",\n                            \"operator\": \"GreaterThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Total\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-NetworkRuleHit-threshold-Override_'), field('tags._amba-NetworkRuleHit-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#41": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_ERGw_ExpressRouteGatewayActiveFlows_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"[Preview]: Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - Express Route Gateway Active Flows Alert\",\n    \"description\": \"Policy to audit/deploy ER Gateway Connection Bits In Per Second Alert\",\n    \"metadata\": {\n      \"version\": \"1.2.0-preview\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"200000\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"disabled\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/expressroutegateways\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/expressroutegateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"ExpressRouteGatewayActiveFlows\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/expressroutegateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-ExpressRouteGatewayActiveFlows-threshold-Override_'), field('tags._amba-ExpressRouteGatewayActiveFlows-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-ExpressRouteGatewayActiveFlowsAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Express Route Gateway Active Flows\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"ExpressRouteGatewayActiveFlows\",\n                            \"metricNamespace\": \"Microsoft.Network/expressroutegateways\",\n                            \"metricName\": \"ExpressRouteGatewayActiveFlows\",\n                            \"operator\": \"GreaterThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-ExpressRouteGatewayActiveFlows-threshold-Override_'), field('tags._amba-ExpressRouteGatewayActiveFlows-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#42": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy-P2SVPNGateways-P2SBandwidth-Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"[Preview]: Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - P2S Bandwidth Alert\",\n    \"description\": \"Policy to audit/deploy Point-to-site bandwidth of a gateway in bytes per second Alert\",\n    \"metadata\": {\n      \"version\": \"1.2.0-preview\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"9900\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.network/p2svpngateways\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.network/p2svpngateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"P2SBandwidth\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/p2svpngateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-P2SBandwidth-threshold-Override_'), field('tags._amba-P2SBandwidth-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-P2SBandwidthAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for P2S Bandwidth\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"P2SBandwidth\",\n                            \"metricNamespace\": \"microsoft.network/p2svpngateways\",\n                            \"metricName\": \"P2SBandwidth\",\n                            \"operator\": \"GreaterThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-P2SBandwidth-threshold-Override_'), field('tags._amba-P2SBandwidth-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#43": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy-P2SVPNGateways-P2SConnectionCount-Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"[Preview]: Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - P2S Connection Count Alert\",\n    \"description\": \"Policy to audit/deploy Count of P2S Connections by gateway Alert\",\n    \"metadata\": {\n      \"version\": \"1.3.0-preview\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"99000\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.network/p2svpngateways\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.network/p2svpngateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"P2SConnectionCount\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/p2svpngateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Sum\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-P2SConnectionCount-threshold-Override_'), field('tags._amba-P2SConnectionCount-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-P2SConnectionCountAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for P2S Connection Count\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"P2SConnectionCount\",\n                            \"metricNamespace\": \"microsoft.network/p2svpngateways\",\n                            \"metricName\": \"P2SConnectionCount\",\n                            \"operator\": \"GreaterThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Sum\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-P2SConnectionCount-threshold-Override_'), field('tags._amba-P2SConnectionCount-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#44": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy-P2SVPNGateways-UserVpnRouteCount-Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"[Preview]: Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - P2S User Vpn Route Count Alert\",\n    \"description\": \"Policy to audit/deploy Count of P2S User Vpn routes learned by gateway Alert\",\n    \"metadata\": {\n      \"version\": \"1.3.0-preview\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"9900\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.network/p2svpngateways\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.network/p2svpngateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"UserVpnRouteCount\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/p2svpngateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Sum\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-UserVpnRouteCount-threshold-Override_'), field('tags._amba-UserVpnRouteCount-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-UserVpnRouteCountAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for User Vpn Route Count Status\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"UserVpnRouteCount\",\n                            \"metricNamespace\": \"microsoft.network/p2svpngateways\",\n                            \"metricName\": \"UserVpnRouteCount\",\n                            \"operator\": \"GreaterThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Sum\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-UserVpnRouteCount-threshold-Override_'), field('tags._amba-UserVpnRouteCount-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#45": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy-VirtualHubs-BgpPeerStatus-Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"[Preview]: Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - Virtual Hubs Bgp Peer Status Alert\",\n    \"description\": \"Policy to audit/deploy Virtual Hubs Bgp Peer Status Alert\",\n    \"metadata\": {\n      \"version\": \"1.2.0-preview\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.network/virtualhubs\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.network/virtualhubs\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"bgppeerstatus\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/virtualhubs/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Maximum\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].operator\",\n                \"equals\": \"LessThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-bgppeerstatus-threshold-Override_'), field('tags._amba-bgppeerstatus-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-BgpPeerStatusAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Virtual Hubs Bgp Peer Status\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"bgppeerstatus\",\n                            \"metricNamespace\": \"microsoft.network/virtualhubs\",\n                            \"metricName\": \"bgppeerstatus\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Maximum\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-bgppeerstatus-threshold-Override_'), field('tags._amba-bgppeerstatus-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#46": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy-VirtualHubs-CountOfRoutesAdvertisedToPeer-Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"[Preview]: Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - Virtual Hubs Count Of Routes Advertised To Peer Alert\",\n    \"description\": \"Policy to audit/deploy Virtual Hubs Count Of Routes Advertised To Peer Alert\",\n    \"metadata\": {\n      \"version\": \"1.2.0-preview\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"1000\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.network/virtualhubs\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.network/virtualhubs\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"CountOfRoutesAdvertisedToPeer\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/virtualhubs/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Maximum\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-CountOfRoutesAdvertisedToPeer-threshold-Override_'), field('tags._amba-CountOfRoutesAdvertisedToPeer-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-CountOfRoutesAdvertisedToPeerAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Virtual Hubs Count Of Routes Advertised To Peer\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"CountOfRoutesAdvertisedToPeer\",\n                            \"metricNamespace\": \"microsoft.network/virtualhubs\",\n                            \"metricName\": \"CountOfRoutesAdvertisedToPeer\",\n                            \"operator\": \"GreaterThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Maximum\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-CountOfRoutesAdvertisedToPeer-threshold-Override_'), field('tags._amba-CountOfRoutesAdvertisedToPeer-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#47": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy-VirtualHubs-CountOfRoutesLearnedFromPeer-Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"[Preview]: Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - Virtual Hubs Count Of Routes Learned From Peer Alert\",\n    \"description\": \"Policy to audit/deploy Virtual Hubs Count Of Routes Learned From Peer Alert\",\n    \"metadata\": {\n      \"version\": \"1.3.0-preview\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"1000\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.network/virtualhubs\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.network/virtualhubs\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"CountOfRoutesLearnedFromPeer\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/virtualhubs/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Maximum\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-CountOfRoutesLearnedFromPeer-threshold-Override_'), field('tags._amba-CountOfRoutesLearnedFromPeer-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-CountOfRoutesLearnedFromPeerAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Virtual Hubs Count Of Routes Learned From Peer\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"CountOfRoutesLearnedFromPeer\",\n                            \"metricNamespace\": \"microsoft.network/virtualhubs\",\n                            \"metricName\": \"CountOfRoutesLearnedFromPeer\",\n                            \"operator\": \"GreaterThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Maximum\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-CountOfRoutesLearnedFromPeer-threshold-Override_'), field('tags._amba-CountOfRoutesLearnedFromPeer-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#48": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy-VirtualHubs-RoutingInfrastructureUnits-Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"[Preview]: Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - Routing Infrastructure Units Alert\",\n    \"description\": \"Policy to audit/deploy Total number of routing infrastructure units, which represent the virtual hub's capacity Alert\",\n    \"metadata\": {\n      \"version\": \"1.3.0-preview\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"30\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.network/virtualhubs\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.network/virtualhubs\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"RoutingInfrastructureUnits\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/virtualhubs/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Maximum\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-RoutingInfrastructureUnits-threshold-Override_'), field('tags._amba-RoutingInfrastructureUnits-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-RoutingInfrastructureUnitsAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Routing Infrastructure Units\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"RoutingInfrastructureUnits\",\n                            \"metricNamespace\": \"microsoft.network/virtualhubs\",\n                            \"metricName\": \"RoutingInfrastructureUnits\",\n                            \"operator\": \"GreaterThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Maximum\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-RoutingInfrastructureUnits-threshold-Override_'), field('tags._amba-RoutingInfrastructureUnits-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#49": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy-VirtualHubs-SpokeVMUtilization-Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"[Preview]: Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - Spoke VM Utilization Alert\",\n    \"description\": \"Policy to audit/deploy Number of deployed spoke VMs as a percentage of the total number of spoke VMs that the hub's routing infrastructure units can support Alert\",\n    \"metadata\": {\n      \"version\": \"1.3.0-preview\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"90\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.network/virtualhubs\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.network/virtualhubs\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"SpokeVMUtilization\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/virtualhubs/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Maximum\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-SpokeVMUtilization-threshold-Override_'), field('tags._amba-SpokeVMUtilization-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-SpokeVMUtilizationAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Spoke VM Utilization\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"SpokeVMUtilization\",\n                            \"metricNamespace\": \"microsoft.network/virtualhubs\",\n                            \"metricName\": \"SpokeVMUtilization\",\n                            \"operator\": \"GreaterThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Maximum\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-SpokeVMUtilization-threshold-Override_'), field('tags._amba-SpokeVMUtilization-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#5": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_ERCIR_QosDropBitsInPerSecond_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - ExpressRoute Circuits QosDropBitsInPerSecond Alert\",\n    \"description\": \"Policy to audit/deploy ExpressRoute Circuits QosDropBitsInPerSecond Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"failingPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Failing Periods\",\n          \"description\": \"Number of failing periods before alert is fired\"\n        },\n        \"defaultValue\": \"2\"\n      },\n      \"evaluationPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Periods\",\n          \"description\": \"The number of aggregated lookback points.\"\n        },\n        \"defaultValue\": \"2\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/expressRouteCircuits\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/expressRouteCircuits\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"QosDropBitsInPerSecond\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/expressRouteCircuits/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.alertSensitivity\",\n                \"equals\": \"Medium\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.failingPeriods.minFailingPeriodsToAlert\",\n                \"equals\": \"[[parameters('failingPeriods')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.failingPeriods.numberOfEvaluationPeriods\",\n                \"equals\": \"[[parameters('evaluationPeriods')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"failingPeriods\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationPeriods\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-QosDropBitsInPerSecond')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for ExpressRoute Circuit QosDropBitsInPerSecond\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"alertSensitivity\": \"Medium\",\n                            \"failingPeriods\": {\n                              \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\n                              \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\n                            },\n                            \"name\": \"QosDropBitsInPerSecond\",\n                            \"metricNamespace\": \"Microsoft.Network/expressRouteCircuits\",\n                            \"metricName\": \"QosDropBitsInPerSecond\",\n                            \"operator\": \"GreaterThan\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"DynamicThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"failingPeriods\": {\n                          \"value\": \"[[parameters('failingPeriods')]\"\n                        },\n                        \"evaluationPeriods\": {\n                          \"value\": \"[[parameters('evaluationPeriods')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"failingPeriods\": {\n                  \"value\": \"[[parameters('failingPeriods')]\"\n                },\n                \"evaluationPeriods\": {\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#50": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy-VirtualHubs-VirtualHubDataProcessed-Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"[Preview]: Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - Virtual Hub Data Processed Alert\",\n    \"description\": \"Policy to audit/deploy Data on how much traffic traverses the virtual hub router in a given time period Alert\",\n    \"metadata\": {\n      \"version\": \"1.3.0-preview\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"5000\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.network/virtualhubs\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.network/virtualhubs\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"VirtualHubDataProcessed\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/virtualhubs/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Maximum\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-VirtualHubDataProcessed-threshold-Override_'), field('tags._amba-VirtualHubDataProcessed-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-VirtualHubDataProcessedAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Virtual Hub Data Processed\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"VirtualHubDataProcessed\",\n                            \"metricNamespace\": \"microsoft.network/virtualhubs\",\n                            \"metricName\": \"VirtualHubDataProcessed\",\n                            \"operator\": \"GreaterThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Maximum\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-VirtualHubDataProcessed-threshold-Override_'), field('tags._amba-VirtualHubDataProcessed-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#51": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_AG_ApplicationGatewayTotalTime_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - AGW ApplicationGatewayTotalTime Alert\",\n    \"description\": \"Policy to audit/deploy Azure Application Gateway ApplicationGatewayTotalTime Alert\",\n    \"metadata\": {\n      \"version\": \"1.5.0\",\n      \"category\": \"Networking\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"alertSensitivity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert Sensitivity\",\n          \"description\": \"Alert Sensitivity for the alert\"\n        },\n        \"allowedValues\": [\n          \"Low\",\n          \"Medium\",\n          \"High\"\n        ],\n        \"defaultValue\": \"Medium\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"failingPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Failing Periods\",\n          \"description\": \"Number of failing periods before alert is fired\"\n        },\n        \"defaultValue\": \"2\"\n      },\n      \"evaluationPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Periods\",\n          \"description\": \"The number of aggregated lookback points.\"\n        },\n        \"defaultValue\": \"2\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/applicationgateways\"\n          },\n          {\n            \"field\": \"Microsoft.Network/applicationgateways/sku.name\",\n            \"In\": [\n              \"Standard_v2\",\n              \"WAF_v2\"\n            ]\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/applicationgateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"ApplicationGatewayTotalTime\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/applicationgateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.alertSensitivity\",\n                \"equals\": \"[[parameters('alertSensitivity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.failingPeriods.minFailingPeriodsToAlert\",\n                \"equals\": \"[[parameters('failingPeriods')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.failingPeriods.numberOfEvaluationPeriods\",\n                \"equals\": \"[[parameters('evaluationPeriods')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"alertSensitivity\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"failingPeriods\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationPeriods\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-agApplicationGatewayTotalTime')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for App Gateway ApplicationGatewayTotalTime\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"ApplicationGatewayTotalTime\",\n                            \"metricNamespace\": \"Microsoft.Network/applicationgateways\",\n                            \"metricName\": \"ApplicationGatewayTotalTime\",\n                            \"operator\": \"GreaterThan\",\n                            \"alertSensitivity\": \"[[parameters('alertSensitivity')]\",\n                            \"failingPeriods\": {\n                              \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\n                              \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\n                            },\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"DynamicThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"alertSensitivity\": {\n                          \"value\": \"[[parameters('alertSensitivity')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"failingPeriods\": {\n                          \"value\": \"[[parameters('failingPeriods')]\"\n                        },\n                        \"evaluationPeriods\": {\n                          \"value\": \"[[parameters('evaluationPeriods')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"alertSensitivity\": {\n                  \"value\": \"[[parameters('alertSensitivity')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"failingPeriods\": {\n                  \"value\": \"[[parameters('failingPeriods')]\"\n                },\n                \"evaluationPeriods\": {\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#52": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_AG_BackendLastByteResponseTime_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - AGW BackendLastByteResponseTime Alert\",\n    \"description\": \"Policy to audit/deploy Azure Application Gateway BackendLastByteResponseTime Alert\",\n    \"metadata\": {\n      \"version\": \"1.5.0\",\n      \"category\": \"Networking\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"alertSensitivity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert Sensitivity\",\n          \"description\": \"Alert Sensitivity for the alert\"\n        },\n        \"allowedValues\": [\n          \"Low\",\n          \"Medium\",\n          \"High\"\n        ],\n        \"defaultValue\": \"Medium\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"failingPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Failing Periods\",\n          \"description\": \"Number of failing periods before alert is fired\"\n        },\n        \"defaultValue\": \"2\"\n      },\n      \"evaluationPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Periods\",\n          \"description\": \"The number of aggregated lookback points.\"\n        },\n        \"defaultValue\": \"2\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/applicationgateways\"\n          },\n          {\n            \"field\": \"Microsoft.Network/applicationgateways/sku.name\",\n            \"In\": [\n              \"Standard_v2\",\n              \"WAF_v2\"\n            ]\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/applicationgateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"BackendLastByteResponseTime\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/applicationgateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.alertSensitivity\",\n                \"equals\": \"[[parameters('alertSensitivity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.failingPeriods.minFailingPeriodsToAlert\",\n                \"equals\": \"[[parameters('failingPeriods')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.failingPeriods.numberOfEvaluationPeriods\",\n                \"equals\": \"[[parameters('evaluationPeriods')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"alertSensitivity\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"failingPeriods\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationPeriods\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-agBackendLastByteResponseTime')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for App Gateway BackendLastByteResponseTime\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"BackendLastByteResponseTime\",\n                            \"metricNamespace\": \"Microsoft.Network/applicationgateways\",\n                            \"metricName\": \"BackendLastByteResponseTime\",\n                            \"operator\": \"GreaterThan\",\n                            \"alertSensitivity\": \"[[parameters('alertSensitivity')]\",\n                            \"failingPeriods\": {\n                              \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\n                              \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\n                            },\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"DynamicThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"alertSensitivity\": {\n                          \"value\": \"[[parameters('alertSensitivity')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"failingPeriods\": {\n                          \"value\": \"[[parameters('failingPeriods')]\"\n                        },\n                        \"evaluationPeriods\": {\n                          \"value\": \"[[parameters('evaluationPeriods')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"alertSensitivity\": {\n                  \"value\": \"[[parameters('alertSensitivity')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"failingPeriods\": {\n                  \"value\": \"[[parameters('failingPeriods')]\"\n                },\n                \"evaluationPeriods\": {\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#53": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_AG_CapacityUnits_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - AGW Capacity Units Alert\",\n    \"description\": \"Policy to audit/deploy Azure Application Gateway CapacityUnits Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Networking\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"75\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/applicationgateways\"\n          },\n          {\n            \"field\": \"Microsoft.Network/applicationgateways/sku.name\",\n            \"In\": [\n              \"Standard_v2\",\n              \"WAF_v2\"\n            ]\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/applicationgateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"CapacityUnits\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/applicationgateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-CapacityUnits-threshold-Override_'), field('tags._amba-CapacityUnits-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-agCapacityUnits')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for App Gateway Capacity Units\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"CapacityUnits\",\n                            \"metricNamespace\": \"Microsoft.Network/applicationgateways\",\n                            \"metricName\": \"CapacityUnits\",\n                            \"operator\": \"GreaterThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-CapacityUnits-threshold-Override_'), field('tags._amba-CapacityUnits-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#54": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_AG_ComputeUnits_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - AGW Compute Units Alert\",\n    \"description\": \"Policy to audit/deploy Azure Application Gateway ComputeUnits Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Networking\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"75\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/applicationgateways\"\n          },\n          {\n            \"field\": \"Microsoft.Network/applicationgateways/sku.name\",\n            \"In\": [\n              \"Standard_v2\",\n              \"WAF_v2\"\n            ]\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/applicationgateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"ComputeUnits\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/applicationgateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-ComputeUnits-threshold-Override_'), field('tags._amba-ComputeUnits-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-agComputeUnits')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for App Gateway Compute Units\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"ComputeUnits\",\n                            \"metricNamespace\": \"Microsoft.Network/applicationgateways\",\n                            \"metricName\": \"ComputeUnits\",\n                            \"operator\": \"GreaterThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-ComputeUnits-threshold-Override_'), field('tags._amba-ComputeUnits-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#55": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_AG_CPUUtilization_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - AGW CPU Utilization Alert\",\n    \"description\": \"Policy to audit/deploy Azure Application Gateway CPU Utilization Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Networking\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"80\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/applicationgateways\"\n          },\n          {\n            \"field\": \"Microsoft.Network/applicationgateways/sku.name\",\n            \"notIn\": [\n              \"Standard_v2\",\n              \"WAF_v2\"\n            ]\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/applicationgateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"CpuUtilization\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/applicationgateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-CpuUtilization-threshold-Override_'), field('tags._amba-CpuUtilization-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-agCpuUtilization')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for App Gateway CPU Utilization\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"CpuUtilization\",\n                            \"metricNamespace\": \"Microsoft.Network/applicationgateways\",\n                            \"metricName\": \"CpuUtilization\",\n                            \"operator\": \"GreaterThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-CpuUtilization-threshold-Override_'), field('tags._amba-CpuUtilization-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#56": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_AG_FailedRequests_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - AGW FailedRequests Alert\",\n    \"description\": \"Policy to audit/deploy Azure Application Gateway FailedRequests Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Networking\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"alertSensitivity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert Sensitivity\",\n          \"description\": \"Alert Sensitivity for the alert\"\n        },\n        \"allowedValues\": [\n          \"Low\",\n          \"Medium\",\n          \"High\"\n        ],\n        \"defaultValue\": \"Medium\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"failingPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Failing Periods\",\n          \"description\": \"Number of failing periods before alert is fired\"\n        },\n        \"defaultValue\": \"2\"\n      },\n      \"evaluationPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Periods\",\n          \"description\": \"The number of aggregated lookback points.\"\n        },\n        \"defaultValue\": \"2\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/applicationgateways\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/applicationgateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"FailedRequests\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/applicationgateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Total\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.alertSensitivity\",\n                \"equals\": \"[[parameters('alertSensitivity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.failingPeriods.minFailingPeriodsToAlert\",\n                \"equals\": \"[[parameters('failingPeriods')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.failingPeriods.numberOfEvaluationPeriods\",\n                \"equals\": \"[[parameters('evaluationPeriods')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"alertSensitivity\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"failingPeriods\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationPeriods\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-agFailedRequests')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for App Gateway FailedRequests\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"FailedRequests\",\n                            \"metricNamespace\": \"Microsoft.Network/applicationgateways\",\n                            \"metricName\": \"FailedRequests\",\n                            \"operator\": \"GreaterThan\",\n                            \"alertSensitivity\": \"[[parameters('alertSensitivity')]\",\n                            \"failingPeriods\": {\n                              \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\n                              \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\n                            },\n                            \"timeAggregation\": \"Total\",\n                            \"criterionType\": \"DynamicThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"alertSensitivity\": {\n                          \"value\": \"[[parameters('alertSensitivity')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"failingPeriods\": {\n                          \"value\": \"[[parameters('failingPeriods')]\"\n                        },\n                        \"evaluationPeriods\": {\n                          \"value\": \"[[parameters('evaluationPeriods')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"alertSensitivity\": {\n                  \"value\": \"[[parameters('alertSensitivity')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"failingPeriods\": {\n                  \"value\": \"[[parameters('failingPeriods')]\"\n                },\n                \"evaluationPeriods\": {\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#57": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_AG_ResponseStatus_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - AGW ResponseStatus Alert\",\n    \"description\": \"Policy to audit/deploy Azure Application Gateway ResponseStatus Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Networking\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"alertSensitivity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert Sensitivity\",\n          \"description\": \"Alert Sensitivity for the alert\"\n        },\n        \"allowedValues\": [\n          \"Low\",\n          \"Medium\",\n          \"High\"\n        ],\n        \"defaultValue\": \"Medium\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"failingPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Failing Periods\",\n          \"description\": \"Number of failing periods before alert is fired\"\n        },\n        \"defaultValue\": \"2\"\n      },\n      \"evaluationPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Periods\",\n          \"description\": \"The number of aggregated lookback points.\"\n        },\n        \"defaultValue\": \"2\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/applicationgateways\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/applicationgateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"ResponseStatus\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/applicationgateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Total\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.alertSensitivity\",\n                \"equals\": \"[[parameters('alertSensitivity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.failingPeriods.minFailingPeriodsToAlert\",\n                \"equals\": \"[[parameters('failingPeriods')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.failingPeriods.numberOfEvaluationPeriods\",\n                \"equals\": \"[[parameters('evaluationPeriods')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"alertSensitivity\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"failingPeriods\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationPeriods\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-agResponseStatus')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for App Gateway ResponseStatus\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"ResponseStatus\",\n                            \"metricNamespace\": \"Microsoft.Network/applicationgateways\",\n                            \"metricName\": \"ResponseStatus\",\n                            \"operator\": \"GreaterThan\",\n                            \"alertSensitivity\": \"[[parameters('alertSensitivity')]\",\n                            \"failingPeriods\": {\n                              \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\n                              \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\n                            },\n                            \"timeAggregation\": \"Total\",\n                            \"dimensions\": [\n                              {\n                                \"name\": \"HttpStatusGroup\",\n                                \"operator\": \"Include\",\n                                \"values\": [\n                                  \"4xx\",\n                                  \"5xx\"\n                                ]\n                              }\n                            ],\n                            \"criterionType\": \"DynamicThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"alertSensitivity\": {\n                          \"value\": \"[[parameters('alertSensitivity')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"failingPeriods\": {\n                          \"value\": \"[[parameters('failingPeriods')]\"\n                        },\n                        \"evaluationPeriods\": {\n                          \"value\": \"[[parameters('evaluationPeriods')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"alertSensitivity\": {\n                  \"value\": \"[[parameters('alertSensitivity')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"failingPeriods\": {\n                  \"value\": \"[[parameters('failingPeriods')]\"\n                },\n                \"evaluationPeriods\": {\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#58": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_AG_UnhealthyHostCount_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - AGW Unhealthy Host Count Alert\",\n    \"description\": \"Policy to audit/deploy Azure Application Gateway Unhealthy Host Count Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Networking\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"20\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/applicationgateways\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/applicationgateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"UnhealthyHostCount\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/applicationgateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-UnhealthyHostCount-threshold-Override_'), field('tags._amba-UnhealthyHostCount-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-agUnhealthyHostCount')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for App Gateway Unhealthy Host Count\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"CpuUtilization\",\n                            \"metricNamespace\": \"Microsoft.Network/applicationgateways\",\n                            \"metricName\": \"UnhealthyHostCount\",\n                            \"operator\": \"GreaterThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-UnhealthyHostCount-threshold-Override_'), field('tags._amba-UnhealthyHostCount-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#59": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_TM_EndpointHealth_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - Traffic Manager Endpoint Health Alert\",\n    \"description\": \"Policy to audit/deploy Traffic Manager Endpoint Health Health Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Networking\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"0.9\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/trafficmanagerprofiles\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/trafficmanagerprofiles\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"ProbeAgentCurrentEndpointStateByProfileResourceId\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/trafficmanagerprofiles/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"LessThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-EndpointHealth-threshold-Override_'), field('tags._amba-EndpointHealth-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-EndpointHealthAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Traffic Manager Endpoint Health\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"EndpointHealth\",\n                            \"metricNamespace\": \"Microsoft.Network/trafficmanagerprofiles\",\n                            \"metricName\": \"ProbeAgentCurrentEndpointStateByProfileResourceId\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\",\n                            \"dimensions\": [\n                              {\n                                \"name\": \"EndpointName\",\n                                \"operator\": \"Include\",\n                                \"values\": [\n                                  \"*\"\n                                ]\n                              }\n                            ]\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-EndpointHealth-threshold-Override_'), field('tags._amba-EndpointHealth-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#6": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_ERCIR_QosDropBitsOutPerSecond_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - ExpressRoute Circuits QosDropBitsOutPerSecond Alert\",\n    \"description\": \"Policy to audit/deploy ExpressRoute Circuits QosDropBitsOutPerSecond Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"failingPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Failing Periods\",\n          \"description\": \"Number of failing periods before alert is fired\"\n        },\n        \"defaultValue\": \"2\"\n      },\n      \"evaluationPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Periods\",\n          \"description\": \"The number of aggregated lookback points.\"\n        },\n        \"defaultValue\": \"2\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/expressRouteCircuits\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/expressRouteCircuits\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"QosDropBitsOutPerSecond\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/expressRouteCircuits/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.alertSensitivity\",\n                \"equals\": \"Medium\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.failingPeriods.minFailingPeriodsToAlert\",\n                \"equals\": \"[[parameters('failingPeriods')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.failingPeriods.numberOfEvaluationPeriods\",\n                \"equals\": \"[[parameters('evaluationPeriods')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"failingPeriods\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationPeriods\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-QosDropBitsOutPerSecond')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for ExpressRoute Circuit QosDropBitsOutPerSecond\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"alertSensitivity\": \"Medium\",\n                            \"failingPeriods\": {\n                              \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\n                              \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\n                            },\n                            \"name\": \"QosDropBitsOutPerSecond\",\n                            \"metricNamespace\": \"Microsoft.Network/expressRouteCircuits\",\n                            \"metricName\": \"QosDropBitsOutPerSecond\",\n                            \"operator\": \"GreaterThan\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"DynamicThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"failingPeriods\": {\n                          \"value\": \"[[parameters('failingPeriods')]\"\n                        },\n                        \"evaluationPeriods\": {\n                          \"value\": \"[[parameters('evaluationPeriods')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"failingPeriods\": {\n                  \"value\": \"[[parameters('failingPeriods')]\"\n                },\n                \"evaluationPeriods\": {\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#60": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_FD_BackendHealth_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - Frontdoor Backend Health Percentage Alert\",\n    \"description\": \"Policy to audit/deploy FrontDoor Backend Health Percentage  Alert\",\n    \"metadata\": {\n      \"version\": \"1.3.0\",\n      \"category\": \"Networking\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"90\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"disabled\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name to disable monitoring. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/frontdoors\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/frontdoors\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"BackendHealthPercentage\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/frontdoors/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"LessThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-BackendHealthPercentage-threshold-Override_'), field('tags._amba-BackendHealthPercentage-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-BackendHealthPercentage')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Frontdoor Backend Health Percentage\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"BackendHealthPercentage\",\n                            \"metricNamespace\": \"Microsoft.Network/frontdoors\",\n                            \"metricName\": \"BackendHealthPercentage\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-BackendHealthPercentage-threshold-Override_'), field('tags._amba-BackendHealthPercentage-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#61": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_FD_BackendRequestLatency_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - Frontdoor Backend Request Latency Alert\",\n    \"description\": \"Policy to audit/deploy Frontdoor Backend Request Latency Alert\",\n    \"metadata\": {\n      \"version\": \"1.3.0\",\n      \"category\": \"Networking\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"disabled\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/frontdoors\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/frontdoors\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"BackendRequestLatency\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/frontdoors/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.alertSensitivity\",\n                \"equals\": \"Medium\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.failingPeriods.minFailingPeriodsToAlert\",\n                \"equals\": 2\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.failingPeriods.numberOfEvaluationPeriods\",\n                \"equals\": 2\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-BackendRequestLatencyAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Frontdoor BackendRequestLatency\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"alertSensitivity\": \"Medium\",\n                            \"failingPeriods\": {\n                              \"numberOfEvaluationPeriods\": 2,\n                              \"minFailingPeriodsToAlert\": 2\n                            },\n                            \"name\": \"ServiceApiResult\",\n                            \"metricNamespace\": \"Microsoft.Network/frontdoors\",\n                            \"metricName\": \"BackendRequestLatency\",\n                            \"operator\": \"GreaterThan\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"DynamicThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#62": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_FrontDoorCDN_OriginHealthPercentage_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - FrontDoor CDN Profile Origin Health Percentage Alert\",\n    \"description\": \"Policy to audit/deploy FrontDoor Origin Health Percentage Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Networking\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"90\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Cdn/profiles\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Cdn/profiles\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"OriginHealthPercentage\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Cdn/profiles/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"LessThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-OriginHealthPercentage-threshold-Override_'), field('tags._amba-OriginHealthPercentage-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-OriginHealthPercentage')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Frontdoor Origin Health Percentage\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"OriginHealthPercentage\",\n                            \"metricNamespace\": \"Microsoft.Cdn/profiles\",\n                            \"metricName\": \"OriginHealthPercentage\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-OriginHealthPercentage-threshold-Override_'), field('tags._amba-OriginHealthPercentage-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#63": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_FrontDoorCDN_OriginLatency_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - FrontDoor CDN Profile Origin Latency Alert\",\n    \"description\": \"Policy to audit/deploy FrontDoor CDN Profile Origin Latency Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Networking\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"disabled\"\n      },\n      \"failingPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Failing Periods\",\n          \"description\": \"Number of failing periods before alert is fired\"\n        },\n        \"defaultValue\": \"2\"\n      },\n      \"evaluationPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Periods\",\n          \"description\": \"The number of aggregated lookback points.\"\n        },\n        \"defaultValue\": \"2\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Cdn/profiles\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Cdn/profiles\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"OriginLatency\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Cdn/profiles/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.alertSensitivity\",\n                \"equals\": \"Medium\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.failingPeriods.minFailingPeriodsToAlert\",\n                \"equals\": \"[[parameters('failingPeriods')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.failingPeriods.numberOfEvaluationPeriods\",\n                \"equals\": \"[[parameters('evaluationPeriods')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"failingPeriods\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationPeriods\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-OriginLatencyAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Frontdoor CDN Origin Latency\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"alertSensitivity\": \"Medium\",\n                            \"failingPeriods\": {\n                              \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\n                              \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\n                            },\n                            \"name\": \"ServiceApiResult\",\n                            \"metricNamespace\": \"Microsoft.Cdn/profiles\",\n                            \"metricName\": \"OriginLatency\",\n                            \"operator\": \"GreaterThan\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"DynamicThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"failingPeriods\": {\n                          \"value\": \"[[parameters('failingPeriods')]\"\n                        },\n                        \"evaluationPeriods\": {\n                          \"value\": \"[[parameters('evaluationPeriods')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"failingPeriods\": {\n                  \"value\": \"[[parameters('failingPeriods')]\"\n                },\n                \"evaluationPeriods\": {\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#64": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_FrontDoorCDN_Percentage4XX_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - FrontDoor CDN Profile Percentage4XX Alert\",\n    \"description\": \"Policy to audit/deploy FrontDoor CDN Profile Percentage4XX Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Networking\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"failingPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Failing Periods\",\n          \"description\": \"Number of failing periods before alert is fired\"\n        },\n        \"defaultValue\": \"2\"\n      },\n      \"evaluationPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Periods\",\n          \"description\": \"The number of aggregated lookback points.\"\n        },\n        \"defaultValue\": \"2\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Cdn/profiles\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Cdn/profiles\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"Percentage4XX\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Cdn/profiles/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.alertSensitivity\",\n                \"equals\": \"Medium\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.failingPeriods.minFailingPeriodsToAlert\",\n                \"equals\": \"[[parameters('failingPeriods')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.failingPeriods.numberOfEvaluationPeriods\",\n                \"equals\": \"[[parameters('evaluationPeriods')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"failingPeriods\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationPeriods\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-Percentage4XXAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Frontdoor CDN Origin Latency\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"alertSensitivity\": \"Medium\",\n                            \"failingPeriods\": {\n                              \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\n                              \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\n                            },\n                            \"name\": \"ServiceApiResult\",\n                            \"metricNamespace\": \"Microsoft.Cdn/profiles\",\n                            \"metricName\": \"Percentage4XX\",\n                            \"operator\": \"GreaterThan\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"DynamicThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"failingPeriods\": {\n                          \"value\": \"[[parameters('failingPeriods')]\"\n                        },\n                        \"evaluationPeriods\": {\n                          \"value\": \"[[parameters('evaluationPeriods')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"failingPeriods\": {\n                  \"value\": \"[[parameters('failingPeriods')]\"\n                },\n                \"evaluationPeriods\": {\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#65": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_FrontDoorCDN_Percentage5XX_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - FrontDoor CDN Profile Percentage5XX Alert\",\n    \"description\": \"Policy to audit/deploy FrontDoor CDN Profile Percentage5XX Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Networking\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"failingPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Failing Periods\",\n          \"description\": \"Number of failing periods before alert is fired\"\n        },\n        \"defaultValue\": \"2\"\n      },\n      \"evaluationPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Periods\",\n          \"description\": \"The number of aggregated lookback points.\"\n        },\n        \"defaultValue\": \"2\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Cdn/profiles\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Cdn/profiles\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"Percentage5XX\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Cdn/profiles/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.alertSensitivity\",\n                \"equals\": \"Medium\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.failingPeriods.minFailingPeriodsToAlert\",\n                \"equals\": \"[[parameters('failingPeriods')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-MultipleResourceMultipleMetricCriteria.allOf[*].DynamicThresholdCriterion.failingPeriods.numberOfEvaluationPeriods\",\n                \"equals\": \"[[parameters('evaluationPeriods')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"failingPeriods\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationPeriods\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-Percentage5XXAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Frontdoor CDN Origin Latency\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"alertSensitivity\": \"Medium\",\n                            \"failingPeriods\": {\n                              \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\n                              \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\n                            },\n                            \"name\": \"ServiceApiResult\",\n                            \"metricNamespace\": \"Microsoft.Cdn/profiles\",\n                            \"metricName\": \"Percentage5XX\",\n                            \"operator\": \"GreaterThan\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"DynamicThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"failingPeriods\": {\n                          \"value\": \"[[parameters('failingPeriods')]\"\n                        },\n                        \"evaluationPeriods\": {\n                          \"value\": \"[[parameters('evaluationPeriods')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"failingPeriods\": {\n                  \"value\": \"[[parameters('failingPeriods')]\"\n                },\n                \"evaluationPeriods\": {\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#66": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_ALB_DataPathAvailability_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - ALB Data Path Availability Alert\",\n    \"description\": \"Policy to audit/deploy Azure Load Balancer Data Path Availability Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Networking\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"90\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/loadBalancers\"\n          },\n          {\n            \"field\": \"Microsoft.Network/loadBalancers/sku.name\",\n            \"in\": [\n              \"Standard\",\n              \"Gateway\"\n            ]\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/loadBalancers\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"VipAvailability\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/loadBalancers/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"LessThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-VipAvailability-threshold-Override_'), field('tags._amba-VipAvailability-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-ALBDataPathAvailability')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for ALB Data Path Availability\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"VipAvailability\",\n                            \"metricNamespace\": \"Microsoft.Network/loadBalancers\",\n                            \"metricName\": \"VipAvailability\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-VipAvailability-threshold-Override_'), field('tags._amba-VipAvailability-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#67": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_ALB_GlobalBackendAvailability_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - ALB Global Backend Availability Alert\",\n    \"description\": \"Policy to audit/deploy Azure Load Balancer Global Backend Availability Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Networking\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"90\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/loadBalancers\"\n          },\n          {\n            \"field\": \"Microsoft.Network/loadBalancers/sku.tier\",\n            \"equals\": \"Global\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/loadBalancers\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"GlobalBackendAvailability\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/loadBalancers/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"LessThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-GlobalBackendAvailability-threshold-Override_'), field('tags._amba-GlobalBackendAvailability-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-ALBGlobalBackendAvailability')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Global Backend Availability\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"GlobalBackendAvailability\",\n                            \"metricNamespace\": \"Microsoft.Network/loadBalancers\",\n                            \"metricName\": \"GlobalBackendAvailability\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-GlobalBackendAvailability-threshold-Override_'), field('tags._amba-GlobalBackendAvailability-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#68": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_ALB_HealthProbeStatus_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - ALB Health Probe Status Alert\",\n    \"description\": \"Policy to audit/deploy Azure Load Balancer Health Probe Status Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Networking\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"90\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/loadBalancers\"\n          },\n          {\n            \"field\": \"Microsoft.Network/loadBalancers/sku.name\",\n            \"in\": [\n              \"Standard\",\n              \"Gateway\"\n            ]\n          },\n          {\n            \"field\": \"Microsoft.Network/loadBalancers/sku.tier\",\n            \"equals\": \"Regional\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/loadBalancers\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"DipAvailability\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/loadBalancers/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"LessThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-DipAvailability-threshold-Override_'), field('tags._amba-DipAvailability-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-ALBHealthProbeStatus')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for ALB Health Probe Status\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"DipAvailability\",\n                            \"metricNamespace\": \"Microsoft.Network/loadBalancers\",\n                            \"metricName\": \"DipAvailability\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-DipAvailability-threshold-Override_'), field('tags._amba-DipAvailability-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#69": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_ALB_UsedSNATPorts_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - ALB Used SNAT Ports Alert\",\n    \"description\": \"Policy to audit/deploy Azure Load Balancer Used SNAT Ports Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Networking\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"1\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"900\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/loadBalancers\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/loadBalancers\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"UsedSNATPorts\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/loadBalancers/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-UsedSNATPorts-threshold-Override_'), field('tags._amba-UsedSNATPorts-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-ALBUsedSNATPorts')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for ALB Used SNAT Ports\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"UsedSNATPorts\",\n                            \"metricNamespace\": \"Microsoft.Network/loadBalancers\",\n                            \"metricName\": \"UsedSNATPorts\",\n                            \"operator\": \"GreaterThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-UsedSNATPorts-threshold-Override_'), field('tags._amba-UsedSNATPorts-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#7": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_ERGw_ExpressRouteBitsIn_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - ERG ExpressRoute Bits In Alert\",\n    \"description\": \"Policy to audit/deploy ER Gateway Connection BitsInPerSecond Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"disabled\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/expressroutegateways\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/expressroutegateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"ERGatewayConnectionBitsInPerSecond\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/expressroutegateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"LessThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-ERGatewayConnectionBitsInPerSecond-threshold-Override_'), field('tags._amba-ERGatewayConnectionBitsInPerSecond-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-GatewayERBitsInAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for ER Gateway Connection BitsInPerSecond\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"ERGatewayConnectionBitsInPerSecond\",\n                            \"metricNamespace\": \"Microsoft.Network/expressroutegateways\",\n                            \"metricName\": \"ERGatewayConnectionBitsInPerSecond\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-ERGatewayConnectionBitsInPerSecond-threshold-Override_'), field('tags._amba-ERGatewayConnectionBitsInPerSecond-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#70": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_PublicIp_BytesInDDoSAttack_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - PIP Bytes in DDoS Attack Alert\",\n    \"description\": \"Policy to audit/deploy PIP Bytes in DDoS Attack Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"4\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"8000000\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"disabled\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/publicIPAddresses\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/publicIPAddresses\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"bytesinddos\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/publicIPAddresses/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Maximum\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-bytesinddos-threshold-Override_'), field('tags._amba-bytesinddos-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-BytesInDDOSAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Public IP Address Bytes IN DDOS\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"bytesinddos\",\n                            \"metricNamespace\": \"Microsoft.Network/publicIPAddresses\",\n                            \"metricName\": \"bytesinddos\",\n                            \"operator\": \"GreaterThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Maximum\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-bytesinddos-threshold-Override_'), field('tags._amba-bytesinddos-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#71": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_PublicIp_DDoSAttack_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - PIP DDoS Attack Alert\",\n    \"description\": \"Policy to audit/deploy PIP DDoS Attack Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"1\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"0\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/publicIPAddresses\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/publicIPAddresses\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"ifunderddosattack\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/publicIPAddresses/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Maximum\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-ifunderddosattack-threshold-Override_'), field('tags._amba-ifunderddosattack-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-DDOS_Attack')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Public IP Address Under Attack\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"ifunderddosattack\",\n                            \"metricNamespace\": \"Microsoft.Network/publicIPAddresses\",\n                            \"metricName\": \"ifunderddosattack\",\n                            \"operator\": \"GreaterThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Maximum\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-ifunderddosattack-threshold-Override_'), field('tags._amba-ifunderddosattack-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#72": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_PublicIp_PacketsInDDoSAttack_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - PIP Packets in DDoS Attack Alert\",\n    \"description\": \"Policy to audit/deploy PIP Packets in DDoS Attack Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"4\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"40000\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"disabled\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/publicIPAddresses\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/publicIPAddresses\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"PacketsInDDoS\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/publicIPAddresses/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Total\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].operator\",\n                \"equals\": \"GreaterThanOrEqual\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-PacketsInDDoS-threshold-Override_'), field('tags._amba-PacketsInDDoS-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-PacketsInDDosAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Public IP Address Packets IN DDOS\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"PacketsInDDoS\",\n                            \"metricNamespace\": \"Microsoft.Network/publicIPAddresses\",\n                            \"metricName\": \"PacketsInDDoS\",\n                            \"operator\": \"GreaterThanOrEqual\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Total\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-PacketsInDDoS-threshold-Override_'), field('tags._amba-PacketsInDDoS-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#73": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_PublicIp_VIPAvailability_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - PIP VIP Availability Alert\",\n    \"description\": \"Policy to audit/deploy PIP VIP Availability Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"1\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"90\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/publicIPAddresses\"\n          },\n          {\n            \"field\": \"Microsoft.Network/publicIPAddresses/sku.name\",\n            \"equals\": \"Standard\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/publicIPAddresses\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"VipAvailability\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/publicIPAddresses/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"LessThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-VipAvailability-threshold-Override_'), field('tags._amba-VipAvailability-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-VIPAvailabityAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Public IP Address VIP Availability\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"VipAvailability\",\n                            \"metricNamespace\": \"Microsoft.Network/publicIPAddresses\",\n                            \"metricName\": \"VipAvailability\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-VipAvailability-threshold-Override_'), field('tags._amba-VipAvailability-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#74": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VNET_DDoSAttack_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - VNet DDoS Attack Alert\",\n    \"description\": \"Policy to audit/deploy Virtual Network DDoS Attack Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"1\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"0\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/virtualNetworks\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/virtualNetworks\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"ifunderddosattack\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/virtualNetworks/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Maximum\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-ifunderddosattack-threshold-Override_'), field('tags._amba-ifunderddosattack-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-DDOSAttackAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for VNet DDOS Attack\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"ifunderddosattack\",\n                            \"metricNamespace\": \"Microsoft.Network/virtualNetworks\",\n                            \"metricName\": \"ifunderddosattack\",\n                            \"operator\": \"GreaterThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Maximum\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-ifunderddosattack-threshold-Override_'), field('tags._amba-ifunderddosattack-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#75": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_activitylog_RouteTable_Update\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - Activity Log Route Table Update Alert\",\n    \"description\": \"Policy to audit/deploy Activity Log Route Table Update Alert\",\n    \"metadata\": {\n      \"version\": \"1.2.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"alertResourceGroupName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Name\",\n          \"description\": \"Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"rg-amba-monitoring-001\"\n      },\n      \"alertResourceGroupTags\": {\n        \"type\": \"Object\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Tags\",\n          \"description\": \"Tags on the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": {\n          \"Project\": \"amba-monitoring\"\n        }\n      },\n      \"alertResourceGroupLocation\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Location\",\n          \"description\": \"Location of the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"centralus\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name to disable monitoring. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/routeTables\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/activityLogAlerts\",\n          \"name\": \"ActivityUDRUpdate\",\n          \"existenceScope\": \"resourcegroup\",\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\n          \"deploymentScope\": \"subscription\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/ActivityLogAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"count\": {\n                  \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*]\",\n                  \"where\": {\n                    \"anyOf\": [\n                      {\n                        \"allOf\": [\n                          {\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\n                            \"equals\": \"category\"\n                          },\n                          {\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\n                            \"equals\": \"Administrative\"\n                          }\n                        ]\n                      },\n                      {\n                        \"allOf\": [\n                          {\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].field\",\n                            \"equals\": \"operationName\"\n                          },\n                          {\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].equals\",\n                            \"equals\": \"Microsoft.Network/routeTables/routes/write\"\n                          }\n                        ]\n                      }\n                    ]\n                  }\n                },\n                \"equals\": 2\n              }\n            ]\n          },\n          \"deployment\": {\n            \"location\": \"northeurope\",\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"alertResourceGroupName\": {\n                    \"type\": \"string\"\n                  },\n                  \"alertResourceGroupTags\": {\n                    \"type\": \"object\"\n                  },\n                  \"alertResourceGroupLocation\": {\n                    \"type\": \"string\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"string\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\n                    \"apiVersion\": \"2021-04-01\",\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\n                  },\n                  {\n                    \"type\": \"Microsoft.Resources/deployments\",\n                    \"apiVersion\": \"2019-10-01\",\n                    \"name\": \"ActivityUDRUpdate\",\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\n                    \"dependsOn\": [\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\n                    ],\n                    \"properties\": {\n                      \"mode\": \"Incremental\",\n                      \"template\": {\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                        \"contentVersion\": \"1.0.0.0\",\n                        \"parameters\": {\n                          \"enabled\": {\n                            \"type\": \"string\"\n                          },\n                          \"alertResourceGroupName\": {\n                            \"type\": \"string\"\n                          }\n                        },\n                        \"variables\": {},\n                        \"resources\": [\n                          {\n                            \"type\": \"microsoft.insights/activityLogAlerts\",\n                            \"apiVersion\": \"2020-10-01\",\n                            \"name\": \"ActivityUDRUpdate\",\n                            \"location\": \"global\",\n                            \"tags\": {\n                              \"_deployed_by_amba\": true\n                            },\n                            \"properties\": {\n                              \"description\": \"Activity Log Route table update\",\n                              \"enabled\": \"[[parameters('enabled')]\",\n                              \"scopes\": [\n                                \"[[subscription().id]\"\n                              ],\n                              \"condition\": {\n                                \"allOf\": [\n                                  {\n                                    \"field\": \"category\",\n                                    \"equals\": \"Administrative\"\n                                  },\n                                  {\n                                    \"field\": \"operationName\",\n                                    \"equals\": \"Microsoft.Network/routeTables/routes/write\"\n                                  },\n                                  {\n                                    \"field\": \"status\",\n                                    \"containsAny\": [\n                                      \"succeeded\"\n                                    ]\n                                  }\n                                ]\n                              },\n                              \"parameters\": {\n                                \"enabled\": {\n                                  \"value\": \"[[parameters('enabled')]\"\n                                }\n                              }\n                            }\n                          }\n                        ]\n                      },\n                      \"parameters\": {\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"alertResourceGroupName\": {\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"alertResourceGroupName\": {\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                },\n                \"alertResourceGroupTags\": {\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\n                },\n                \"alertResourceGroupLocation\": {\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#76": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_activitylog_RouteTable_Delete\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - Activity Log Route Table Delete Alert\",\n    \"description\": \"Policy to audit/deploy Activity Log Route Table Delete Alert\",\n    \"metadata\": {\n      \"version\": \"1.1.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"alertResourceGroupName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Name\",\n          \"description\": \"Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"rg-amba-monitoring-001\"\n      },\n      \"alertResourceGroupTags\": {\n        \"type\": \"Object\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Tags\",\n          \"description\": \"Tags on the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": {\n          \"Project\": \"amba-monitoring\"\n        }\n      },\n      \"alertResourceGroupLocation\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Location\",\n          \"description\": \"Location of the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"centralus\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name to disable monitoring. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/routeTables\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/activityLogAlerts\",\n          \"name\": \"ActivityUDRDelete\",\n          \"existenceScope\": \"resourcegroup\",\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\n          \"deploymentScope\": \"subscription\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/ActivityLogAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"count\": {\n                  \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*]\",\n                  \"where\": {\n                    \"anyOf\": [\n                      {\n                        \"allOf\": [\n                          {\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\n                            \"equals\": \"category\"\n                          },\n                          {\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\n                            \"equals\": \"Administrative\"\n                          }\n                        ]\n                      },\n                      {\n                        \"allOf\": [\n                          {\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].field\",\n                            \"equals\": \"operationName\"\n                          },\n                          {\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].equals\",\n                            \"equals\": \"Microsoft.Network/routeTables/delete\"\n                          }\n                        ]\n                      }\n                    ]\n                  }\n                },\n                \"equals\": 2\n              }\n            ]\n          },\n          \"deployment\": {\n            \"location\": \"northeurope\",\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"alertResourceGroupName\": {\n                    \"type\": \"string\"\n                  },\n                  \"alertResourceGroupTags\": {\n                    \"type\": \"object\"\n                  },\n                  \"alertResourceGroupLocation\": {\n                    \"type\": \"string\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"string\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\n                    \"apiVersion\": \"2021-04-01\",\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\n                  },\n                  {\n                    \"type\": \"Microsoft.Resources/deployments\",\n                    \"apiVersion\": \"2019-10-01\",\n                    \"name\": \"ActivityUDRDelete\",\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\n                    \"dependsOn\": [\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\n                    ],\n                    \"properties\": {\n                      \"mode\": \"Incremental\",\n                      \"template\": {\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                        \"contentVersion\": \"1.0.0.0\",\n                        \"parameters\": {\n                          \"enabled\": {\n                            \"type\": \"string\"\n                          },\n                          \"alertResourceGroupName\": {\n                            \"type\": \"string\"\n                          }\n                        },\n                        \"variables\": {},\n                        \"resources\": [\n                          {\n                            \"type\": \"microsoft.insights/activityLogAlerts\",\n                            \"apiVersion\": \"2020-10-01\",\n                            \"name\": \"ActivityUDRDelete\",\n                            \"location\": \"global\",\n                            \"tags\": {\n                              \"_deployed_by_amba\": true\n                            },\n                            \"properties\": {\n                              \"description\": \"Activity Log Route table Delete\",\n                              \"enabled\": \"[[parameters('enabled')]\",\n                              \"scopes\": [\n                                \"[[subscription().id]\"\n                              ],\n                              \"condition\": {\n                                \"allOf\": [\n                                  {\n                                    \"field\": \"category\",\n                                    \"equals\": \"Administrative\"\n                                  },\n                                  {\n                                    \"field\": \"operationName\",\n                                    \"equals\": \"Microsoft.Network/routeTables/delete\"\n                                  },\n                                  {\n                                    \"field\": \"status\",\n                                    \"containsAny\": [\n                                      \"succeeded\"\n                                    ]\n                                  }\n                                ]\n                              },\n                              \"parameters\": {\n                                \"enabled\": {\n                                  \"value\": \"[[parameters('enabled')]\"\n                                }\n                              }\n                            }\n                          }\n                        ]\n                      },\n                      \"parameters\": {\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"alertResourceGroupName\": {\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"alertResourceGroupName\": {\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                },\n                \"alertResourceGroupTags\": {\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\n                },\n                \"alertResourceGroupLocation\": {\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#77": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_activitylog_RouteTable_Routes_Delete\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - Activity Log Routes Delete Alert\",\n    \"description\": \"Policy to audit/deploy Activity Log Route Table Routes Delete Alert\",\n    \"metadata\": {\n      \"version\": \"1.1.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"alertResourceGroupName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Name\",\n          \"description\": \"Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"rg-amba-monitoring-001\"\n      },\n      \"alertResourceGroupTags\": {\n        \"type\": \"Object\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Tags\",\n          \"description\": \"Tags on the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": {\n          \"Project\": \"amba-monitoring\"\n        }\n      },\n      \"alertResourceGroupLocation\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Location\",\n          \"description\": \"Location of the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"centralus\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name to disable monitoring. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/routeTables\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/activityLogAlerts\",\n          \"name\": \"ActivityUDRRoutesDelete\",\n          \"existenceScope\": \"resourcegroup\",\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\n          \"deploymentScope\": \"subscription\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/ActivityLogAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"count\": {\n                  \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*]\",\n                  \"where\": {\n                    \"anyOf\": [\n                      {\n                        \"allOf\": [\n                          {\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\n                            \"equals\": \"category\"\n                          },\n                          {\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\n                            \"equals\": \"Administrative\"\n                          }\n                        ]\n                      },\n                      {\n                        \"allOf\": [\n                          {\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].field\",\n                            \"equals\": \"operationName\"\n                          },\n                          {\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].equals\",\n                            \"equals\": \"Microsoft.Network/routeTables/routes/delete\"\n                          }\n                        ]\n                      }\n                    ]\n                  }\n                },\n                \"equals\": 2\n              }\n            ]\n          },\n          \"deployment\": {\n            \"location\": \"northeurope\",\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"alertResourceGroupName\": {\n                    \"type\": \"string\"\n                  },\n                  \"alertResourceGroupTags\": {\n                    \"type\": \"object\"\n                  },\n                  \"alertResourceGroupLocation\": {\n                    \"type\": \"string\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"string\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\n                    \"apiVersion\": \"2021-04-01\",\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\n                  },\n                  {\n                    \"type\": \"Microsoft.Resources/deployments\",\n                    \"apiVersion\": \"2019-10-01\",\n                    \"name\": \"ActivityUDRRoutesDelete\",\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\n                    \"dependsOn\": [\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\n                    ],\n                    \"properties\": {\n                      \"mode\": \"Incremental\",\n                      \"template\": {\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                        \"contentVersion\": \"1.0.0.0\",\n                        \"parameters\": {\n                          \"enabled\": {\n                            \"type\": \"string\"\n                          },\n                          \"alertResourceGroupName\": {\n                            \"type\": \"string\"\n                          }\n                        },\n                        \"variables\": {},\n                        \"resources\": [\n                          {\n                            \"type\": \"microsoft.insights/activityLogAlerts\",\n                            \"apiVersion\": \"2020-10-01\",\n                            \"name\": \"ActivityUDRRoutesDelete\",\n                            \"location\": \"global\",\n                            \"tags\": {\n                              \"_deployed_by_amba\": true\n                            },\n                            \"properties\": {\n                              \"description\": \"Activity Log Route table Routes Delete\",\n                              \"enabled\": \"[[parameters('enabled')]\",\n                              \"scopes\": [\n                                \"[[subscription().id]\"\n                              ],\n                              \"condition\": {\n                                \"allOf\": [\n                                  {\n                                    \"field\": \"category\",\n                                    \"equals\": \"Administrative\"\n                                  },\n                                  {\n                                    \"field\": \"operationName\",\n                                    \"equals\": \"Microsoft.Network/routeTables/routes/delete\"\n                                  },\n                                  {\n                                    \"field\": \"status\",\n                                    \"containsAny\": [\n                                      \"succeeded\"\n                                    ]\n                                  }\n                                ]\n                              },\n                              \"parameters\": {\n                                \"enabled\": {\n                                  \"value\": \"[[parameters('enabled')]\"\n                                }\n                              }\n                            }\n                          }\n                        ]\n                      },\n                      \"parameters\": {\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"alertResourceGroupName\": {\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"alertResourceGroupName\": {\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                },\n                \"alertResourceGroupTags\": {\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\n                },\n                \"alertResourceGroupLocation\": {\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#78": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_activitylog_NSG_Delete\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - Activity Log NSG Delete Alert\",\n    \"description\": \"Policy to audit/deploy Activity Log NSG Delete Alert\",\n    \"metadata\": {\n      \"version\": \"1.2.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"alertResourceGroupName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Name\",\n          \"description\": \"Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"rg-amba-monitoring-001\"\n      },\n      \"alertResourceGroupTags\": {\n        \"type\": \"Object\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Tags\",\n          \"description\": \"Tags on the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": {\n          \"Project\": \"amba-monitoring\"\n        }\n      },\n      \"alertResourceGroupLocation\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Location\",\n          \"description\": \"Location of the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"centralus\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name to disable monitoring. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/networkSecurityGroups\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/activityLogAlerts\",\n          \"name\": \"ActivityNSGDelete\",\n          \"existenceScope\": \"resourcegroup\",\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\n          \"deploymentScope\": \"subscription\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/ActivityLogAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"count\": {\n                  \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*]\",\n                  \"where\": {\n                    \"anyOf\": [\n                      {\n                        \"allOf\": [\n                          {\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\n                            \"equals\": \"category\"\n                          },\n                          {\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\n                            \"equals\": \"Administrative\"\n                          }\n                        ]\n                      },\n                      {\n                        \"allOf\": [\n                          {\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].field\",\n                            \"equals\": \"operationName\"\n                          },\n                          {\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].equals\",\n                            \"equals\": \"Microsoft.Network/networkSecurityGroups/delete\"\n                          }\n                        ]\n                      }\n                    ]\n                  }\n                },\n                \"equals\": 2\n              }\n            ]\n          },\n          \"deployment\": {\n            \"location\": \"northeurope\",\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"alertResourceGroupName\": {\n                    \"type\": \"string\"\n                  },\n                  \"alertResourceGroupTags\": {\n                    \"type\": \"object\"\n                  },\n                  \"alertResourceGroupLocation\": {\n                    \"type\": \"string\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"string\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\n                    \"apiVersion\": \"2021-04-01\",\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\n                  },\n                  {\n                    \"type\": \"Microsoft.Resources/deployments\",\n                    \"apiVersion\": \"2019-10-01\",\n                    \"name\": \"ActivityNSGDelete\",\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\n                    \"dependsOn\": [\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\n                    ],\n                    \"properties\": {\n                      \"mode\": \"Incremental\",\n                      \"template\": {\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                        \"contentVersion\": \"1.0.0.0\",\n                        \"parameters\": {\n                          \"enabled\": {\n                            \"type\": \"string\"\n                          },\n                          \"alertResourceGroupName\": {\n                            \"type\": \"string\"\n                          }\n                        },\n                        \"variables\": {},\n                        \"resources\": [\n                          {\n                            \"type\": \"microsoft.insights/activityLogAlerts\",\n                            \"apiVersion\": \"2020-10-01\",\n                            \"name\": \"ActivityNSGDelete\",\n                            \"location\": \"global\",\n                            \"tags\": {\n                              \"_deployed_by_amba\": true\n                            },\n                            \"properties\": {\n                              \"description\": \"Activity Log NSG Delete\",\n                              \"enabled\": \"[[parameters('enabled')]\",\n                              \"scopes\": [\n                                \"[[subscription().id]\"\n                              ],\n                              \"condition\": {\n                                \"allOf\": [\n                                  {\n                                    \"field\": \"category\",\n                                    \"equals\": \"Administrative\"\n                                  },\n                                  {\n                                    \"field\": \"operationName\",\n                                    \"equals\": \"Microsoft.Network/networkSecurityGroups/delete\"\n                                  },\n                                  {\n                                    \"field\": \"status\",\n                                    \"containsAny\": [\n                                      \"succeeded\"\n                                    ]\n                                  }\n                                ]\n                              },\n                              \"parameters\": {\n                                \"enabled\": {\n                                  \"value\": \"[[parameters('enabled')]\"\n                                }\n                              }\n                            }\n                          }\n                        ]\n                      },\n                      \"parameters\": {\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"alertResourceGroupName\": {\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"alertResourceGroupName\": {\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                },\n                \"alertResourceGroupTags\": {\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\n                },\n                \"alertResourceGroupLocation\": {\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#8": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_ERGw_ExpressRouteBitsOut_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - ERG ExpressRoute Bits Out Alert\",\n    \"description\": \"Policy to audit/deploy ER Gateway Connection BitsOutPerSecond Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"disabled\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/expressroutegateways\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/expressroutegateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"ERGatewayConnectionBitsOutPerSecond\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/expressroutegateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"LessThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-ERGatewayConnectionBitsOutPerSecond-threshold-Override_'), field('tags._amba-ERGatewayConnectionBitsOutPerSecond-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-GatewayERBitsOutAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for ER Gateway Connection BitsOutPerSecond\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"ERGatewayConnectionBitsOutPerSecond\",\n                            \"metricNamespace\": \"Microsoft.Network/expressroutegateways\",\n                            \"metricName\": \"ERGatewayConnectionBitsOutPerSecond\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-ERGatewayConnectionBitsOutPerSecond-threshold-Override_'), field('tags._amba-ERGatewayConnectionBitsOutPerSecond-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#9": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_ERGw_ExpressRouteCpuUtil_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Monitor Baseline Alerts (AMBA-ALZ) - ERG ExpressRoute CPU Utilization Alert\",\n    \"description\": \"Policy to audit/deploy ER Gateway Express Route CPU Utilization Alert\",\n    \"metadata\": {\n      \"version\": \"1.4.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_amba\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"1\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"80\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisableTagName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag name\",\n          \"description\": \"Tag name used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      },\n      \"MonitorDisableTagValues\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"ALZ Monitoring disabled tag values(s)\",\n          \"description\": \"Tag value(s) used to disable monitoring at the resource level. Set to true if monitoring should be disabled.\"\n        },\n        \"defaultValue\": [\n          \"true\",\n          \"Test\",\n          \"Dev\",\n          \"Sandbox\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/expressroutegateways\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisableTagName'), ']')]\",\n            \"notIn\": \"[[parameters('MonitorDisableTagValues')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/47be4a87-7950-4631-9daf-b664a405f074\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/expressroutegateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"ExpressRouteGatewayCpuUtilization\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/expressroutegateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\n                \"equals\": \"[[parameters('windowSize')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\n                \"equals\": \"[[parameters('severity')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\n                \"equals\": \"[[parameters('autoMitigate')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\n                \"equals\": \"Average\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.operator\",\n                \"equals\": \"GreaterThan\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].StaticThresholdCriterion.threshold\",\n                \"equals\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-ExpressRouteGatewayCpuUtilization-threshold-Override_'), field('tags._amba-ExpressRouteGatewayCpuUtilization-threshold-Override_'), parameters('threshold'))]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-GatewayERCPUAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_amba\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for ER Gateway Express Route CPU Utilization\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"ExpressRouteGatewayCpuUtilization\",\n                            \"metricNamespace\": \"Microsoft.Network/expressroutegateways\",\n                            \"metricName\": \"ExpressRouteGatewayCpuUtilization\",\n                            \"operator\": \"GreaterThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[if(contains(coalesce(field('tags'), createObject()), '_amba-ExpressRouteGatewayCpuUtilization-threshold-Override_'), field('tags._amba-ExpressRouteGatewayCpuUtilization-threshold-Override_'), parameters('threshold'))]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "cloudEnv": "[environment().name]",
    "defaultDeploymentLocationByCloudType": {
      "AzureCloud": "northeurope",
      "AzureChinaCloud": "chinaeast2",
      "AzureUSGovernment": "usgovvirginia"
    },
    "templateVars": {
      "scope": "/providers/Microsoft.Management/managementGroups/contoso",
      "defaultDeploymentLocation": "\"location\": \"northeurope\"",
      "localizedDeploymentLocation": "[format('\"location\": \"{0}\"', variables('defaultDeploymentLocationByCloudType')[variables('cloudEnv')])]"
    },
    "targetDeploymentLocationByCloudType": {
      "AzureCloud": "[coalesce(parameters('location'), 'northeurope')]",
      "AzureChinaCloud": "[coalesce(parameters('location'), 'chinaeast2')]",
      "AzureUSGovernment": "[coalesce(parameters('location'), 'usgovvirginia')]"
    },
    "deploymentLocation": "[format('\"location\": \"{0}\"', variables('targetDeploymentLocationByCloudType')[variables('cloudEnv')])]",
    "loadPolicyDefinitions": {
      "All": [
        "[variables('$fxv#0')]",
        "[variables('$fxv#1')]",
        "[variables('$fxv#2')]",
        "[variables('$fxv#3')]",
        "[variables('$fxv#4')]",
        "[variables('$fxv#5')]",
        "[variables('$fxv#6')]",
        "[variables('$fxv#7')]",
        "[variables('$fxv#8')]",
        "[variables('$fxv#9')]",
        "[variables('$fxv#10')]",
        "[variables('$fxv#11')]",
        "[variables('$fxv#12')]",
        "[variables('$fxv#13')]",
        "[variables('$fxv#14')]",
        "[variables('$fxv#15')]",
        "[variables('$fxv#16')]",
        "[variables('$fxv#17')]",
        "[variables('$fxv#18')]",
        "[variables('$fxv#19')]",
        "[variables('$fxv#20')]",
        "[variables('$fxv#21')]",
        "[variables('$fxv#22')]",
        "[variables('$fxv#23')]",
        "[variables('$fxv#24')]",
        "[variables('$fxv#25')]",
        "[variables('$fxv#26')]",
        "[variables('$fxv#27')]",
        "[variables('$fxv#28')]",
        "[variables('$fxv#29')]",
        "[variables('$fxv#30')]",
        "[variables('$fxv#31')]",
        "[variables('$fxv#32')]",
        "[variables('$fxv#33')]",
        "[variables('$fxv#34')]",
        "[variables('$fxv#35')]",
        "[variables('$fxv#36')]",
        "[variables('$fxv#37')]",
        "[variables('$fxv#38')]",
        "[variables('$fxv#39')]",
        "[variables('$fxv#40')]",
        "[variables('$fxv#41')]",
        "[variables('$fxv#42')]",
        "[variables('$fxv#43')]",
        "[variables('$fxv#44')]",
        "[variables('$fxv#45')]",
        "[variables('$fxv#46')]",
        "[variables('$fxv#47')]",
        "[variables('$fxv#48')]",
        "[variables('$fxv#49')]",
        "[variables('$fxv#50')]",
        "[variables('$fxv#51')]",
        "[variables('$fxv#52')]",
        "[variables('$fxv#53')]",
        "[variables('$fxv#54')]",
        "[variables('$fxv#55')]",
        "[variables('$fxv#56')]",
        "[variables('$fxv#57')]",
        "[variables('$fxv#58')]",
        "[variables('$fxv#59')]",
        "[variables('$fxv#60')]",
        "[variables('$fxv#61')]",
        "[variables('$fxv#62')]",
        "[variables('$fxv#63')]",
        "[variables('$fxv#64')]",
        "[variables('$fxv#65')]",
        "[variables('$fxv#66')]",
        "[variables('$fxv#67')]",
        "[variables('$fxv#68')]",
        "[variables('$fxv#69')]",
        "[variables('$fxv#70')]",
        "[variables('$fxv#71')]",
        "[variables('$fxv#72')]",
        "[variables('$fxv#73')]",
        "[variables('$fxv#74')]",
        "[variables('$fxv#75')]",
        "[variables('$fxv#76')]",
        "[variables('$fxv#77')]",
        "[variables('$fxv#78')]"
      ],
      "AzureCloud": [],
      "AzureChinaCloud": [],
      "AzureUSGovernment": []
    },
    "loadPolicySetDefinitions": {
      "All": [],
      "AzureCloud": [],
      "AzureChinaCloud": [],
      "AzureUSGovernment": []
    },
    "policyDefinitionsByCloudType": {
      "All": "[variables('policyDefinitionsAll')]",
      "AzureCloud": "[variables('policyDefinitionsAzureCloud')]",
      "AzureChinaCloud": "[variables('policyDefinitionsAzureChinaCloud')]",
      "AzureUSGovernment": "[variables('policyDefinitionsAzureUSGovernment')]"
    },
    "policySetDefinitionsByCloudType": {
      "All": "[variables('policySetDefinitionsAll')]",
      "AzureCloud": "[variables('policySetDefinitionsAzureCloud')]",
      "AzureChinaCloud": "[variables('policySetDefinitionsAzureChinaCloud')]",
      "AzureUSGovernment": "[variables('policySetDefinitionsAzureUSGovernment')]"
    },
    "policyDefinitions": "[concat(variables('policyDefinitionsByCloudType').All, variables('policyDefinitionsByCloudType')[variables('cloudEnv')])]",
    "policySetDefinitions": "[concat(variables('policySetDefinitionsByCloudType').All, variables('policySetDefinitionsByCloudType')[variables('cloudEnv')])]"
  },
  "resources": [
    {
      "copy": {
        "name": "PolicyDefinitions",
        "count": "[length(variables('policyDefinitions'))]"
      },
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2020-09-01",
      "name": "[variables('policyDefinitions')[copyIndex()].name]",
      "properties": {
        "description": "[variables('policyDefinitions')[copyIndex()].properties.description]",
        "displayName": "[variables('policyDefinitions')[copyIndex()].properties.displayName]",
        "metadata": "[variables('policyDefinitions')[copyIndex()].properties.metadata]",
        "mode": "[variables('policyDefinitions')[copyIndex()].properties.mode]",
        "parameters": "[variables('policyDefinitions')[copyIndex()].properties.parameters]",
        "policyType": "[variables('policyDefinitions')[copyIndex()].properties.policyType]",
        "policyRule": "[variables('policyDefinitions')[copyIndex()].properties.policyRule]"
      }
    },
    {
      "copy": {
        "name": "PolicySetDefinitions",
        "count": "[length(variables('policySetDefinitions'))]"
      },
      "type": "Microsoft.Authorization/policySetDefinitions",
      "apiVersion": "2020-09-01",
      "name": "[variables('policySetDefinitions')[copyIndex()].name]",
      "properties": {
        "description": "[variables('policySetDefinitions')[copyIndex()].properties.description]",
        "displayName": "[variables('policySetDefinitions')[copyIndex()].properties.displayName]",
        "metadata": "[variables('policySetDefinitions')[copyIndex()].properties.metadata]",
        "parameters": "[variables('policySetDefinitions')[copyIndex()].properties.parameters]",
        "policyType": "[variables('policySetDefinitions')[copyIndex()].properties.policyType]",
        "policyDefinitions": "[variables('policySetDefinitions')[copyIndex()].properties.policyDefinitions]",
        "policyDefinitionGroups": "[variables('policySetDefinitions')[copyIndex()].properties.policyDefinitionGroups]"
      },
      "dependsOn": [
        "PolicyDefinitions"
      ]
    }
  ],
  "outputs": {
    "policyDefinitionNames": {
      "type": "array",
      "copy": {
        "count": "[length(variables('policyDefinitions'))]",
        "input": "[variables('policyDefinitions')[copyIndex()].name]"
      }
    },
    "policySetDefinitionNames": {
      "type": "array",
      "copy": {
        "count": "[length(variables('policySetDefinitions'))]",
        "input": "[variables('policySetDefinitions')[copyIndex()].name]"
      }
    }
  }
}